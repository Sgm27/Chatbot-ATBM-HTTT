{
  "doc-4242190da2622b7fb6a57c5f030f0ba5": {
    "status": "processed",
    "chunks_count": 82,
    "content": "# BỘ THÔNG TIN VÀ TRUYỀN THÔNG\n\n# HỌC VIỆN CÔNG NGHỆ BƯU CHÍNH VIỄN THÔNG\n\n------------------oOo-----------------\n\n# HOÀNG XUÂN DẬU\n\n# BÀI GIẢNG\n\n# AN TOÀN VÀ BẢO MẬT\n\n# HỆ THỐNG THÔNG TIN\n\n# HÀ NỘI 2021\n\n---\n\n1\n\n# MỤC LỤC\n\nDANH MỤC CÁC HÌNH ............................................................................................................... 4\n\n# DANH MỤC CÁC THUẬT NGỮ TIẾNG ANH VÀ VIẾT TẮT ................................................. 7\n\nMỞ ĐẦU ......................................................................................................................................... 8\n\n# CHƯƠNG 1. TỔNG QUAN VỀ AN TOÀN BẢO MẬT  HỆ THỐNG THÔNG TIN ............... 10\n\n1.1. Khái quát về an toàn thông tin ........................................................................................... 10\n\n1.1.1. An toàn thông tin là gì? ............................................................................................... 10\n\n1.1.2. Sự cần thiết của an toàn thông tin ............................................................................... 11\n\n1.1.3. Các thành phần của an toàn thông tin ......................................................................... 13\n\n1.2. Khái quát về an toàn hệ thống thông tin ............................................................................. 15\n\n1.2.1. Các thành phần của hệ thống thông tin ....................................................................... 15\n\n1.2.2. An toàn hệ thống thông tin là gì? ................................................................................ 16\n\n1.3. Các yêu cầu đảm bảo an toàn hệ thống thông tin ............................................................... 16\n\n1.3.1. Tính bí mật .................................................................................................................. 16\n\n1.3.2. Toàn vẹn ...................................................................................................................... 17\n\n1.3.3. Sẵn dùng ...................................................................................................................... 17\n\n1.4. Bảy vùng trong hạ tầng CNTT và các mối đe dọa ............................................................. 18\n\n1.4.1. Bảy vùng trong cơ sở hạ tầng CNTT .......................................................................... 18\n\n1.4.2. Các mối đe dọa và nguy cơ ......................................................................................... 19\n\n1.5. Mô hình tổng quát đảm bảo an toàn hệ thống thông tin ..................................................... 20\n\n1.5.1. Giới thiệu ..................................................................................................................... 20\n\n1.5.2. Một số mô hình đảm bảo an toàn hệ thống thông tin .................................................. 21\n\n1.6. Câu hỏi ôn tập .................................................................................................................... 22\n\n# CHƯƠNG 2. CÁC DẠNG TẤN CÔNG VÀ PHẦN MỀM ĐỘC HẠI ....................................... 23\n\n2.1. Khái quát về mối đe dọa, điểm yếu, lỗ hổng và tấn công .................................................. 23\n\n2.1.1. Khái niệm mối đe dọa, điểm yếu, lỗ hổng và tấn công ............................................... 23\n\n2.1.2. Các dạng mối đe dọa thường gặp ................................................................................ 24\n\n2.1.3. Các loại tấn công ......................................................................................................... 25\n\n2.2. Các công cụ hỗ trợ tấn công ............................................................................................... 25\n\n2.2.1. Công cụ rà quét lỗ hổng, điểm yếu hệ thống ............................................................... 26\n\n2.2.2. Công cụ quét cổng dịch vụ .......................................................................................... 27\n\n2.2.3. Công cụ nghe lén ......................................................................................................... 27\n\n2.2.4. Công cụ ghi phím gõ ................................................................................................... 28\n\n2.3. Các dạng tấn công thường gặp ........................................................................................... 29\n\n2.3.1. Tấn công vào mật khẩu ............................................................................................... 29\n\n2.3.2. Tấn công bằng mã độc ................................................................................................ 30\n\n2.3.3. Tấn công từ chối dịch vụ ............................................................................................. 44\n\n2.3.4. Tấn công từ chối dịch vụ phân tán .............................................................................. 47\n\n2.3.5. Tấn công giả mạo địa chỉ ............................................................................................ 49\n\n2.3.6. Tấn công nghe lén ....................................................................................................... 50\n\n2.3.7. Tấn công kiểu người đứng giữa .................................................................................. 51\n\n---\n\n2\n\n2.3.8. Tấn công bằng bom thư và thư rác .............................................................................. 52\n\n2.3.9. Tấn công sử dụng các kỹ thuật xã hội ......................................................................... 52\n\n2.3.10. Tấn công pharming.................................................................................................... 55\n\n2.3.11. Tấn công APT ........................................................................................................... 56\n\n2.4. Các dạng phần mềm độc hại .............................................................................................. 57\n\n2.4.1. Phân loại ...................................................................................................................... 58\n\n2.4.2. Mô tả các dạng phần mềm độc hại .............................................................................. 59\n\n2.4.3. Phòng chống phần mềm độc hại ................................................................................. 64\n\n2.5. Câu hỏi ôn tập .................................................................................................................... 66\n\n# CHƯƠNG 3. ĐẢM BẢO AN TOÀN THÔNG TIN  DỰA TRÊN MÃ HÓA ............................. 67\n\n3.1. Khái quát về mã hóa thông tin và ứng dụng....................................................................... 67\n\n3.1.1. Các khái niệm .............................................................................................................. 67\n\n3.1.2. Các thành phần của một hệ mã hóa ............................................................................. 69\n\n3.1.3. Lịch sử mã hóa ............................................................................................................ 70\n\n3.1.4. Mã hóa dòng và mã hóa khối ...................................................................................... 71\n\n3.1.5. Ứng dụng của mã hóa.................................................................................................. 72\n\n3.2. Các phương pháp mã hóa ................................................................................................... 72\n\n3.2.1. Phương pháp thay thế .................................................................................................. 72\n\n3.2.2. Phương pháp hoán vị ................................................................................................... 73\n\n3.2.3. Phương pháp XOR ...................................................................................................... 73\n\n3.2.4. Phương pháp Vernam .................................................................................................. 74\n\n3.2.5. Phương pháp sách hoặc khóa chạy .............................................................................. 74\n\n3.2.6. Phương pháp hàm băm ................................................................................................ 74\n\n3.3. Các giải thuật mã hóa ......................................................................................................... 75\n\n3.3.1. Các giải thuật mã hóa khóa đối xứng .......................................................................... 75\n\n3.3.2. Các giải thuật mã hóa khóa bất đối xứng .................................................................... 83\n\n3.3.3. Các hàm băm ............................................................................................................... 86\n\n3.4. Chữ ký số, chứng chỉ số và PKI ......................................................................................... 91\n\n3.4.1. Chữ ký số .................................................................................................................... 91\n\n3.4.2. Chứng chỉ số ................................................................................................................ 95\n\n3.4.3. PKI .............................................................................................................................. 97\n\n3.5. Quản lý khóa và phân phối khóa ........................................................................................ 98\n\n3.5.1. Giới thiệu ..................................................................................................................... 98\n\n3.5.2. Phân phối khóa bí mật ............................................................................................... 100\n\n3.5.3. Phân phối khóa công khai ......................................................................................... 103\n\n3.6. Một số giao thức đảm bảo ATTT dựa trên mã hóa .......................................................... 105\n\n3.6.1. SSL/TLS .................................................................................................................... 105\n\n3.6.2. SET ............................................................................................................................ 108\n\n3.6.3. PGP............................................................................................................................ 109\n\n3.7. Câu hỏi ôn tập .................................................................................................................. 112\n\n# CHƯƠNG 4. CÁC KỸ THUẬT VÀ CÔNG NGHỆ ĐẢM BẢO  AN TOÀN THÔNG TIN ... 114\n\n4.1. Khái quát về các kỹ thuật và công nghệ đảm bảo ATTT ................................................. 114\n\n4.2. Kiểm soát truy cập ............................................................................................................ 115\n\n4.2.1. Khái niệm kiểm soát truy cập .................................................................................... 115\n\n---\n\n3\n\n4.2.2. Các biện pháp kiểm soát truy cập.............................................................................. 116\n\n4.2.3. Một số công nghệ kiểm soát truy cập ........................................................................ 121\n\n4.3. Tường lửa ......................................................................................................................... 126\n\n4.3.1. Giới thiệu tường lửa .................................................................................................. 126\n\n4.3.2. Các loại tường lửa ..................................................................................................... 128\n\n4.3.3. Các kỹ thuật kiểm soát truy cập ................................................................................ 129\n\n4.3.4. Các hạn chế của tường lửa ........................................................................................ 130\n\n4.4. Các hệ thống phát hiện và ngăn chặn xâm nhập .............................................................. 130\n\n4.4.1. Giới thiệu ................................................................................................................... 130\n\n4.4.2. Phân loại .................................................................................................................... 131\n\n4.4.3. Các kỹ thuật phát hiện xâm nhập .............................................................................. 132\n\n4.5. Câu hỏi ôn tập .................................................................................................................. 134\n\n# CHƯƠNG 5. QUẢN LÝ, CHÍNH SÁCH VÀ PHÁP LUẬT  AN TOÀN THÔNG TIN .......... 136\n\n5.1. Quản lý an toàn thông tin ................................................................................................. 136\n\n5.1.1. Khái quát về quản lý an toàn thông tin...................................................................... 136\n\n5.1.2. Đánh giá rủi ro an toàn thông tin .............................................................................. 137\n\n5.1.3. Phân tích chi tiết rủi ro an toàn thông tin .................................................................. 139\n\n5.1.4. Thực thi quản lý an toàn thông tin ............................................................................ 142\n\n5.2. Các chuẩn quản lý an toàn thông tin ................................................................................ 144\n\n5.2.1. Giới thiệu ................................................................................................................... 144\n\n5.2.2. Chu trình Plan-Do-Check-Act ................................................................................... 145\n\n5.3. Pháp luật và chính sách an toàn thông tin ........................................................................ 146\n\n5.3.1. Giới thiệu về pháp luật và chính sách an toàn thông tin ........................................... 146\n\n5.3.2. Luật quốc tế về an toàn thông tin .............................................................................. 147\n\n5.3.3. Luật Việt Nam về an toàn thông tin .......................................................................... 148\n\n5.4. Vấn đề đạo đức an toàn thông tin ..................................................................................... 149\n\n5.4.1. Sự cần thiết của đạo đức an toàn thông tin ............................................................... 149\n\n5.4.2. Một số bộ quy tắc ứng xử trong CNTT và ATTT ..................................................... 149\n\n5.4.3. Một số vấn đề khác.................................................................................................... 150\n\n5.5. Câu hỏi ôn tập .................................................................................................................. 151\n\nTÀI LIỆU THAM KHẢO ........................................................................................................... 152\n\n---\n\n4\n\n# DANH MỤC CÁC HÌNH\n\nHình 1.1. Các thuộc tính cần bảo vệ của tài sản thông tin: Bí mật (C),  Toàn vẹn (I) và Sẵn dùng\n\n(A) ................................................................................................................................................. 10\n\nHình 1.2. Thống kê và dự báo số lượng các thiết bị IoT kết nối Internet từ 2015 đến 2025 ........ 11\n\nHình 1.3. Số lượng sự cố mất ATTT báo cáo bởi các cơ quan chính phủ Hoa Kỳ  giai đoạn 2006-\n\n2018 [3] ......................................................................................................................................... 12\n\nHình 1.4. Các thành phần chính của An toàn thông tin ................................................................ 13\n\nHình 1.5. Chu trình quản lý an toàn thông tin ............................................................................... 14\n\nHình 1.6. Chính sách an toàn thông tin ......................................................................................... 14\n\nHình 1.7. Mô hình hệ thống thông tin của cơ quan, tổ chức ......................................................... 15\n\nHình 1.8. Các thành phần của hệ thống thông tin và an toàn hệ thống thông tin .......................... 16\n\nHình 1.9. Một văn bản được đóng dấu Confidential (Mật) ........................................................... 17\n\nHình 1.10. Đảm bảo tính bí mật bằng đường hầm VPN, hoặc mã hóa ......................................... 17\n\nHình 1.11. Minh họa tính sẵn dùng: (a) không đảm bảo và (b) đảm bảo tính sẵn dùng ............... 18\n\nHình 1.12. Bảy vùng trong hạ tầng CNTT theo mức kết nối mạng .............................................. 18\n\nHình 1.13. Đảm bảo ATTT cần cân bằng giữa mức An toàn, Chi phí và tính Hữu dụng ............ 21\n\nHình 1.14. Mô hình đảm bảo an toàn thông tin với bảy lớp ......................................................... 21\n\nHình 1.15. Mô hình đảm bảo an toàn thông tin với ba lớp chính ................................................. 22\n\nHình 2.1. Phân bố lỗ hổng bảo mật trong các thành phần của hệ thống ....................................... 24\n\nHình 2.2. Phân bố lỗ hổng bảo mật theo mức độ nghiêm trọng .................................................... 24\n\nHình 2.3. Báo cáo kết quả quét của Microsoft Baseline Security Analyzer ................................. 26\n\nHình 2.4. Kết quả quét website sử dụng Acunetix Web Vulnerability Scanner ........................... 27\n\nHình 2.5. Giao diện của công cụ Zenmap ..................................................................................... 28\n\nHình 2.6. Sử dụng Wireshark để bắt gói tin có chứa thông tin nhạy cảm..................................... 28\n\nHình 2.7. Mô đun Keylogger phần cứng và cài đặt trên máy tính để bàn..................................... 29\n\nHình 2.8. Các vùng bộ nhớ cấp cho chương trình ......................................................................... 32\n\nHình 2.9. Một chương trình minh họa cấp phát bộ nhớ trong ngăn xếp ....................................... 32\n\nHình 2.10. Các thành phần được lưu trong vùng bộ nhớ trong ngăn xếp ..................................... 33\n\nHình 2.11. Cấp phát bộ nhớ cho các biến nhớ trong vùng bộ nhớ trong ngăn xếp ....................... 33\n\nHình 2.12. Một chương trình minh họa gây tràn bộ nhớ đệm trong ngăn xếp .............................. 33\n\nHình 2.13. Minh họa hiện tượng tràn bộ nhớ đệm trong ngăn xếp ............................................... 34\n\nHình 2.14. Một shellcode viết bằng hợp ngữ và chuyển thành chuỗi tấn công ............................ 35\n\nHình 2.15. Chèn và thực hiện shellcode khai thác lỗi tràn bộ đệm ............................................... 35\n\nHình 2.16. Chèn shellcode với phần đệm bằng lệnh NOP (N) ..................................................... 35\n\nHình 2.17. Bản đồ lây nhiễm sâu Slammer (mầu xanh) theo trang www.caida.org vào ngày\n\n25/1/2003 lúc 6h00 (giờ UTC) với 74.855 máy chủ bị nhiễm ...................................................... 36\n\nHình 2.18. Cung cấp dữ liệu quá lớn để gây lỗi cho ứng dụng ..................................................... 38\n\nHình 2.19. Form đăng nhập (log on) và đoạn mã xử lý xác thực người dùng .............................. 40\n\nHình 2.20. Form tìm kiếm sản phẩm và đoạn mã xử lý tìm sản phẩm ......................................... 41\n\nHình 2.21. (a) Thủ tục bắt tay 3 bước của TCP và (b) Tấn công SYN Flood ............................... 45\n\nHình 2.22. Mô hình tấn công Smurf .............................................................................................. 46\n\nHình 2.23. Kiến trúc tấn công DDoS trực tiếp .............................................................................. 48\n\nHình 2.24. Kiến trúc tấn công DDoS gián tiếp hay phản xạ ......................................................... 48\n\nHình 2.25. Minh họa tấn công giả mạo địa chỉ IP ......................................................................... 50\n\n---\n\n5\n\nHình 2.26. Một mô hình tấn công nghe lén ................................................................................... 50\n\nHình 2.27. Mô hình chung của tấn công kiểu người đứng giữa .................................................... 51\n\nHình 2.28. Một kịch bản tấn công kiểu người đứng giữa ............................................................. 51\n\nHình 2.29. Một phishing email gửi cho khách hàng của mạng đấu giá eBay ............................... 54\n\nHình 2.30. Một phishing email gửi cho khách hàng của ngân hàng Royal Bank ......................... 54\n\nHình 2.31. Tấn công pharming \"cướp\" trình duyệt ....................................................................... 55\n\nHình 2.32. Tấn công pharming thông qua tấn công vào máy chủ DNS ........................................ 56\n\nHình 2.33. Các dạng phần mềm độc hại ....................................................................................... 58\n\nHình 2.34. Chèn và gọi thực hiện mã vi rút .................................................................................. 60\n\nHình 2.35. Một email do vi rút gửi đến người dùng ..................................................................... 61\n\nHình 2.36. Một mô hình lây lan của sâu mạng ............................................................................. 62\n\nHình 2.37. Mô hình mô hình giao tiếp giữa các thành phần trong botnet ..................................... 63\n\nHình 2.38. Mô hình tin tặc sử dụng các máy tính Zombie/Bot để gửi thư rác .............................. 63\n\nHình 2.39. Màn hình chính của Microsoft Windows Defender .................................................... 65\n\nHình 3.1. Các khâu Mã hóa và Giải mã của một hệ mã hóa ......................................................... 68\n\nHình 3.2. Mã hóa khóa đối xứng sử dụng chung 1 khóa bí mật ................................................... 68\n\nHình 3.3. Mã hóa khóa bất đối xứng sử dụng một cặp khóa ......................................................... 69\n\nHình 3.4. Minh họa đầu vào (Input) và đầu ra (Digest) của hàm băm .......................................... 69\n\nHình 3.5. Các thành phần của một hệ mã hóa đơn giản ................................................................ 70\n\nHình 3.6. Mô hình phương pháp mã hóa dòng ............................................................................. 71\n\nHình 3.7. Mô hình phương pháp mã hóa khối .............................................................................. 71\n\nHình 3.8. Mã hóa bằng hệ mã hóa Caesar cipher .......................................................................... 72\n\nHình 3.9. Phương pháp thay thế với 4 bộ chữ mã ......................................................................... 73\n\nHình 3.10. Phương pháp hoán vị thực hiện đổi chỗ các bit .......................................................... 73\n\nHình 3.11. Phương pháp hoán vị thực hiện đổi chỗ các ký tự ...................................................... 73\n\nHình 3.12. Ví dụ mã hóa bằng phương pháp XOR ....................................................................... 73\n\nHình 3.13. Mã hóa bằng phương pháp Vernam ............................................................................ 74\n\nHình 3.14. Các khâu mã hóa và giải mã của DES ........................................................................ 76\n\nHình 3.15. Thủ tục sinh các khóa phụ từ khóa chính của DES ..................................................... 77\n\nHình 3.16. Các bước xử lý chuyển khối rõ 64 bit thành khối mã 64 bit của DES ........................ 77\n\nHình 3.17. Các bước xử lý của hàm Feistel (F) ............................................................................ 78\n\nHình 3.18. Mã hóa và giải mã với giải thuật 3-DES ..................................................................... 79\n\nHình 3.19. Các bước xử lý mã hóa dữ liệu của AES .................................................................... 80\n\nHình 3.20. Thủ tục sinh khóa Rijndael .......................................................................................... 81\n\nHình 3.21. Hàm SubBytes sử dụng Rijndael S-box ...................................................................... 82\n\nHình 3.22. Hàm ShiftRows ........................................................................................................... 82\n\nHình 3.23. Hàm MixColumns ....................................................................................................... 82\n\nHình 3.24. Hàm AddRoundKey .................................................................................................... 82\n\nHình 3.25. Quá trình mã hóa và giải mã trong AES ..................................................................... 83\n\nHình 3.26. Mô hình nén thông tin của hàm băm ........................................................................... 86\n\nHình 3.27. Phân loại các hàm băm theo khóa sử dụng ................................................................. 87\n\nHình 3.28. Mô hình tổng quát xử lý dữ liệu của hàm băm ........................................................... 88\n\nHình 3.29. Mô hình chi tiết xử lý dữ liệu của hàm băm ............................................................... 88\n\nHình 3.30. Lưu đồ xử lý một thao tác của MD5 ........................................................................... 90\n\nHình 3.31. Lưu đồ một vòng xử lý của SHA1 .............................................................................. 91\n\nHình 3.32. Quá trình tạo chữ ký số và kiểm tra chữ ký số ............................................................ 92\n\n---\n\n6\n\nHình 3.33. Giao diện kiểm tra thông tin một chứng chỉ số ........................................................... 95\n\nHình 3.34. Nội dung chi tiết của một chứng chỉ số ....................................................................... 96\n\nHình 3.35. Lưu đồ cấp và sử dụng chứng chỉ số trong PKI .......................................................... 97\n\nHình 3.36. Phân phối khóa điểm – điểm ..................................................................................... 101\n\nHình 3.37. Mô hình hoạt động của trung tâm phân phối khóa – KDC ....................................... 101\n\nHình 3.38. Mô hình hoạt động của trung tâm dịch chuyển khóa – KTC .................................... 102\n\nHình 3.39. SSL/TLS trong bộ giao thức TCP/IP ........................................................................ 105\n\nHình 3.40. Các giao thức con của SSL/TLS ............................................................................... 105\n\nHình 3.41. Mô hình truyền thông giữa Web Server và Browser dựa trên SSL/TLS .................. 106\n\nHình 3.42. Khởi tạo phiên làm việc trong SSL/TLS ................................................................... 107\n\nHình 3.43. Quá trình xử lý dữ liệu bởi SSL Record tại bên gửi ................................................. 108\n\nHình 3.44. Một mô hình tương tác giữa các thực thể tham gia SET ........................................... 109\n\nHình 3.45. Mô hình PGP chỉ đảm bảo tính xác thực thông điệp................................................. 110\n\nHình 3.46. Mô hình PGP chỉ đảm bảo tính bí mật thông điệp .................................................... 111\n\nHình 3.47. Mô hình PGP đảm bảo tính bí mật và xác thực thông điệp....................................... 112\n\nHình 4.1. Các kỹ thuật và công nghệ bảo mật trong các lĩnh vực của ATTT ............................. 114\n\nHình 4.2. Mô hình ma trận kiểm soát truy cập ............................................................................ 117\n\nHình 4.3. Mô hình danh sách kiểm soát truy cập ........................................................................ 117\n\nHình 4.4. Mô hình kiểm soát truy cập Bell-LaPadula ................................................................. 119\n\nHình 4.5. Một mô hình RBAC đơn giản ..................................................................................... 120\n\nHình 4.6. Một số luật của tường lửa lọc gói tin .......................................................................... 121\n\nHình 4.7. Giao diện kiểm tra thông tin của một chứng chỉ số khóa công khai ........................... 123\n\nHình 4.8. Thẻ thông minh tiếp xúc (a) và thẻ không tiếp xúc (b) ............................................... 123\n\nHình 4.9. Một số thẻ bài (Token) của hãng RSA Security .......................................................... 124\n\nHình 4.10. Ví điện tử (một dạng thẻ bài) của cổng thanh toán trực tuyến Paypal ...................... 124\n\nHình 4.11. Hệ thống ApplePay tích hợp vào điện thoại di động ................................................ 124\n\nHình 4.12. (a) Khóa vân tay, (b) Khe xác thực vân tay trên laptop và  (c) Xác thực vân tay trên\n\nđiện thoại thông minh Samsung .................................................................................................. 125\n\nHình 4.13. Quét võng mạc nhận dạng tròng mắt ........................................................................ 125\n\nHình 4.14. Một tường lửa phần cứng chuyên dụng của Cisco .................................................... 126\n\nHình 4.15. Tường lửa bảo vệ mạng gia đình hoặc văn phòng nhỏ ............................................. 127\n\nHình 4.16. Tường lửa bảo vệ các máy chủ dịch vụ ..................................................................... 127\n\nHình 4.17. Hệ thống tường lửa bảo vệ các máy chủ dịch vụ và máy trạm ................................. 127\n\nHình 4.18. Mô hình tường lửa lọc gói (a), Cổng ứng dụng (b) và  Cổng chuyển mạch (c) ........ 128\n\nHình 4.19. Tường lửa có trạng thái chặn gói tin không thuộc kết nối đang hoạt động ............... 129\n\nHình 4.20. Vị trí các hệ thống IDS và IPS trong sơ đồ mạng ..................................................... 130\n\nHình 4.21. Các NIDS được bố trí để giám sát phát hiện xâm nhập tại cổng vào  và cho từng phân\n\nđoạn mạng ................................................................................................................................... 131\n\nHình 4.22. Sử dụng kết hợp NIDS và HIDS để giám sát lưu lượng mạng và các host .............. 132\n\nHình 4.23. Lưu đồ giám sát phát hiện tấn công, xâm nhập dựa trên chữ ký ............................... 133\n\nHình 4.24. Giá trị entropy của IP nguồn của các gói tin từ lưu lượng hợp pháp  (phần giá trị cao,\n\nđều) và entropy của IP nguồn của các gói tin  từ lưu lượng tấn công DDoS (phần giá trị thấp) 134\n\nHình 5.1. Quan hệ giữa các khâu trong quản lý an toàn thông tin .............................................. 137\n\nHình 5.2. Mô hình đánh giá rủi ro an toàn thông tin ................................................................... 137\n\nHình 5.3. Chu trình Plan-Do-Check-Act của ISO/IEC 27001:2005 ........................................... 145\n\n---\n\n7\n\n# DANH MỤC CÁC THUẬT NGỮ TIẾNG ANH VÀ VIẾT TẮT\n\n## Từ\n\nviết tắt\n\n## Thuật ngữ tiếng Anh/Giải thích\n\n## Thuật ngữ tiếng Việt/Giải thích\n\n# AES\n\n## Advanced Encryption Standard\n\n## Chuẩn mã hóa tiên tiến\n\n# ATTT\n\n## Information Security\n\n## An toàn thông tin\n\n# CNTT\n\n## Information Technology\n\n## Công nghệ thông tin\n\n# CRC\n\n## Cyclic redundancy checks\n\n## Kiểm tra dư thừa vòng\n\n# DAC\n\n## Discretionary Access Control\n\n## Kiểm soát truy cập tuỳ chọn\n\n# DES\n\n## Data Encryption Standard\n\n## Chuẩn mã hóa dữ liệu\n\n# DNS\n\n## Domain Name System\n\n## Hệ thống tên miền\n\n# FTP\n\n## File Transfer Protocol\n\n## Giao thức truyền file\n\n# HTTT\n\n## Information System\n\n## Hệ thống thông tin\n\n# IDEA\n\n## International Data Encryption Algorithm\n\n## Giải thuật mã hóa dữ liệu quốc tế\n\n## IPSec\n\n## Internet Protocol Security\n\n## An toàn giao thức Internet\n\n# LAN\n\n## Local Area Network\n\n## Mạng cục bộ\n\n# MAC\n\n## Mandatory Access Control\n\n## Kiểm soát truy cập bắt buộc\n\n# MAC\n\n## Message Authentication Code\n\n## Mã xác thực thông điệp (sử dụng hàm\n\nbăm có khóa)\n\n# MD\n\n## Message Digest\n\n## Chuỗi đại diện thông điệp\n\n# MDC\n\n## Modification Detection Code\n\n## Mã phát hiện sử đổi (sử dụng hàm băm\n\nkhông khóa)\n\n# NSA\n\n## National Security Agency\n\n## Cơ quan mật vụ liên bang Mỹ\n\n# PGP\n\n## Pretty Good Privacy\n\n## Chuẩn bảo mật PGP\n\n# PKI\n\n## Public Key Infrastructure\n\n## Hạ tầng khóa công khai\n\n# RBAC\n\n## Role-Based Access Control\n\n## Kiểm soát truy cập dựa trên vai trò\n\n# RSA\n\n## RSA Public Key Croptosystem\n\n## Hệ mật khóa công khai RSA\n\n# SET\n\n## Secure Electronic Transactions\n\n## Các giao dịch điện tử an toàn\n\n# SHA\n\n## Secure Hash Algorithm\n\n## Giải thuật băm an toàn\n\n# SMTP\n\n## Simple Mail Transfer Protocol\n\n## Giao thức truyền thư điện tử đơn giản\n\n# SSH\n\n## Secure Shell\n\n## Vỏ an toàn\n\n## SSL/TLS  Secure Socket Layer / Transport Layer\n\n## Security\n\n## Bộ giao thức bảo mật SSL / TLS\n\n# SSO\n\n## Single Sign On\n\n## Đăng nhập một lần\n\n# WAN\n\n## Wide Area Network\n\n## Mạng diện rộng\n\n# WLAN\n\n## Wireless Local Area Network\n\n## Mạng cục bộ không dây\n\n---\n\n8\n\n# MỞ ĐẦU\n\nAn toàn thông tin (Information security) là một lĩnh vực tương đối mới và được quan\n\ntâm trong vài thập kỷ gần đây và phát triển mạnh trong khoảng hơn một thập kỷ qua nhờ\n\nsự phát triển mạnh mẽ của mạng Internet và các dịch vụ mạng trên nền Internet. Tuy\n\nnhiên, do Internet ngày càng mở rộng và gần như không còn khái niệm biên giới quốc gia\n\ntrong không gian mạng, các sự cố mất an toàn thông tin liên tục xảy ra và đặc biệt các\n\ndạng tấn công, xâm nhập các hệ thống máy tính và mạng xuất hiện ngày càng phổ biến và\n\nmức độ phá hoại ngày càng nghiêm trọng. Vấn đề đảm bảo an toàn cho thông tin, các hệ\n\nthống và mạng trở nên cấp thiết và là mối quan tâm của mỗi quốc gia, cơ quan, tổ chức\n\nvà mỗi người dùng.\n\nAn toàn thông tin được định nghĩa là việc bảo vệ chống truy nhập, sử dụng, tiết lộ,\n\nsửa đổi, hoặc phá hủy thông tin một cách trái phép. Dưới một góc nhìn khác, An toàn\n\nthông tin là việc bảo vệ các thuộc tính bí mật, tính toàn vẹn và tính sẵn dùng của các tài\n\nsản thông tin trong quá trình chúng được lưu trữ, xử lý, hoặc truyền tải. An toàn thông tin\n\ncó thể được chia thành ba thành phần chính: An toàn máy tính và dữ liệu, An ninh mạng\n\nvà Quản lý an toàn thông tin.\n\nMôn học An toàn và bảo mật hệ thống thông tin là môn học cơ sở chuyên ngành trong\n\nchương trình đào tạo đại học ngành Công nghệ thông tin của Học viện Công nghệ Bưu\n\nchính Viễn thông. Mục tiêu của môn học là cung cấp cho sinh viên các khái niệm và\n\nnguyên tắc cơ bản về đảm bảo an toàn thông tin, an toàn máy tính và an toàn hệ thống\n\nthông tin; các khái niệm về nguy cơ gây mất an toàn, các điểm yếu và các lỗ hổng bảo\n\nmật tồn tại trong hệ thống; các dạng tấn công, xâm nhập thường gặp vào hệ thống máy\n\ntính và mạng; các dạng phần mềm độc hại; các giải pháp, kỹ thuật và công cụ phòng\n\nchống, đảm bảo an toàn thông tin, hệ thống và mạng; vấn đề quản lý an toàn thông tin,\n\nchính sách, pháp luật và đạo đức an toàn thông tin.\n\nVới phạm vi là môn học cơ sở về an toàn và bảo mật thông tin và hệ thống, tác giả cố\n\ngắng trình bày những vấn đề cơ sở nhất phục vụ mục tiêu môn học. Nội dung của tài liệu\n\nbài giảng được biên soạn thành 5 chương với tóm tắt nội dung như sau:\n\nChương 1- Tổng quan về an toàn và bảo mật hệ thống thông tin giới thiệu các khái\n\nniệm về an toàn thông tin, an toàn hệ thống thông tin và các yêu cầu đảm bảo an toàn\n\nthông tin, an toàn hệ thống thông tin. Chương cũng đề cập các nguy cơ, rủi ro trong các\n\nvùng của hạ tầng công nghệ thông tin theo mức kết nối mạng. Phần cuối của chương giới\n\nthiệu mô hình tổng quát đảm bảo an toàn hệ thống thông tin.\n\n## Chương 2- Các dạng tấn công và phần mềm độc hại giới thiệu khái quát về mối đe\n\ndọa, điểm yếu, lỗ hổng tồn tại trong hệ thống và tấn công. Phần tiếp theo phân tích chi\n\ntiết các dạng tấn công điển hình vào các hệ thống máy tính và mạng, bao gồm tấn công\n\nvào mật khẩu, tấn công nghe lén, người đứng giữa, tấn công DoS, DDoS, tấn công sử\n\ndụng các kỹ thuật xã hội,… Nửa cuối của chương đề cập đến các dạng phần mềm độc\n\nhại, gồm cơ chế lây nhiễm,  tác hại và phòng chống.\n\n---\n\n9\n\nChương 3 – Đảm bảo an toàn thông tin dựa trên mã hóa giới thiệu các khái niệm cơ\n\nbản về mật mã, hệ mã hóa, các phương pháp mã hóa. Phần tiếp theo của chương trình bày\n\nmột số giải thuật cơ bản của mã hóa khóa đối xứng (DES, 3-DES và AES), mã hóa khóa\n\nbất đối xứng (RSA), các hàm băm (MD5 và SHA1), chữ ký số, chứng chỉ số và PKI.\n\nPhần cuối của chương đề cập vấn đề quản lý và phân phối khóa, và một số giao thức đảm\n\nbảo an toàn thông tin dựa trên mã hóa.\n\nChương 4- Các kỹ thuật và công nghệ đảm bảo an toàn thông tin giới thiệu khái quát\n\nvề các kỹ thuật và công nghệ đảm bảo an toàn thông tin, vấn đề kiểm soát truy cập, các\n\ncơ chế (mô hình) kiểm soát truy cập và một số công nghệ kiểm soát truy cập được sử\n\ndụng trên thực tế. Phần tiếp theo của chương giới thiệu về tường lửa – một trong các kỹ\n\nthuật được sử dụng rất phổ biến trong đảm bảo an toàn cho hệ thống máy tính và mạng.\n\nPhần cuối của chương giới thiệu về các hệ thống phát hiện và ngăn chặn xâm nhập.\n\nChương 5 – Quản lý, chính sách và pháp luật an toàn thông tin giới thiệu một số khái\n\nniệm cơ bản trong quản lý an toàn thông tin, vấn đề đánh giá rủi ro an toàn thông tin và\n\nthực thi quản lý an toàn thông tin. Nội dung tiếp theo được đề cập là các chuẩn quản lý an\n\ntoàn thông tin, trong đó giới thiệu một số chuẩn của bộ chuẩn ISO/IEC 27000. Phần cuối\n\ncủa chương giới thiệu khái quát về các vấn đề chính sách, pháp luật và đạo đức an toàn\n\nthông tin.\n\nTài liệu được biên soạn dựa trên kinh nghiệm giảng dạy môn học An toàn và bảo mật\n\nhệ thống thông tin trong nhiều năm của tác giả tại Học viện Công nghệ Bưu chính Viễn\n\nthông, kết hợp tiếp thu các đóng góp của đồng nghiệp và phản hồi từ sinh viên. Tài liệu\n\ncó thể được sử dụng làm tài liệu học tập cho sinh viên hệ đại học ngành Công nghệ thông\n\ntin. Trong quá trình biên soạn và hiệu chỉnh, mặc dù tác giả đã rất cố gắng song không\n\nthể tránh khỏi có những thiếu sót. Tác giả rất mong muốn nhận được ý kiến phản hồi và\n\ncác góp ý cho các thiếu sót, cũng như ý kiến về việc cập nhật, hoàn thiện hơn nữa nội\n\ndung của tài liệu.\n\n## Hà Nội, Tháng 12 năm 2021\n\n## Tác giả\n\n## TS. Hoàng Xuân Dậu\n\n---\n\n10\n\n# CHƯƠNG 1. TỔNG QUAN VỀ AN TOÀN BẢO MẬT\n\n# HỆ THỐNG THÔNG TIN\n\nChương 1 giới thiệu các khái niệm về an toàn thông tin, an toàn hệ thống thông tin và\n\ncác yêu cầu đảm bảo an toàn thông tin và an toàn hệ thống thông tin. Chương này cũng\n\nđề cập các  rủi ro và nguy cơ trong các vùng của hạ tầng công nghệ thông tin theo mức\n\nkết nối mạng. Phần cuối của chương giới thiệu mô hình tổng quát đảm an toàn hệ thống\n\nthông tin.\n\n1.1. Khái quát về an toàn thông tin\n\n1.1.1. An toàn thông tin là gì?\n\nAn toàn thông tin (Information security) là việc bảo vệ chống truy nhập, sử dụng, tiết\n\nlộ, sửa đổi, hoặc phá hủy thông tin một cách trái phép, Viện SAN, Hoa Kỳ\n\n(https://www.sans.org/information-security/).\n\nTheo cuốn Principles of Information Security, An toàn thông tin là việc bảo vệ các\n\nthuộc tính bí mật, tính toàn vẹn và tính sẵn dùng của các tài sản thông tin trong quá trình\n\nchúng được lưu trữ, xử lý, hoặc truyền tải. Hình 1.1 minh họa ba thuộc tính cần bảo vệ\n\nnói trên của các tài sản thông tin, bao gồm dữ liệu và dịch vụ trong tam giác\n\n## CIA (Confidentiality - Integrity - Availability).\n\nHình 1.1. Các thuộc tính cần bảo vệ của tài sản thông tin: Bí mật (C),\n\n## Toàn vẹn (I) và Sẵn dùng (A)\n\nAn toàn thông tin gồm hai lĩnh vực chính là An toàn công nghệ thông tin (Information\n\ntechnology security, hay IT security) và Đảm bảo thông tin (Information assurance). An\n\ntoàn công nghệ thông tin, hay còn gọi là An toàn máy tính (Computer security) là việc\n\nđảm bảo an toàn cho các hệ thống công nghệ thông tin, bao gồm các hệ thống máy tính\n\nvà mạng, chống lại các cuộc tấn công phá hoại. Đảm bảo thông tin là việc đảm bảo thông\n\ntin không bị mất khi xảy ra các sự cố, như thiên tai, hỏng hóc, trộm cắp, phá hoại,… Đảm\n\nbảo thông tin thường được thực hiện sử dụng các kỹ thuật sao lưu ngoại vi (offsite\n\nbackup), trong đó dữ liệu thông tin từ hệ thống gốc được sao lưu ra các thiết bị lưu trữ vật\n\nlý đặt ở một vị trí khác.\n\n---\n\n11\n\n## Một số khái niệm khác trong an toàn thông tin:\n\nTruy cập (Access) là việc một chủ thể, người dùng hoặc một đối tượng có khả năng\n\nsử dụng, xử lý, sửa đổi, hoặc gây ảnh hưởng đến một chủ thể, người dùng hoặc một đối\n\ntượng khác. Trong khi người dùng hợp pháp có quyền truy cập hợp pháp đến một hệ\n\nthống thì tin tặc truy cập bất hợp pháp đến hệ thống.\n\nTài sản (Asset) là tài nguyên của các tổ chức, cá nhân được bảo vệ. Tài sản có thể là\n\ntài sản lô gíc, như một trang web, thông tin, hoặc dữ liệu. Tài sản có thể là tài sản vật lý,\n\nnhư hệ thống máy tính, thiết bị mạng, hoặc các tài sản khác.\n\nTấn công (Attack) là hành động có chủ ý hoặc không có chủ ý có khả năng gây hại,\n\nhoặc làm thỏa hiệp các thông tin, hệ thống và các tài sản được bảo vệ. Tấn công có thể\n\nchủ động hoặc thụ động, trực tiếp hoặc gián tiếp.\n\n1.1.2. Sự cần thiết của an toàn thông tin\n\nTrong những năm gần đây, cùng với sự phát triển mạnh mẽ của các thiết bị di động,\n\nvà đặc biệt là các thiết bị IoT, số lượng người dùng mạng Internet và số lượng thiết bị kết\n\nnối vào mạng Internet tăng trưởng nhanh chóng. Theo thống kê và dự báo của trang\n\nStatista [3] cho trên Hình 1.2, số lượng các thiết bị có kết nối Internet là khoảng 15 tỷ\n\ntrong năm 2015, tăng lên hơn 26 tỷ vào năm 2019 và dự báo sẽ rất tăng mạnh lên trên 75\n\ntỷ vào năm 2025. Các thiết bị IoT kết nối thông minh là nền tảng cho phát triển nhiều ứng\n\ndụng quan trọng trong các lĩnh vực của đời sống xã hội, như thành phố thông minh, cộng\n\nđồng thông minh, ngôi nhà thông minh, các ứng dụng giám sát và chăm sóc sức khỏe,…\n\nHình 1.2. Thống kê và dự báo số lượng các thiết bị IoT kết nối Internet từ 2015 đến 2025\n\nCùng với những lợi ích to lớn mà các thiết bị kết nối Internet mang lại, các sự cố mất\n\nan toàn thông tin đối với các hệ thống máy tính, điện thoại di động thông minh, các thiết\n\nbị IoT và người dùng cũng tăng vọt. Cũng theo số liệu thống kê của trang Statista [4] cho\n\ntrên Hình 1.3, số lượng các sự cố mất an toàn thông tin được thông báo bởi các cơ quan\n\n---\n\n12\n\nchính phủ Hoa Kỳ giai đoạn 2006-2015 tăng rất mạnh, từ 5.503 vụ vào năm 2006 lên đến\n\n77.183 vụ vào năm 2015. Tuy nhiên, trong các năm 2016-2018, số lượng các sự cố mất\n\nan toàn thông tin đã giảm đáng kể và chỉ còn 31.107 vụ vào năm 2018.\n\n## Hình 1.3. Số lượng sự cố mất ATTT báo cáo bởi các cơ quan chính phủ Hoa Kỳ\n\ngiai đoạn 2006-2018 [3]\n\n## Ở Việt Nam, trong báo cáo “Tổng kết an ninh mạng năm 2019 và dự báo xu hướng\n\n2020” [5], Tập đoàn công nghệ Bkav cho biết 20.892 tỷ đồng (tương đương khoảng 902\n\ntriệu USD) là tổng thiệt hại ước tính do vi rút máy tính và các dạng mã độc khác gây ra\n\nđối với người dùng Việt Nam trong năm 2019, vượt xa mốc 14.900 tỷ đồng thiệt hại do\n\nvi rút máy tính và các dạng mã độc khác trong năm 2018. Dự báo trong năm 2020 và các\n\nnăm tiếp theo, số lượng sự cố và thiệt hại do mất an toàn thông tin gây ra còn có thể lớn\n\nhơn nữa, do số lượng thiết bị kết nối tăng trưởng nhanh chóng và nguy cơ từ sự bùng\n\nphát mạnh của các phần mềm độc hại (mã độc tấn công APT sẽ tinh vi hơn, mã độc\n\nkhông file (Fileless) sẽ là xu hướng chính, các loại mã độc botnet, các loại mã độc mã\n\nhóa tống tiền (ransomware), mã độc đào tiền ảo…) và các kỹ thuật tấn công, phá hoại\n\nngày càng tinh vi.\n\nTừ các số liệu nêu trên có thể khẳng định, việc đảm bảo an toàn cho thông tin, máy\n\ntính, hệ thống mạng và các thiết bị kết nối khác là rất cần thiết bởi 2 lý do: (1) số lượng\n\ncác thiết bị có kết nối Internet tăng nhanh chóng, đặc biệt là các thiết bị thông minh, IoT\n\nvà (2) sự bùng phát của các dạng phần mềm độc hại, các dạng tấn công mạng trên diện\n\nrộng và các nguy cơ gây mất an toàn thông tin. Việc đảm bảo an toàn thông tin không chỉ\n\ncần thiết đối với các cá nhân, tổ chức, cơ quan, doanh nghiệp mà còn là vấn đề cấp thiết\n\nđối với an ninh quốc gia. Hơn nữa, việc xây dựng các giải pháp an toàn thông tin chỉ thực\n\nsự hiệu quả khi được thực hiện bài bản, đồng bộ, đảm bảo cân bằng giữa tính an toàn,\n\ntính hữu dụng của hệ thống và chi phí đầu tư cho các biện pháp đảm bảo an toàn.\n\n---\n\n13\n\n1.1.3. Các thành phần của an toàn thông tin\n\nAn toàn thông tin có thể được chia thành ba thành phần chính: an toàn máy tính và dữ\n\nliệu (Computer & data security), an ninh mạng (Network security) và quản lý an toàn\n\nthông tin (Management of information security). Ba thành phần của an toàn thông tin có\n\nquan hệ mật thiết và giao thoa với nhau, trong đó phần chung của cả ba thành phần trên là\n\nchính sách an toàn thông tin (Policy) như minh họa trên Hình 1.4.\n\n## Hình 1.4. Các thành phần chính của An toàn thông tin\n\n1.1.3.2. An toàn máy tính và dữ liệu\n\nAn toàn máy tính và dữ liệu là việc đảm bảo an toàn cho hệ thống phần cứng, phần\n\nmềm và dữ liệu trên máy tính; đảm bảo cho máy tính có thể vận hành an toàn, đáp ứng\n\ncác yêu cầu của người sử dụng. An toàn máy tính và dữ liệu bao gồm các nội dung:\n\n- Đảm bảo an toàn hệ điều hành, ứng dụng, dịch vụ;\n\n- Vấn đề kiểm soát truy cập;\n\n- Vấn đề mã hóa và bảo mật dữ liệu;\n\n- Vấn đề phòng chống phần mềm độc hại;\n\n- Việc sao lưu tạo dự phòng dữ liệu, đảm bảo dữ liệu lưu trong máy tính không bị\n\nmất mát khi xảy ra sự cố.\n\n1.1.3.3. An ninh mạng\n\nAn ninh mạng là việc đảm bảo an toàn cho hệ thống mạng và các thông tin truyền tải\n\ntrên mạng, chống lại các tấn công, xâm nhập trái phép. Các kỹ thuật và công cụ thường\n\nđược sử dụng trong an ninh mạng bao gồm:\n\n- Các tường lửa, proxy cho lọc gói tin và kiểm soát truy cập;\n\n- Mạng riêng ảo và các kỹ thuật bảo mật thông tin truyền như SSL/TLS, PGP;\n\n- Các kỹ thuật và hệ thống phát hiện, ngăn chặn tấn công, xâm nhập;\n\n- Vấn đề giám sát mạng.\n\n---\n\n14\n\n1.1.3.4. Quản lý an toàn thông tin\n\nQuản lý an toàn thông tin là việc quản lý và giám sát việc thực thi các biện pháp đảm\n\nbảo an toàn thông tin, giúp nâng cao hiệu quả của chúng. Một trong các nội dung cốt lõi\n\ncủa quản lý an toàn thông tin là việc quản lý các rủi ro (Risk management), trong đó việc\n\nnhận dạng và đánh giá rủi ro (Risk assessment) đóng vai trò then chốt. Các nội dung khác\n\ncủa quản lý an toàn thông tin, bao gồm các chuẩn an toàn thông tin, chính sách an toàn\n\nthông tin và vấn đề đào tạo, nâng cao ý thức an toàn thông tin của người dùng.\n\n## Hình 1.5. Chu trình quản lý an toàn thông tin\n\nViệc thực thi quản lý an toàn thông tin cần được thực hiện theo chu trình lặp lại, từ\n\nkhâu Lập kế hoạch (Plan), Thực thi kế hoạch (Implement), Giám sát kết quả thực hiện\n\n(Monitor) và Hiệu chỉnh kiểm soát (Control) như minh họa trên Hình 1.5, do các điều\n\nkiện bên trong và bên ngoài thay đổi theo thời gian.\n\n1.1.3.5. Chính sách an toàn thông tin\n\n## Hình 1.6. Chính sách an toàn thông tin\n\nChính sách an toàn thông tin (Information security policy) là các nội quy, quy định\n\ncủa tổ chức, nhằm đảm bảo các biện pháp đảm bảo an toàn thông tin được thực thi và\n\ntuân thủ. Chính sách an toàn thông tin, như minh họa trên Hình 1.6 gồm 3 thành phần:\n\n- Chính sách an toàn ở mức vật lý (Physical security policy);\n\n- Chính sách an toàn ở mức tổ chức (Organizational security policy);\n\n---\n\n15\n\n- Chính sách an toàn ở mức logic (Logical security policy).\n\nMột ví dụ về chính sách an toàn thông tin: để tăng cường an toàn cho hệ thống công\n\nnghệ thông tin, một tổ chức có thể áp dụng chính sách xác thực ‘mạnh’ sử dụng các đặc\n\nđiểm sinh trắc (Biometrics), như xác thực sử dụng vân tay thay cho mật khẩu truyền\n\nthống cho hệ thống cửa ra vào trung tâm dữ liệu, hoặc đăng nhập vào hệ thống máy tính.\n\n1.2. Khái quát về an toàn hệ thống thông tin\n\n1.2.1. Các thành phần của hệ thống thông tin\n\n## Hệ thống thông tin (Information system), theo cuốn sách Fundamentals of\n\nInformation Systems Security [2] là một hệ thống tích hợp các thành phần nhằm phục vụ\n\nviệc thu thập, lưu trữ, xử lý thông tin và chuyển giao thông tin, tri thức và các sản phẩm\n\nsố. Trong nền kinh tế số, hệ thống thông tin đóng vai trò rất quan trọng trong hoạt động\n\ncủa các tổ chức, cơ quan và doanh nghiệp (gọi chung là tổ chức). Có thể nói, hầu hết các\n\ntổ chức đều sử dụng các hệ thống thông tin với các quy mô khác nhau để quản lý các hoạt\n\nđộng của mình. Hình 1.7 minh họa mô hình một hệ thống thông tin điển hình. Trong mô\n\nhình này, mỗi hệ thống thông tin gồm ba thành phần chính: (i) Đầu vào là thành phần thu\n\nthập thông tin, (ii) Xử lý là thành phần xử lý thông tin và (iii) Đầu ra là thành phần kết\n\nxuất thông tin. Hệ thống thông tin được sử dụng để tương tác với khách hàng, với nhà\n\ncung cấp, với cơ quan chính quyền, với cổ đông và với đối thủ cạnh tranh. Có thể nêu ra\n\nmột số hệ thống thông tin điển hình, như các hệ lập kế hoạch nguồn lực doanh nghiệp,\n\ncác máy tìm kiếm và các hệ thống thông tin địa lý.\n\n## Hình 1.7. Mô hình hệ thống thông tin của cơ quan, tổ chức\n\nTrong lớp các hệ thống thông tin, hệ thống thông tin dựa trên máy tính (Computer-\n\nbased information system), hay sử dụng công nghệ máy tính để thực thi các nhiệm vụ là\n\nlớp hệ thống thông tin được sử dụng rộng rãi nhất. Hệ thống thông tin dựa trên máy tính\n\nthường gồm các thành phần chính: phần cứng (Hardware) để thu thập, lưu trữ, xử lý và\n\nbiểu diễn dữ liệu; phần mềm (Software) chạy trên phần cứng để xử lý dữ liệu; cơ sở dữ\n\n---\n\n16\n\nliệu (Databases) để lưu trữ dữ liệu; mạng (Networks) là hệ thống truyền dẫn thông tin/dữ\n\nliệu; và các thủ tục (Procedures) là tập hợp các lệnh kết hợp các bộ phận nêu trên để xử lý\n\ndữ liệu, đưa ra kết quả mong muốn.\n\n1.2.2. An toàn hệ thống thông tin là gì?\n\nAn toàn hệ thống thông tin (Information systems security) là việc đảm bảo các thuộc\n\ntính an ninh, an toàn của hệ thống thông tin, bao gồm tính bí mật, tính toàn vẹn và tính\n\nsẵn dùng. Hình 1.8 minh họa các thành phần của Hệ thống thông tin dựa trên máy tính và\n\n## An toàn hệ thống thông tin.\n\n## Hình 1.8. Các thành phần của hệ thống thông tin và an toàn hệ thống thông tin\n\n1.3. Các yêu cầu đảm bảo an toàn hệ thống thông tin\n\n## Như đã trình bày trong Mục 1.1.1, việc đảm bảo an toàn thông tin, hoặc hệ thống\n\nthông tin là việc đảm bảo ba thuộc tính quan trọng của thông tin, hoặc hệ thống, bao gồm\n\ntính Bí mật, tính Toàn vẹn và tính Sẵn dùng. Đây cũng là ba yêu cầu đảm bảo an toàn\n\nthông tin và hệ thống thông tin.\n\n1.3.1. Tính bí mật\n\n## Tính bí mật đảm bảo rằng chỉ người dùng có thẩm quyền mới được truy nhập thông\n\ntin, hệ thống. Các thông tin bí mật có thể bao gồm: (i) dữ liệu riêng của cá nhân, (ii) các\n\nthông tin thuộc quyền sở hữu trí tuệ của các doanh nghiệp hay các cơ quan, tổ chức và\n\n(iii) các thông tin có liên quan đến an ninh của các quốc gia và các chính phủ. Hình 1.9\n\nminh họa một văn bản được đóng dấu Confidential (Mật), theo đó chỉ những người có\n\nthẩm quyền (có thể không gồm người tạo, hoặc soạn thảo văn bản đó) mới được đọc và\n\nphổ biến văn bản.\n\nThông tin bí mật lưu trữ hoặc trong quá trình truyền tải cần được bảo vệ bằng các biện\n\npháp phù hợp, tránh bị lộ lọt hoặc bị đánh cắp. Các biện pháp có thể sử dụng để đảm bảo\n\ntính bí mật của thông tin như bảo vệ vật lý, hoặc sử dụng mật mã. Hình 1.10 minh họa\n\nviệc đảm bảo tính bí mật bằng cách sử dụng đường hầm VPN, hoặc mã hóa để truyền tải\n\nthông tin.\n\n---\n\n17\n\n## Hình 1.9. Một văn bản được đóng dấu Confidential (Mật)\n\n## Hình 1.10. Đảm bảo tính bí mật bằng đường hầm VPN, hoặc mã hóa\n\n1.3.2. Toàn vẹn\n\nTính toàn vẹn đảm bảo rằng thông tin và dữ liệu chỉ có thể được sửa đổi bởi những\n\nngười dùng có thẩm quyền. Tính toàn vẹn liên quan đến tính hợp lệ (validity) và chính\n\nxác (accuracy) của dữ liệu. Trong nhiều tổ chức, thông tin và dữ liệu có giá trị rất lớn,\n\nnhư bản quyền phần mềm, bản quyền âm nhạc, bản quyền phát minh, sáng chế. Mọi thay\n\nđổi không có thẩm quyền có thể ảnh hưởng rất nhiều đến giá trị của thông tin. Thông tin\n\nhoặc dữ liệu là toàn vẹn nếu nó thỏa mãn ba điều kiện: (i) không bị thay đổi, (ii) hợp lệ\n\nvà (iii) chính xác.\n\n1.3.3. Sẵn dùng\n\nTính sẵn dùng, sẵn sàng, hoặc khả dụng đảm bảo rằng thông tin, hoặc hệ thống có thể\n\ntruy nhập bởi người dùng hợp pháp bất cứ khi nào họ có yêu cầu. Tính sẵn dùng có thể\n\nđược đo bằng các yếu tố:\n\n- Thời gian cung cấp dịch vụ (Uptime);\n\n- Thời gian ngừng cung cấp dịch vụ (Downtime);\n\n- Tỷ lệ phục vụ: A = (Uptime) / (Uptime + Downtime);\n\n- Thời gian trung bình giữa các sự cố;\n\n- Thời gian trung bình ngừng để sửa chữa;\n\n- Thời gian khôi phục sau sự cố.\n\n---\n\n18\n\nHình 1.11 minh họa tính sẵn sàng của một hệ thống trong 2 trường hợp: (a) hệ thống\n\nkhông đảm bảo tính sẵn sàng khi có một số thành phần gặp sự cố (biểu diễn bằng biểu\n\ntượng có dấu X) do đó không có khả năng phục vụ tất cả các yêu cầu của người dùng\n\n(người dùng truy cập được dịch vụ biểu diễn bằng mũi tên thẳng “\n\n” người dùng không\n\ntruy cập được dịch vụ biểu diễn bằng mũi tên đi ra “\n\n”), và (b) hệ thống đảm bảo tính\n\nsẵn sàng khi tất cả các thành phần của nó hoạt động bình thường. Các biện pháp đảm bảo\n\nhoặc tăng cường tính sẵn sàng cho hệ thống có thể kể đến như: xây dựng hệ thống cung\n\ncấp dịch vụ dựa trên chuỗi cân bằng tải, hoặc nền tảng điện toán đám mây.\n\nHình 1.11. Minh họa tính sẵn dùng: (a) không đảm bảo và (b) đảm bảo tính sẵn dùng\n\n1.4. Bảy vùng trong hạ tầng CNTT và các mối đe dọa\n\n1.4.1. Bảy vùng trong cơ sở hạ tầng CNTT\n\n## Hạ tầng công nghệ thông tin (IT Infrastructure) của các cơ quan, tổ chức, doanh\n\nnghiệp có thể có quy mô lớn hay nhỏ khác nhau, nhưng thường gồm bảy vùng theo mức\n\nkết nối mạng như minh họa trên Hình 1.12.\n\n## Hình 1.12. Bảy vùng trong hạ tầng CNTT theo mức kết nối mạng\n\n---\n\n19\n\n## Theo đó, các vùng cụ thể gồm:\n\n- Vùng người dùng (User domain) gồm người dùng hệ thống, bao gồm nhân viên và\n\nkhách viếng thăm được cấp tài khoản truy cập vào hệ thống;\n\n- Vùng máy trạm (Workstation domain) gồm các máy tính và các thiết bị tính toán\n\nđược kết nối mạng LAN/WLAN;\n\n- Vùng mạng LAN (LAN domain) gồm hệ thống kết nối mạng LAN/WLAN và các\n\nmáy chủ nội bộ;\n\n- Vùng LAN-to-WAN (LAN-to-WAN domain) gồm hệ thống kết nối mạng\n\nLAN/WLAN đến mạng WAN;\n\n- Vùng mạng WAN (WAN domain) là vùng mạng diện rộng, hay mạng Internet toàn\n\ncầu;\n\n- Vùng truy cập từ xa (Remote Access domain) gồm các công cụ hỗ trợ người dùng\n\nkết nối từ xa đến hệ thống CNTT của cơ quan, tổ chức thông qua mạng Internet; và\n\n- Vùng hệ thống/ứng dụng (Systems/Application domain) gồm hệ thống máy chủ\n\ncung cấp các dịch vụ mạng, như máy chủ web, DNS, email và dịch vụ điện toán\n\nđám mây.\n\n## Do mỗi vùng nêu trên có đặc điểm khác nhau nên chúng có các mối đe dọa và nguy\n\ncơ mất an toàn thông tin khác nhau. Mục tiếp theo trình bày các mối đe dọa và nguy cơ\n\nđối với từng vùng.\n\n1.4.2. Các mối đe dọa và nguy cơ\n\n## Vùng người dùng\n\n## Có thể nói vùng người dùng là vùng có nhiều mối đe dọa và nguy cơ nhất do người\n\ndùng có bản chất khó đoán định và khó kiểm soát hành vi. Các vấn đề thường gặp như\n\nthiếu ý thức, coi nhẹ vấn đề an ninh an toàn, vi phạm các chính sách an ninh an toàn; đưa\n\nCD/DVD/USB với các file cá nhân vào hệ thống; tải ảnh, âm nhạc, video trái phép; phá\n\nhoại dữ liệu, ứng dụng và hệ thống; các nhân viên bất mãn có thể tấn công hệ thống từ\n\nbên trong, hoặc nhân viên có thể tống tiền hoặc chiếm đoạt thông tin nhạy cảm, thông tin\n\nquan trọng.\n\n## Vùng máy trạm\n\nVùng máy trạm cũng có nhiều mối đe dọa và nguy cơ do vùng máy trạm tiếp xúc trực\n\ntiếp với vùng người dùng. Các nguy cơ thường gặp gồm: truy nhập trái phép vào máy\n\ntrạm, hệ thống, ứng dụng và dữ liệu; các lỗ hổng an ninh trong hệ điều hành, trong các\n\nphần mềm ứng dụng máy trạm; các hiểm họa từ vi rút, mã độc và các phần mềm độc hại.\n\nNgoài ra, vùng máy trạm cũng chịu các nguy cơ do hành vi bị cấm từ người dùng, như\n\nđưa CD/DVD/USB với các file cá nhân vào hệ thống; tải ảnh, âm nhạc, video trái phép.\n\n## Vùng mạng LAN\n\n## Các nguy cơ có thể có đối với vùng mạng LAN bao gồm: truy nhập trái phép vào\n\nmạng LAN vật lý, truy nhập trái phép vào hệ thống, ứng dụng và dữ liệu; các lỗ hổng an\n\nninh trong hệ điều hành và các phần mềm ứng dụng máy chủ; nguy cơ từ người dùng giả\n\n---\n\n20\n\nmạo trong mạng WLAN; tính bí mật dữ liệu trong mạng WLAN có thể bị đe dọa do sóng\n\nmang thông tin của WLAN truyền trong không gian có thể bị nghe trộm. Ngoài ra, các\n\nhướng dẫn và cấu hình chuẩn cho máy chủ LAN nếu không được tuân thủ nghiêm ngặt sẽ\n\ndẫn đến những lỗ hổng an ninh mà tin tặc có thể khai thác.\n\n## Vùng mạng LAN-to-WAN\n\nVùng mạng LAN-to-WAN là vùng chuyển tiếp từ mạng nội bộ ra mạng diện rộng,\n\nnên nguy cơ lớn nhất là tin tặc từ mạng WAN có thể thăm dò và rà quét trái phép các\n\ncổng dịch vụ, nguy cơ truy nhập trái phép. Ngoài ra, một nguy cơ khác cần phải xem xét\n\nlà lỗ hổng an ninh trong các bộ định tuyến, tường lửa và các thiết bị mạng khác.\n\n## Vùng mạng WAN\n\n## Vùng mạng WAN, hay mạng Internet là vùng mạng mở, trong đó hầu hết dữ liệu\n\nđược truyền dưới dạng rõ, nên các nguy cơ lớn nhất là dễ bị nghe trộm và dễ bị tấn công\n\nphá hoại, tấn công từ chối dịch vụ (DoS) và từ chối dịch vụ phân tán (DDoS). Kẻ tấn\n\ncông có thể tự do, dễ dàng gửi email có đính kèm vi rút, sâu và các phần mềm độc hại.\n\n## Vùng truy nhập từ xa\n\nTrong vùng truy nhập từ xa, các nguy cơ điển hình bao gồm: tấn công kiểu vét cạn\n\nvào tên người dùng và mật khẩu, tấn công vào hệ thống đăng nhập và kiểm soát truy cập;\n\ntruy nhập trái phép vào hệ thống CNTT, ứng dụng và dữ liệu; các thông tin bí mật có thể\n\nbị đánh cắp từ xa; và vấn đề rò rỉ dữ liệu do vi phạm các tiêu chuẩn phân loại dữ liệu.\n\n## Vùng hệ thống và ứng dụng\n\nTrong vùng hệ thống và ứng dụng, các nguy cơ có thể bao gồm: truy nhập trái phép\n\nđến trung tâm dữ liệu, phòng máy hoặc tủ cáp; các khó khăn trong quản lý các máy chủ\n\nvới yêu cầu tính sẵn dùng cao; các lỗ hổng trong quản lý các phần mềm ứng dụng của hệ\n\nđiều hành máy chủ; các vấn đề an ninh trong các môi trường ảo của điện toán đám mây;\n\nvà vấn đề hỏng hóc hoặc mất dữ liệu.\n\n1.5. Mô hình tổng quát đảm bảo an toàn hệ thống thông tin\n\n1.5.1. Giới thiệu\n\n## Mô hình tổng quát đảm bảo an toàn hệ thống thông tin là Phòng vệ theo chiều sâu\n\n(Defence in Depth). Theo mô hình này, ta cần tạo ra nhiều lớp bảo vệ, kết hợp tính năng,\n\ntác dụng của mỗi lớp để đảm bảo an toàn tối đa cho thông tin, hệ thống và mạng. Một\n\nlớp, một công cụ phòng vệ riêng rẽ dù có hiện đại, nhưng vẫn không thể đảm bảo an toàn.\n\nDo vậy, việc tạo ra nhiều lớp bảo vệ có khả năng bổ sung cho nhau là cách làm hiệu quả.\n\nMột điểm khác cần lưu ý khi thiết kế và triển khai hệ thống đảm bảo an toàn thông tin\n\nlà cần cân bằng giữa Hữu dụng, Chi phí và An toàn, như minh họa trên Hình 1.13Error! R\n\neference source not found.. Hệ thống đảm bảo an toàn thông tin chỉ thực sự phù hợp và\n\nhiệu quả khi hệ thống được bảo vệ đạt mức an toàn phù hợp mà vẫn có khả năng cung\n\ncấp các tính năng hữu dụng cho người dùng, với chi phí cho đảm bảo an toàn phù hợp với\n\ntài sản được bảo vệ.\n\n---\n\n21\n\n## Hình 1.13. Đảm bảo ATTT cần cân bằng giữa mức An toàn, Chi phí và tính Hữu dụng\n\n1.5.2. Một số mô hình đảm bảo an toàn hệ thống thông tin\n\nHình 1.14 minh họa mô hình đảm bảo an toàn thông tin với bảy lớp bảo vệ, bao gồm\n\nlớp chính sách, thủ tục, ý thức (Policies, procedures, awareness); lớp vật lý (Physical);\n\nlớp ngoại vi (Perimeter); lớp mạng nội bộ (Internal network); lớp host (Host); lớp ứng\n\ndụng (Application) và lớp dữ liệu (Data). Trong mô hình này, để truy nhập được đến đối\n\ntượng đích là dữ liệu, tin tặc cần phải vượt qua cả 7 lớp bảo vệ.\n\n## Hình 1.14. Mô hình đảm bảo an toàn thông tin với bảy lớp\n\nCụ thể hơn, Hình 1.15 minh họa mô hình phòng vệ gồm 3 lớp: lớp an ninh tổ chức,\n\nlớp an ninh mạng và lớp an ninh hệ thống. Mỗi lớp trên lại gồm một số lớp con như sau:\n\n- Lớp an ninh cơ quan/tổ chức (Plant Security), gồm 2 lớp con:\n\n+ Lớp bảo vệ vật lý (Physical Security) có nhiệm vụ kiểm soát các truy nhập vật\n\nlý đến các trang thiết bị hệ thống và mạng.\n\n+ Lớp chính sách & thủ tục (Policies & procedures) bao gồm các quy trình quản\n\nlý ATTT, các hướng dẫn vận hành, quản lý hoạt động liên tục và phục hồi sau\n\nsự cố.\n\n- Lớp an ninh mạng (Network Security), gồm 2 lớp con:\n\n+ Lớp bảo vệ vùng hạn chế truy nhập (Security cells and DMZ) cung cấp các biện\n\npháp bảo vệ cho từng phân đoạn mạng.\n\n+ Lớp các tường lửa, mạng riêng ảo (Firewalls and VPN) được triển khai như\n\nđiểm truy nhập duy nhất đến một phân đoạn mạng.\n\n- Lớp an ninh hệ thống (System Integrity), gồm 4 lớp con:\n\n---\n\n22\n\n+ Lớp tăng cường an ninh hệ thống (System hardening) đảm bảo việc cài đặt và\n\ncấu hình các thành phần trong hệ thống đảm bảo các yêu cầu an toàn.\n\n+ Lớp quản trị tài khoản người dùng (User Account Management) thực hiện kiểm\n\nsoát truy cập dựa trên quyền truy nhập và các đặc quyền của người dùng.\n\n+ Lớp quản lý các bản vá (Patch Management) có nhiệm vụ định kỳ cài đặt các\n\nbản vá an ninh và các bản cập nhật cho hệ thống.\n\n+ Lớp phát hiện và ngăn chặn phần mềm độc hại (Malware detection and\n\nprevention) có nhiệm vụ bảo vệ hệ thống, chống vi rút và các phần mềm độc hại\n\nkhác.\n\n## Hình 1.15. Mô hình đảm bảo an toàn thông tin với ba lớp chính\n\n1.6. Câu hỏi ôn tập\n\n1) An toàn thông tin (Information Security) là gì?\n\n2) Tại sao cần phải đảm bảo an toàn cho thông tin?\n\n3) An toàn thông tin gồm những thành phần cơ bản nào?\n\n4) Đảm bảo thông tin thường được thực hiện bằng cách nào?\n\n5) An toàn hệ thống thông tin là gì?\n\n6) Nêu các yêu cầu đảm bảo an toàn thông tin và hệ thống thông tin.\n\n7) Nêu các mối đe dọa và nguy cơ trong vùng người dùng và vùng máy trạm trong hạ\n\ntầng CNTT. Tại sao nói vùng người dùng là vùng có nhiều nguy cơ và rủi ro nhất?\n\n8) Nêu các mối đe dọa và nguy cơ trong vùng mạng LAN, LAN-to-WAN và vùng mạng\n\n## WAN trong hạ tầng CNTT. Tại sao vùng mạng WAN có nguy cơ bị tấn công phá hoại\n\ncao?\n\n9) Mô hình tổng quát đảm bảo an toàn hệ thống thông tin là gì?\n\n10) Mô tả một mô hình tổng quát đảm bảo an toàn hệ thống thông tin.\n\n---\n\n23\n\n# CHƯƠNG 2. CÁC DẠNG TẤN CÔNG VÀ PHẦN MỀM ĐỘC HẠI\n\nChương 2 giới thiệu khái quát về mối đe dọa, điểm yếu, lỗ hổng tồn tại trong hệ thống\n\nvà khái niệm tấn công. Phần tiếp theo phân tích chi tiết các dạng tấn công điển hình vào\n\ncác hệ thống máy tính và mạng, bao gồm tấn công vào mật khẩu, tấn công nghe lén,\n\nngười đứng giữa, tấn công DoS, DDoS, tấn công sử dụng các kỹ thuật xã hội,… Nửa cuối\n\ncủa chương đề cập đến các dạng phần mềm độc hại, gồm cơ chế lây nhiễm, tác hại và\n\ngiải pháp phòng chống.\n\n2.1. Khái quát về mối đe dọa, điểm yếu, lỗ hổng và tấn công\n\n2.1.1. Khái niệm mối đe dọa, điểm yếu, lỗ hổng và tấn công\n\nMối đe dọa (Threat) là bất kỳ một hành động nào có thể gây hư hại đến các tài nguyên\n\nhệ thống. Các tài nguyên hệ thống bao gồm phần cứng, phần mềm, cơ sở dữ liệu, các file,\n\ndữ liệu, hoặc hạ tầng mạng vật lý,…\n\nCác điểm yếu hệ thống (System weaknesses) là các lỗi hay các khiếm khuyết tồn tại\n\ntrong hệ thống. Nguyên nhân của sự tồn tại các điểm yếu có thể do lỗi thiết kế, lỗi cài đặt,\n\nlỗi lập trình, hoặc lỗi quản trị, cấu hình hoạt động. Các điểm yếu có thể tồn tại trong cả\n\ncác mô đun phần cứng và các mô đun phần mềm. Một số điểm yếu được phát hiện và đã\n\nđược khắc phục. Tuy nhiên, có một số điểm yếu được phát hiện nhưng chưa được khắc\n\nphục, hoặc các điểm yếu chưa được phát hiện, hoặc chỉ tồn tại trong một điều kiện đặc\n\nbiệt nào đó.\n\nLỗ hổng bảo mật (Security vulnerability) là một điểm yếu tồn tại trong một hệ thống\n\ncho phép tin tặc khai thác gây tổn hại đến các thuộc tính an ninh của hệ thống đó, bao\n\ngồm tính toàn vẹn, tính bí mật, tính sẵn dùng. Nói chung, lỗ hổng bảo mật tồn tại trong\n\ntất cả các thành phần của hệ thống, bao gồm phần cứng, hệ điều hành và các phần mềm\n\nứng dụng. Theo số liệu thống kê từ Cơ sở dữ liệu lỗ hổng quốc gia Hoa Kỳ [6], trong\n\nnăm 2014, phân bố lỗ hổng bảo mật được phát hiện trên các thành phần của hệ thống lần\n\nlượt là phần cứng – 4%, hệ điều hành – 13% và phần mềm ứng dụng – 83%, như minh\n\nhọa trên Hình 2.1. Như vậy, có thể thấy các lỗ hổng bảo mật chủ yếu xuất hiện trong hệ\n\nthống phần mềm và phần lớn tồn tại trong các phần mềm ứng dụng.\n\n## Phụ thuộc vào khả năng bị khai thác, các lỗ hổng bảo mật có mức độ nghiêm trọng\n\n(severity) khác nhau. Theo Microsoft, có 4 mức độ nghiêm trọng của các lỗ hổng bảo\n\nmật: nguy hiểm (Critical), quan trọng (Important), trung bình (Moderate) và thấp (Low).\n\nTuy nhiên, một số tổ chức khác chỉ phân loại các lỗ hổng bảo mật theo 3 mức độ nghiêm\n\ntrọng: cao (High), trung bình (Medium) và thấp (Low). Cũng theo số liệu thống kê năm\n\n2014 từ [6] cho trên Hình 2.2, các lỗ hổng có mức độ nghiêm trọng cao chiếm 24%, các\n\nlỗ hổng có mức độ nghiêm trọng trung bình chiếm 68% và các lỗ hổng có mức độ\n\nnghiêm trọng thấp chỉ chiếm 8%. Như vậy, ta có thể thấy, đa số các lỗ hổng bảo mật có\n\nmức độ nghiêm trọng từ trung bình trở lên và cần được xem xét khắc phục càng sớm\n\ncàng tốt.\n\n---\n\n24\n\n## Hình 2.1. Phân bố lỗ hổng bảo mật trong các thành phần của hệ thống\n\n## Hình 2.2. Phân bố lỗ hổng bảo mật theo mức độ nghiêm trọng\n\nTấn công (Attack) là một, hoặc một chuỗi các hành động vi phạm các chính sách an\n\nninh an toàn của cơ quan, tổ chức, gây tổn hại đến các thuộc tính bí mật, toàn vẹn và sẵn\n\ndùng của thông tin, hệ thống và mạng. Một cuộc tấn công vào hệ thống máy tính hoặc\n\ncác tài nguyên mạng thường được thực hiện bằng cách khai thác các lỗ hổng tồn tại trong\n\nhệ thống. Như vậy, tấn công chỉ có thể trở thành hiện thực nếu có sự tồn tại đồng thời của\n\nmối đe dọa và lỗ hổng, hay có thể nói:\n\n## Tấn công  =  Mối đe dọa + Lỗ hổng\n\nNhư vậy, mối đe dọa và lỗ hổng bảo mật có quan hệ hữu cơ với nhau: Các mối đe dọa\n\nthường khai thác một hoặc một số lỗ hổng bảo mật đã biết để thực hiện các cuộc tấn công\n\nphá hoại. Điều này có nghĩa là nếu tồn tại một lỗ hổng trong hệ thống, sẽ có khả năng\n\nmột mối đe dọa trở thành hiện thực. Nói chung, không thể triệt tiêu được hết các mối đe\n\ndọa do đó là yếu tố khách quan, nhưng có thể giảm thiểu các lỗ hổng, qua đó giảm thiểu\n\nkhả năng bị khai thác để thực hiện tấn công.\n\n2.1.2. Các dạng mối đe dọa thường gặp\n\nTrên thực tế, không phải tất cả các mối đe dọa đều là ác tính hay độc hại (malicious).\n\nMột số mối đe dọa là chủ động, cố ý, nhưng một số khác chỉ là ngẫu nhiên, hoặc vô tình.\n\n## Các mối đe dọa thường gặp đối với thông tin, hệ thống và mạng:\n\n---\n\n25\n\n- Phần mềm độc hại\n\n- Kẻ tấn công ở bên trong\n\n- Kẻ tấn công ở bên ngoài\n\n- Hư hỏng phần cứng hoặc phần mềm\n\n- Mất trộm các thiết bị\n\n- Tai họa thiên nhiên\n\n- Gián điệp công nghiệp\n\n- Khủng bố phá hoại.\n\n2.1.3. Các loại tấn công\n\n## Có thể chia tấn công theo mục đích thực hiện thành 4 loại chính như sau:\n\n- Giả mạo (Fabrications): Tấn công giả mạo thông tin thường được sử dụng để đánh\n\nlừa người dùng thông thường;\n\n- Chặn bắt (Interceptions): Tấn công chặn bắt thường liên quan đến việc nghe lén\n\ntrên đường truyền và chuyển hướng thông tin để sử dụng trái phép;\n\n- Gây ngắt quãng (Interruptions): Tấn công gây ngắt quãng làm ngắt, hoặc chậm\n\nkênh truyền thông, hoặc làm quá tải hệ thống, ngăn cản việc truy nhập dịch vụ của\n\nngười dùng hợp pháp;\n\n- Sửa đổi (Modifications): Tấn công sửa đổi liên quan đến việc sửa đổi thông tin trên\n\nđường truyền hoặc sửa đổi dữ liệu file.\n\nTheo hình thức thực hiện, có thể chia các loại tấn công thành 2 kiểu chính như sau:\n\n- Tấn công chủ động (Active attacks): Tấn công chủ động là một đột nhập, xâm\n\nnhập (intrusion) về mặt vật lý vào hệ thống, hoặc mạng. Các tấn công chủ động\n\nthực hiện sửa đổi dữ liệu trên đường truyền, sửa đổi dữ liệu trong file, hoặc giành\n\nquyền truy nhập trái phép vào máy tính hoặc hệ thống mạng.\n\n- Tấn công thụ động (Passive attacks): Tấn công thụ động thường không gây ra thay\n\nđổi trên hệ thống. Các tấn công thụ động điển hình là nghe trộm và giám sát lưu\n\nlượng trên đường truyền.\n\nTrên thực tế, tấn công thụ động thường là giai đoạn đầu của tấn công chủ động, trong\n\nđó tin tặc sử dụng các kỹ thuật tấn công thụ động để thu thập các thông tin về hệ thống,\n\nmạng, và trên cơ sở thông tin có được sẽ lựa chọn kỹ thuật tấn công chủ động có xác suất\n\nthành công cao nhất.\n\n2.2. Các công cụ hỗ trợ tấn công\n\nCác công cụ hỗ trợ tấn công (Attacking assistant tools) là các công cụ phần cứng,\n\nphần mềm, hoặc các kỹ thuật hỗ trợ kẻ tấn công, tin tặc (attacker) thu thập các thông tin\n\nvề các hệ thống máy tính, hoặc mạng. Trên cơ sở các thông tin thu được, tin tặc sẽ lựa\n\nchọn công cụ, kỹ thuật tấn công có xác suất thành công cao nhất. Các công cụ hỗ trợ tấn\n\ncông bao gồm 4 nhóm chính: công cụ quét điểm yếu, lỗ hổng bảo mật, công cụ quét cổng\n\ndịch vụ, công cụ nghe lén và công cụ ghi phím gõ.\n\n---\n\n26\n\n2.2.1. Công cụ rà quét lỗ hổng, điểm yếu hệ thống\n\n## Các công cụ rà quét các điểm yếu hệ thống và lỗ hổng bảo mật có thể được người\n\nquản trị sử dụng để chủ động rà quét các hệ thống, nhằm tìm ra các điểm yếu và lỗ hổng\n\nbảo mật tồn tại trong hệ thống. Trên cơ sở kết quả rà quét, phân tích và đề xuất áp dụng\n\ncác biện pháp khắc phục phù hợp. Mặt khác, các công cụ này cũng có thể được kẻ tấn\n\ncông sử dụng để rà quét hệ thống và dựa trên kết quả rà quét điểm yếu, lỗ hổng để quyết\n\nđịnh dạng tấn công có khả năng thành công cao nhất. Các công cụ bao gồm, các công cụ\n\nrà quét lỗ hổng bảo mật hệ thống, và các công cụ rà quét lỗ hổng ứng dụng web, hay các\n\ntrang web.\n\n2.2.1.1. Công cụ rà quét lỗ hổng bảo mật hệ thống\n\n## Các công cụ rà quét lỗ hổng bảo mật hệ thống cho phép rà quét hệ thống, tìm các\n\nđiểm yếu và các lỗ hổng bảo mật. Đồng thời, chúng cũng cung cấp phần phân tích chi tiết\n\ntừng điểm yếu, lỗ hổng, kèm theo là hướng dẫn khắc phục, sửa chữa. Các công cụ được\n\nsử dụng rộng rãi là Microsoft Baseline Security Analyzer (Hình 2.3) cho rà quét các hệ\n\nthống chạy hệ điều hành Microsoft Windows và Nessus Vulnerability Scanner cho rà\n\nquét các hệ thống chạy nhiều loại hệ điều hành khác nhau.\n\n## Hình 2.3. Báo cáo kết quả quét của Microsoft Baseline Security Analyzer\n\n2.2.1.2. Công cụ rà quét lỗ hổng ứng dụng web\n\nCác công cụ rà quét lỗ hổng ứng dụng web cho phép rà quét, phân tích các trang web,\n\ntìm các lỗi và lỗ hổng bảo mật. Chúng cũng hỗ trợ phân tích tình trạng các lỗi tìm được,\n\nnhư các lỗi XSS, lỗi chèn mã SQL, lỗi CSRF, lỗi bảo mật phiên,… Các công cụ được sử\n\ndụng phổ biến bao gồm Acunetix Web Vulnerability Scanner (Hình 2.4), IBM AppScan,\n\n## Beyond Security AVDS và SQLmap.\n\n---\n\n27\n\n## Hình 2.4. Kết quả quét website sử dụng Acunetix Web Vulnerability Scanner\n\n2.2.2. Công cụ quét cổng dịch vụ\n\nCác công cụ quét cổng dịch vụ (Port scanner) cho phép quét các cổng, tìm các cổng\n\nđang mở, đang hoạt động, đồng thời tìm các thông tin về ứng dụng, dịch vụ và hệ điều\n\nhành đang hoạt động trên hệ thống. Dựa trên thông tin quét cổng dịch vụ, có thể xác định\n\nđược dịch vụ, ứng dụng nào đang chạy trên hệ thống:\n\n- Cổng 80/443 mở có nghĩa là dịch vụ web đang hoạt động;\n\n- Cổng 25 mở có nghĩa là dịch vụ gửi/nhận email SMTP đang hoạt động;\n\n- Cổng 1433 mở có nghĩa là máy chủ Microsoft SQL Server đang hoạt động;\n\n- Cổng 53 mở có nghĩa là dịch vụ tên miền DNS đang hoạt động,...\n\nCác công cụ quét cổng dịch vụ được sử dụng phổ biến bao gồm: Nmap, Zenmap,\n\n## Portsweep, Advanced Port Scanner, Angry IP Scanner, SuperScan và NetScanTools.\n\nHình 2.5 là giao diện của công cụ quét cổng dịch vụ Nmap/ Zenmap – một trong các\n\ncông cụ quét cổng dịch vụ được sử dụng rộng rãi. Nmap cung cấp tập lệnh rà quét rất\n\nmạnh. Tuy nhiên, Nmap tương đối khó dùng do chỉ hỗ trợ giao diện dòng lệnh.\n\n2.2.3. Công cụ nghe lén\n\nCông cụ nghe lén (Sniffer) cho phép bắt các gói tin khi chúng được truyền trên mạng.\n\nCông cụ nghe lén có thể là mô đun phần cứng, phần mềm hoặc kết hợp. Các thông tin\n\nnhạy cảm như thông tin tài khoản, thẻ tín dụng, hoặc mật khẩu nếu không được mã hóa\n\nthì có thể bị kẻ tấn công nghe lén khi được truyền từ máy trạm đến máy chủ và bị lạm\n\ndụng. Một số công cụ phần mềm cho phép bắt gói tin truyền trên mạng:\n\n- Tcpdump\n\n- Wireshark (minh họa trên Hình 2.6)\n\n- Pcap / Wincap / Libcap (Packet capture)\n\n- IP Tools (http://www.softpedia.com).\n\n---\n\n28\n\n## Hình 2.5. Giao diện của công cụ Zenmap\n\n## Hình 2.6. Sử dụng Wireshark để bắt gói tin có chứa thông tin nhạy cảm\n\n2.2.4. Công cụ ghi phím gõ\n\nCông cụ ghi phím gõ (Keylogger) là một dạng công cụ giám sát bằng phần cứng hoặc\n\nphần mềm có khả năng ghi lại mọi phím người dùng gõ và lưu vào một file. File đã ghi\n\nsau đó có thể được gửi cho kẻ tấn công theo địa chỉ chỉ định trước hoặc sao chép trực\n\ntiếp. Ngoài kẻ tấn công, người quản lý cũng có thể cài đặt Keylogger vào máy tính của\n\n---\n\n29\n\nnhân viên để theo dõi hoạt động của các nhân viên. Việc cài đặt Keylogger có thể được\n\nthực hiện tương đối đơn giản: Hình 2.7 minh họa một Keylogger dưới dạng một khớp nối\n\nphần cứng kết nối cổng bàn phím với đầu nối bàn phím, hỗ trợ cả giao diện cổng bàn\n\nphím PS/2 và USB. Với Keylogger phần mềm, kẻ tấn công có thể tích hợp Keylogger\n\nvào một phần mềm thông thường và lừa người dùng cài đặt vào máy tính của mình.\n\n## Hình 2.7. Mô đun Keylogger phần cứng và cài đặt trên máy tính để bàn\n\n2.3. Các dạng tấn công thường gặp\n\nCác dạng tấn công thường gặp là các dạng tấn công điển hình, xảy ra thường xuyên\n\nnhằm vào các hệ thống máy tính, hệ thống mạng và người dùng. Các dạng tấn công\n\nthường gặp bao gồm:\n\n- Tấn công vào mật khẩu\n\n- Tấn công bằng mã độc\n\n- Tấn công từ chối dịch vụ\n\n- Tấn công từ chối dịch vụ phân tán\n\n- Tấn công giả mạo địa chỉ\n\n- Tấn công nghe lén\n\n- Tấn công kiểu người đứng giữa\n\n- Tấn công bằng bom thư và thư rác\n\n- Tấn công sử dụng các kỹ thuật xã hội\n\n- Tấn công pharming\n\n- Tấn công APT.\n\nPhần tiếp theo của mục này trình bày chi tiết về các dạng tấn công thường gặp nêu\n\ntrên và các biện pháp phòng chống tương ứng.\n\n2.3.1. Tấn công vào mật khẩu\n\n2.3.1.1. Giới thiệu\n\n## Tấn công vào mật khẩu (Password attack) là dạng tấn công nhằm đánh cắp mật khẩu\n\nvà thông tin tài khoản của người dùng để lạm dụng. Tên người dùng và mật khẩu không\n\nđược mã hóa có thể bị đánh cắp trên đường truyền từ máy khách đến máy chủ, hoặc các\n\nthông tin này có thể bị đánh cắp thông qua các dạng tấn công XSS, hoặc lừa đảo, bẫy\n\nngười dùng cung cấp thông tin. Đây là một trong các dạng tấn công phổ biến nhất do hầu\n\n---\n\n30\n\nhết các ứng dụng sử cơ chế xác thực người dùng dựa trên tên người dùng, hoặc email và\n\nmật khẩu. Nếu kẻ tấn công có tên người dùng và mật khẩu thì hắn có thể đăng nhập vào\n\ntài khoản và thực hiện các thao tác như người dùng bình thường.\n\n2.3.1.2. Mô tả\n\n## Có thể chia tấn công vào mật khẩu thành 2 dạng:\n\n- Tấn công dựa trên từ điển (Dictionary attacks): Dạng tấn công này khai thác vấn đề\n\nngười dùng có xu hướng chọn mật khẩu là các từ đơn giản cho dễ nhớ. Kẻ tấn công\n\nthử các từ có tần suất sử dụng cao làm mật khẩu trong từ điển, nhờ vậy tăng khả\n\nnăng thành công.\n\n- Tấn công vét cạn (Brute force attacks): Dạng vét cạn sử dụng tổ hợp các ký tự và\n\nthử tự động. Phương pháp này thường được sử dụng với các mật khẩu đã được mã\n\nhóa. Kẻ tấn công sinh tổ hợp ký tự, sau đó mã hóa với cùng thuật toán mà hệ thống\n\nsử dụng, tiếp theo so sánh chuỗi mã hóa từ tổ hợp ký tự với chuỗi mật khẩu mã hóa\n\nthu thập được. Nếu hai bản mã trùng nhau thì tổ hợp ký tự là mật khẩu.\n\n2.3.1.3. Phòng chống\n\n## Để đảm bảo an toàn cho mật khẩu, cần thực hiện kết hợp các biện pháp sau:\n\n- Chọn mật khẩu đủ mạnh: Mật khẩu mạnh cho người dùng thông thường cần có độ\n\ndài lớn hơn hoặc bằng 8 ký tự, gồm tổ hợp của 4 loại ký tự: chữ cái hoa, chữ cái\n\nthường, chữ số và ký tự đặc biệt (?#$...). Mật khẩu cho người quản trị hệ thống cần\n\ncó độ dài lớn hơn hoặc bằng 10 ký tự cũng với các loại ký tự như mật khẩu cho\n\nngười dùng thông thường.\n\n- Định kỳ thay đổi mật khẩu. Thời hạn đổi mật khẩu tùy thuộc vào chính sách an\n\nninh của cơ quan, tổ chức, có thể là 3 tháng, hoặc 6 tháng.\n\n- Mật khẩu không nên lưu ở dạng rõ (plaintext). Nên lưu mật khẩu ở dạng đã mã hóa\n\nsử dụng hàm băm một chiều.\n\n- Hạn chế trao đổi tên người dùng và mật khẩu trên kênh truyền không được mã hóa.\n\n- Nên hạn chế số lần đăng nhập lỗi, chẳng hạn nếu người dùng cố gắng đăng nhập\n\nvới thông tin sai 3 lần liên tục sẽ bị khóa tài khoản trong một khoảng thời gian.\n\n2.3.2. Tấn công bằng mã độc\n\n2.3.2.1. Giới thiệu\n\nTấn công bằng mã độc (Malicious code attacks) là dạng tấn công sử dụng các mã độc\n\n(Malicious code) làm công cụ để tấn công hệ thống nạn nhân. Tấn công bằng mã độc có\n\nthể chia thành 2 loại:\n\n- Khai thác các lỗ hổng về lập trình, lỗ hổng cấu hình hệ thống để chèn và thực hiện\n\nmã độc trên hệ thống nạn nhân. Loại tấn công này lại gồm 2 dạng:\n\n+ Tấn công khai thác lỗi tràn bộ đệm (Buffer Overflow)\n\n+ Tấn công khai thác lỗi không kiểm tra đầu vào, gồm tấn công chèn mã SQL\n\n(SQL Injection) và tấn công sử dụng mã script, kiểu XSS, CSRF.\n\n- Lừa người sử dụng tải, cài đặt và thực hiện các phần mềm độc hại, như:\n\n---\n\n31\n\n+ Các phần mềm quảng cáo (Adware), gián điệp (Spyware)\n\n+ Vi rút\n\n+ Zombie/Bot\n\n+ Trojan\n\nDạng tấn công lừa người sử dụng tải, cài đặt và thực hiện các phần mềm độc hại sẽ\n\nđược đề cập ở Mục 2.4. Mục này chủ yếu đề cập về tấn công khai thác lỗi tràn bộ đệm,\n\ntấn công khai thác lỗi không kiểm tra đầu vào, trong đó tập trung phân tích dạng tấn công\n\nchèn mã SQL.\n\n2.3.2.2. Tấn công khai thác lỗi tràn bộ đệm\n\na. Giới thiệu và nguyên nhân\n\nLỗi tràn bộ đệm (Buffer overflow) là một trong các lỗi thường gặp trong các hệ điều\n\nhành và đặc biệt nhiều ở các phần mềm ứng dụng [6]. Lỗi tràn bộ đệm xảy ra khi một\n\nứng dụng cố gắng ghi dữ liệu vượt khỏi phạm vi của bộ nhớ đệm, là giới hạn cuối hoặc\n\ncả giới hạn đầu của bộ đệm. Lỗi tràn bộ đệm có thể khiến ứng dụng ngừng hoạt động,\n\ngây mất dữ liệu hoặc thậm chí giúp kẻ tấn công chèn, thực hiện mã độc để kiểm soát hệ\n\nthống. Lỗi tràn bộ đệm chiếm một tỷ lệ lớn trong số các lỗi gây lỗ hổng bảo mật [6]. Tuy\n\nnhiên, trên thực tế không phải tất cả các lỗi tràn bộ đệm đều có thể bị khai thác bởi kẻ tấn\n\ncông.\n\nLỗi tràn bộ đệm xuất hiện trong khâu lập trình phần mềm (coding) trong quy trình\n\nphát triển phần mềm. Nguyên nhân của lỗi tràn bộ đệm là người lập trình không kiểm tra,\n\nhoặc kiểm tra không đầy đủ các dữ liệu đầu vào nạp vào bộ nhớ đệm. Khi dữ liệu có kích\n\nthước quá lớn hoặc có định dạng sai được ghi vào bộ nhớ đệm, nó sẽ gây tràn và có thể\n\nghi đè lên các tham số thực hiện chương trình, có thể khiến chương trình bị lỗi và ngừng\n\nhoạt động. Một nguyên nhân bổ sung khác là việc sử dụng các ngôn ngữ với các thư viện\n\nkhông an toàn, như hợp ngữ, C và C++.\n\nb. Cơ chế gây tràn và khai thác\n\n* Cơ chế gây tràn\n\nTrên hầu hết các nền tảng, khi một ứng dụng được nạp vào bộ nhớ, hệ điều hành cấp\n\nphát các vùng nhớ để tải mã và lưu dữ liệu của chương trình. Hình 2.8 minh họa các vùng\n\nbộ nhớ cấp cho chương trình, bao gồm vùng lưu mã thực hiện (Executable code), vùng\n\nlưu dữ liệu toàn cục (Data), vùng bộ nhớ cấp phát động (Heap) và vùng bộ nhớ ngăn xếp\n\n(Stack). Vùng bộ nhớ ngăn xếp là vùng nhớ lưu các tham số gọi hàm, thủ tục, phương\n\nthức (gọi chung là hàm hay chương trình con) và dữ liệu cục bộ của chúng. Vùng nhớ cấp\n\nphát động là vùng nhớ chung lưu dữ liệu cho ứng dụng, được cấp phát hay giải phóng\n\ntrong quá trình hoạt động của ứng dụng.\n\nChúng ta sử dụng vùng bộ nhớ ngăn xếp để giải thích cơ chế gây tràn và khai thác lỗi\n\ntràn bộ đệm. Bộ nhớ ngăn xếp được cấp phát cho chương trình dùng để lưu các biến cục\n\nbộ của hàm, trong đó có các biến nhớ được gọi là bộ đệm, các tham số hình thức của\n\nhàm, các tham số quản lý ngăn xếp, và địa chỉ trở về (Return address). Địa chỉ trở về là\n\nđịa chỉ của lệnh nằm kế tiếp lời gọi hàm ở chương trình gọi được tự động lưu vào ngăn\n\n---\n\n32\n\nxếp khi hàm được gọi. Khi việc thực hiện hàm kết thúc, hệ thống nạp địa chỉ trở về đã\n\nlưu trong ngăn xếp vào con trỏ lệnh (còn gọi là bộ đếm chương trình) kích hoạt việc quay\n\ntrở lại thực hiện lệnh kế tiếp lời gọi hàm ở chương trình gọi.\n\n## Hình 2.8. Các vùng bộ nhớ cấp cho chương trình\n\n// định nghĩa một hàm\n\nvoid function(int a, int b, int c){\n\nchar buffer1[8];\n\nchar buffer2[12];\n\n}\n\n// chương trình chính\n\nint main(){\n\nfunction(1,2,3); // gọi hàm\n\n}\n\n## Hình 2.9. Một chương trình minh họa cấp phát bộ nhớ trong ngăn xếp\n\n## Hình 2.9 là một đoạn chương trình gồm một hàm con (function()) và một hàm chính\n\n(main()) minh họa cho việc gọi làm và cấp phát bộ nhớ trong vùng nhớ ngăn xếp. Hàm\n\nfunction() có 3 tham số hình thức kiểu nguyên và kê khai 2 biến cục bộ buffer1 và buffer2\n\nkiểu xâu ký tự. Hàm chính main() chỉ chứa lời gọi đến hàm function() với 3 tham số thực.\n\n## Hình 2.10 biểu diễn việc cấp pháp bộ nhớ cho các thành phần trong ngăn xếp: các\n\ntham số gọi hàm được lưu vào Function Parameters, địa chỉ trở về được lưu vào ô Return\n\nAddress, giá trị con trỏ khung ngăn xếp được lưu vào ô Save Frame Pointer và các biến\n\ncục bộ trong hàm được lưu vào Local Variables. Hình 2.11 minh họa chi tiết việc cấp\n\nphát bộ nhớ cho các biến trong ngăn xếp: ngoài ô địa chỉ trở về (ret) và con trỏ khung\n\n---\n\n33\n\n(sfp) được cấp cố định ở giữa, các tham số gọi hàm được cấp các ô nhớ bên phải (phía\n\nđáy ngăn xếp – bottom of stack) và các biến cục bộ được cấp các ô nhớ bên trái (phía\n\nđỉnh ngăn xếp – top  of stack).\n\n## Hình 2.10. Các thành phần được lưu trong vùng bộ nhớ trong ngăn xếp\n\n## Hình 2.11. Cấp phát bộ nhớ cho các biến nhớ trong vùng bộ nhớ trong ngăn xếp\n\n// định nghĩa một hàm\n\nvoid function(char *str){\n\nchar buffer[16];\n\nstrcpy(buffer, str);\n\n}\n\n// chương trình chính\n\nint main(){\n\nchar large_string[256];\n\nint i;\n\nfor (i = 0; i < 255; i++){\n\nlarge_string[i] = ‘A’;\n\n}\n\nfunction(large_string);\n\n}\n\n## Hình 2.12. Một chương trình minh họa gây tràn bộ nhớ đệm trong ngăn xếp\n\n## Hình 2.12 là một đoạn chương trình minh họa gây tràn bộ nhớ đệm trong ngăn xếp.\n\n## Đoạn chương trình này gồm hàm con function() và hàm chính main(), trong đó hàm\n\nfunction() nhận một con trỏ xâu ký tự str làm đầu vào. Hàm này khai báo 1 biến buffer\n\n---\n\n34\n\nkiểu xâu ký tự với độ dài 16 byte. Hàm này sử dụng hàm thư viện strcpy() để sao chép\n\nxâu ký tự từ con trỏ str sang biến cục bộ buffer. Hàm chính main() kê khai một xâu ký tự\n\nlarge_string với độ dài 256 byte và sử dụng một vòng lặp để điền đầy xâu large_string\n\nbằng ký tự ‘A’. Sau đó main() gọi hàm function() với tham số đầu vào là large_string.\n\nCó thể thấy đoạn chương trình biểu diễn trên Hình 2.12 khi được thực hiện sẽ gây tràn\n\ntrong biến nhớ buffer của hàm function() do tham số truyền vào large_string có kích\n\nthước 256 byte lớn hơn nhiều so với buffer có kích thước 16 byte và hàm strcpy() không\n\nhề thực hiện việc kiểm tra kích thước dữ liệu vào khi sao chép vào biến buffer. Như minh\n\nhọa trên Hình 2.13, chỉ 16 byte đầu tiên của large_string được lưu vào buffer, phần còn\n\nlại được ghi đè lên các ô nhớ khác trong ngăn xếp, bao gồm sfp, ret và cả con trỏ xâu đầu\n\nvào str. Ô nhớ chưa địa chỉ trở về ret bị ghi đè và giá trị địa chỉ trở về mới là ‘AAAA’\n\n(0x41414141). Khi kết thúc thực hiện hàm con function(), chương trình tiếp tục thực hiện\n\nlệnh tại địa chỉ 0x41414141. Đây không phải là địa chỉ của lệnh chương trình phải thực\n\nhiện theo lôgic đã định ra từ trước.\n\n## Hình 2.13. Minh họa hiện tượng tràn bộ nhớ đệm trong ngăn xếp\n\nNhư vậy, lỗi tràn bộ đệm xảy ra khi dữ liệu nạp vào biến nhớ (gọi chung là bộ đệm)\n\ncó kích thước lớn hơn so với khả năng lưu trữ của bộ đệm và chương trình thiếu các bước\n\nkiểm tra kích thước và định dạng dữ liệu nạp vào. Phần dữ liệu tràn sẽ được ghi đè lên\n\ncác ô nhớ liền kề trong ngăn xếp, như các biến cục bộ khác, con trỏ khung, địa chỉ trở về,\n\ncác biến tham số đầu vào,....\n\n* Khai thác lỗi tràn bộ đệm\n\nKhi một ứng dụng chứa lỗ hổng tràn bộ đệm, tin tặc có thể khai thác bằng cách gửi\n\nmã độc dưới dạng dữ liệu đến ứng dụng nhằm ghi đè, thay thế địa chỉ trở về với mục đích\n\ntái định hướng chương trình đến thực hiện đoạn mã độc mà tin tặc gửi đến. Đoạn mã độc\n\ntin tặc xây dựng là mã máy có thể thực hiện được và thường được gọi là shellcode. Như\n\nvậy, để có thể khai thác lỗi tràn bộ đệm, tin tặc thường phải thực hiện việc gỡ rối (debug)\n\nchương trình (hoặc có thông tin từ nguồn khác) và nắm chắc cơ chế gây lỗi và phương\n\npháp quản lý, cấp phát vùng nhớ ngăn xếp của ứng dụng.\n\nMã shellcode có thể được viết bằng hợp ngữ, C, hoặc các ngôn ngữ lập trình khác, sau\n\nđó được chuyển thành mã máy, rồi chuyển định dạng thành một chuỗi dữ liệu và cuối\n\ncùng được gửi đến ứng dụng. Hình 2.14 minh họa một đoạn mã shellcode viết bằng hợp\n\nngữ và được chuyển đổi thành một chuỗi dưới dạng hexa làm dữ liệu đầu vào gây tràn bộ\n\nđệm và gọi thực hiện shell sh trong các hệ thống Linux hoặc Unix thông qua lệnh /bin/sh.\n\n---\n\n35\n\nHình 2.15. minh họa việc chèn shellcode, ghi đè lên ô nhớ chứa địa chỉ trở về ret, tái định\n\nhướng việc trở về từ chương trình con, chuyển đến thực hiện mã shellcode được chèn\n\nvào. Trên thực tế, để tăng khả năng đoạn mã shellcode được thực hiện, người ta thường\n\nchèn một số lệnh NOP (N) vào phần đầu shellcode để phòng khả năng địa chỉ ret mới\n\nkhông trỏ chính xác đến địa chỉ bắt đầu shellcode, như minh họa trên Hình 2.16. Lệnh\n\nNOP (No OPeration) là lệnh không thực hiện tác vụ nào cả, chỉ tiêu tốn một số chu kỳ\n\ncủa bộ vi xử lý.\n\n## Hình 2.14. Một shellcode viết bằng hợp ngữ và chuyển thành chuỗi tấn công\n\n## Hình 2.15. Chèn và thực hiện shellcode khai thác lỗi tràn bộ đệm\n\n## Hình 2.16. Chèn shellcode với phần đệm bằng lệnh NOP (N)\n\n* Ví dụ về khai thác lỗi tràn bộ đệm\n\n## Sâu SQL Slammer (một số tài liệu gọi là sâu Sapphire) được phát hiện ngày\n\n25/1/2003 lúc 5h30 (UTC) là sâu có tốc độ lây lan nhanh nhất lúc bấy giờ: nó lây nhiễm\n\n---\n\n36\n\nra khoảng 75.000 máy chủ chỉ trong khoảng 30 phút, như minh họa trên Hình 2.17. Sâu\n\nSlammer khai thác lỗi tràn bộ đệm trong thành phần Microsoft SQL Server Resolution\n\n## Service của hệ quản trị cơ sở dữ liệu Microsoft SQL Server 2000.\n\n## Hình 2.17. Bản đồ lây nhiễm sâu Slammer (mầu xanh) theo trang www.caida.org vào\n\nngày 25/1/2003 lúc 6h00 (giờ UTC) với 74.855 máy chủ bị nhiễm\n\nSâu sử dụng giao thức UDP với kích thước gói tin 376 byte và vòng lặp chính của sâu\n\nchỉ gồm 22 lệnh hợp ngữ. Chu trình hoạt động của sâu SQL Slammer gồm:\n\n- Sinh tự động địa chỉ IP;\n\n- Quét tìm các máy có lỗi với IP tự sinh trên cổng dịch vụ 1434;\n\n- Nếu tìm được, gửi một bản sao của sâu đến máy có lỗi;\n\n- Mã của sâu gây tràn bộ đệm, thực thi mã của sâu và quá trình lặp lại.\n\nSQL Slammer là sâu “lành tính” vì nó không can thiệp vào hệ thống file, không thực\n\nhiện việc phá hoại hay đánh cắp thông tin ở hệ thống bị lây nhiễm. Tuy nhiên, sâu tạo ra\n\nlưu lượng mạng khổng lồ trong quá trình lây nhiễm, gây tê liệt đường truyền mạng\n\nInternet trên nhiều vùng của thế giới. Do mã của SQL Slammer chỉ được lưu trong bộ\n\nnhớ nó gây tràn mà không được lưu vào hệ thống file, nên chỉ cần khởi động lại máy là\n\ncó thể tạm thời xóa được sâu khỏi hệ thống. Tuy nhiên, hệ thống chứa lỗ hổng có thể bị\n\nlây nhiễm lại nếu nó ở gần một máy khác bị nhiễm sâu. Các biện pháp phòng chống triệt\n\nđể khác là cập nhật bản vá cho bộ phần mềm Microsoft SQL Server 2000. Thông tin chi\n\ntiết\n\nvề\n\nsâu\n\n# SQL\n\n## Slammer\n\ncó\n\nthể\n\ntìm\n\nở\n\ncác\n\ntrang:\n\nhttps://technet.microsoft.com/library/security/ms02-039,\n\nhoặc\n\nhttps://www.caida.org/publications/papers/2003/sapphire/sapphire.html.\n\nc. Phòng chống\n\nĐể phòng chống lỗi tràn bộ đệm một cách hiệu quả, cần kết hợp nhiều biện pháp. Các\n\nbiện pháp có thể thực hiện bao gồm:\n\n- Kiểm tra thủ công mã nguồn hay sử dụng các công cụ phân tích mã tự động để tìm\n\nvà khắc phục các điểm có khả năng xảy ra lỗi tràn bộ đệm, đặc biệt lưu ý đến các\n\nhàm xử lý xâu ký tự.\n\n---\n\n37\n\n- Sử dụng cơ chế không cho phép thực hiện mã trong dữ liệu DEP (Data Excution\n\n## Prevention). Cơ chế DEP được hỗ trợ bởi hầu hết các hệ điều hành (từ Windows\n\n## XP và các hệ điều hành họ Linux, Unix,…) không cho phép thực hiện mã chương\n\ntrình chứa trong vùng nhớ dành cho dữ liệu. Như vậy, nếu kẻ tấn công khai thác lỗi\n\ntràn bộ đệm, chèn được mã độc vào bộ đệm trong ngăn xếp, mã độc cũng không\n\nthể thực hiện.\n\n- Ngẫu nhiên hóa sơ đồ địa chỉ cấp phát các ô nhớ trong ngăn xếp khi thực hiện\n\nchương trình, nhằm gây khó khăn cho việc gỡ rối và phát hiện vị trí các ô nhớ quan\n\ntrọng như ô nhớ chứa địa chỉ trở về.\n\n- Sử dụng các cơ chế bảo vệ ngăn xếp, theo đó thêm một số ngẫu nhiên (canary)\n\nphía trước địa chỉ trở về và kiểm tra số ngẫu nhiên này trước khi trở về chương\n\ntrình gọi để xác định khả năng bị thay đổi địa chỉ trở về.\n\n- Sử dụng các ngôn ngữ, thư viện và công cụ lập trình an toàn. Trong các trường hợp\n\ncó thể, sử dụng các ngôn ngữ không gây tràn, như Java, các ngôn ngữ lập trình trên\n\nMicrosoft .Net. Với các ngôn ngữ có thể gây tràn như C, C++, nên sử dụng các thư\n\nviện an toàn (Safe C/C++ Libraries) để thay thế các thư viện chuẩn có thể gây tràn.\n\n2.3.2.3. Tấn công khai thác lỗi không kiểm tra đầu vào\n\na. Giới thiệu\n\nLỗi không kiểm tra đầu vào (Unvalidated input) là một trong các dạng lỗ hổng bảo\n\nmật phổ biến, trong đó ứng dụng không kiểm tra, hoặc kiểm tra không đầy đủ các dữ liệu\n\nđầu vào, nhờ đó tin tặc có thể khai thác lỗi để tấn công ứng dụng và hệ thống. Dữ liệu\n\nđầu vào (Input data) cho ứng dụng rất đa dạng, có thể đến từ nhiều nguồn với nhiều định\n\ndạng khác nhau. Các dạng dữ liệu đầu vào điển hình cho ứng dụng:\n\n- Các trường dữ liệu văn bản (text);\n\n- Các lệnh được truyền qua địa chỉ URL để kích hoạt chương trình;\n\n- Các file âm thanh, hình ảnh, hoặc đồ họa do người dùng, hoặc các tiến trình khác\n\ncung cấp;\n\n- Các đối số đầu vào trong dòng lệnh;\n\n- Các dữ liệu từ mạng hoặc từ các nguồn không tin cậy.\n\nTrên thực tế, tin tặc có thể sử dụng phương pháp thủ công, hoặc tự động để kiểm tra\n\ncác dữ liệu đầu vào và thử tất cả các khả năng có thể để khai thác lỗi không kiểm tra đầu\n\nvào. Theo thống kê của trang web OWASP (http://www.owasp.org), một trang web\n\nchuyên về thông kê các lỗi bảo mật ứng dụng web, lỗi không kiểm tra đầu vào luôn\n\nchiếm vị trí nhóm dẫn đầu các lỗi bảo mật các trang web trong khoảng 5 năm trở lại đây.\n\nb. Tấn công khai thác\n\nCó hai dạng chính tấn công khai thác lỗi không kiểm tra đầu vào: (1) cung cấp dữ liệu\n\nquá lớn hoặc sai định dạng để gây lỗi cho ứng dụng, và (2) chèn mã khai thác vào dữ liệu\n\nđầu vào để thực hiện trên hệ thống của nạn nhân, nhằm đánh cắp dữ liệu nhạy cảm hoặc\n\nthực hiện các hành vi phá hoại. Hình 2.18 minh họa tấn công khai thác lỗi không kiểm tra\n\nđầu vào dạng (1) thông qua việc nhập dữ liệu quá lớn, gây lỗi thực hiện cho trang web.\n\n---\n\n38\n\n## Hình 2.18. Cung cấp dữ liệu quá lớn để gây lỗi cho ứng dụng\n\nChúng ta minh họa tấn công khai thác lỗi không kiểm tra đầu vào dạng (2) bằng việc\n\nchèn mã tấn công SQL vào dữ liệu đầu vào, được thực hiện trên hệ quản trị cơ sở dữ liệu\n\nnhằm đánh cắp, hoặc phá hủy dữ liệu trong cơ sở dữ liệu. Giả thiết một trang web tìm\n\nkiếm sản phẩm sử dụng câu lệnh SQL sau để tìm kiếm các sản phẩm:\n\n\"SELECT * FROM tbl_products WHERE product_name like '%\" + keyword + \"%'\"\n\ntrong đó tbl_products là bảng lưu thông tin các sản phẩm, product_name là trường tên\n\nsản phẩm và keyword là từ khóa cung cấp từ người dùng form tìm kiếm. Nếu người dùng\n\nnhập từ khóa là \"iPhone 7\", khi đó câu lệnh SQL trở thành:\n\n\"SELECT * FROM tbl_products WHERE product_name like '%iPhone X%'\"\n\nNếu trong bảng có sản phẩm thỏa mãn điều kiện tìm kiếm, câu lệnh SQL sẽ trả về tập\n\nbản ghi. Nếu không có sản phẩm nào thỏa mãn điều kiện tìm kiếm, câu lệnh SQL sẽ trả\n\nvề tập bản ghi rỗng. Nếu người dùng nhập từ khóa \"iPhone X';DELETE FROM\n\ntbl_products;--\", khi đó câu lệnh SQL trở thành:\n\n\"SELECT * FROM tbl_products WHERE product_name like '%iPhone X';DELETE\n\n## FROM tbl_products;--%'\"\n\nNhư vậy, câu lệnh SQL được thực hiện trên cơ sở dữ liệu gồm 2 câu lệnh: câu lệnh\n\nchọn SELECT ban đầu và câu lệnh xóa DELETE do tin tặc chèn thêm. Câu lệnh\n\n“DELETE FROM tbl_products” sẽ xóa tất cả các bản ghi trong bảng tbl_products. Sở dĩ\n\ntin tặc có thể thực hiện điều này là do hầu hết các hệ quản trị cơ sở dữ liệu cho phép thực\n\nhiện nhiều câu lệnh SQL theo mẻ (batch), trong đó các câu lệnh được ngăn cách bởi dấu\n\n(;). Ngoài ra, dấu “--” ở cuối dữ liệu nhập để loại bỏ hiệu lực của phần lệnh còn lại do “--\n\n” là ký hiệu bắt đầu phần chú thích của dòng lệnh. Ngoài DELETE, tin tặc có thể chèn\n\nthêm các lệnh SQL khác, như INSERT, UPDATE để thực hiện việc chèn thêm bản ghi\n\nhoặc sửa đổi dữ liệu theo ý đồ tấn công của mình.\n\n---\n\n39\n\nc. Phòng chống\n\nBiện pháp chủ yếu phòng chống tấn công khai thác lỗi không kiểm tra đầu vào là lọc\n\ndữ liệu đầu vào. Tất cả các dữ liệu đầu vào, đặc biệt dữ liệu nhập từ người dùng và từ các\n\nnguồn không tin cậy cần được kiểm tra kỹ lưỡng. Các biện pháp cụ thể bao gồm:\n\n- Kiểm tra kích thước và định dạng dữ liệu đầu vào;\n\n- Kiểm tra sự hợp lý của nội dung dữ liệu;\n\n- Tạo các bộ lọc để lọc bỏ các ký tự đặc biệt và các từ khóa của các ngôn ngữ trong\n\ncác trường hợp cần thiết mà kẻ tấn công có thể sử dụng:\n\n+ Các ký tự đặc biệt: *, ', =, --\n\n+ Các từ khóa ngôn ngữ:  chẳng hạn với dạng tấn công chèn mã SQL, cần lọc các\n\ntừ khóa như SELECT, INSERT, UPDATE, DELETE, DROP....\n\n2.3.2.4. Tấn công chèn mã SQL\n\na. Khái quát\n\n## Tấn công chèn mã SQL (SQL Injection) là một kỹ thuật cho phép kẻ tấn công chèn\n\nmã SQL vào dữ liệu gửi đến máy chủ và cuối cùng được thực hiện trên máy chủ cơ sở dữ\n\nliệu. Tùy vào mức độ tinh vi, tấn công chèn mã SQL có thể cho phép kẻ tấn công (1)\n\nvượt qua các khâu xác thực người dùng, (2) chèn, sửa đổi, hoặc xóa dữ liệu, (3) đánh cắp\n\ncác thông tin trong cơ sở dữ liệu và (4) chiếm quyền điều khiển hệ thống máy chủ cơ sở\n\ndữ liệu. Tấn công chèn mã SQL là dạng tấn công thường gặp ở các ứng dụng web, các\n\ntrang web có kết nối đến cơ sở dữ liệu.\n\n## Có 2 nguyên nhân của lỗ hổng trong ứng dụng nói chung và ứng dụng web nói riêng\n\ncho phép thực hiện tấn công chèn mã SQL:\n\n- Dữ liệu đầu vào từ người dùng hoặc từ các nguồn khác không được kiểm tra hoặc\n\nkiểm tra không kỹ lưỡng;\n\n- Sử dụng các câu lệnh SQL động trong ứng dụng, trong đó có thao tác nối dữ liệu\n\nngười dùng với mã lệnh SQL gốc.\n\nPhần tiếp theo mục này là mô tả chi tiết về 4 hành động kẻ tấn công có thể thực hiện\n\ntrên hệ thống nạn nhân thông qua khai thác lỗi chèn mã SQL.\n\nb. Vượt qua các khâu xác thực người dùng\n\n## Xem xét một form đăng nhập (Log in) và đoạn mã xử lý xác thực người dùng lưu\n\ntrong bảng cơ sở dữ liệu tbl_accounts(username, password) cho như trên Hình 2.19.\n\n## Nếu người dùng nhập 'admin' vào trường username và 'abc123' vào trường password\n\ncủa form, mã xử lý hoạt động đúng: Nếu tồn tại người dùng với username và password\n\nkể trên, hệ thống sẽ cho phép đăng nhập với thông báo đăng nhập thành công; Nếu không\n\ntồn tại người dùng với username và password đã cung cấp, hệ thống sẽ từ chối đăng nhập\n\nvà trả lại thông báo lỗi. Tuy nhiên, nếu người dùng nhập aaaa' OR 1=1-- vào trường\n\nusername và một chuỗi bất kỳ, chẳng hạn 'aaaa' vào trường password của form, mã xử lý\n\nhoạt động sai và chuỗi chứa câu truy vấn SQL trở thành:\n\n---\n\n40\n\n## SELECT * FROM tbl_accounts WHERE username='aaaa' OR 1=1--' AND\n\npassword='aaaa'\n\n<!— Form đăng nhập -->\n\n<form method=\"post\" action=\"/log_in.asp\">\n\n## Tên đăng nhập: <input type=text name=\"username\"><br \\>\n\n## Mật khẩu: <input type=password name=\"password\"><br \\>\n\n<input type=submit name=\"login\" value=\"Log In\">\n\n</form>\n\n<%\n\n' Mã ASP xử lý đăng nhập trong file log_in.asp:\n\n' giả thiết đã kết nối với CSDL SQL qua đối tượng conn và\n\nbảng tbl_accounts lưu thông tin người dùng\n\n## Dim username, password, sqlString, rsLogin\n\n' lấy dữ liệu từ form\n\nusername = Request.Form(\"username\")\n\npassword = Request.Form(\"password\")\n\n' tạo và thực hiện câu truy vấn sql\n\nsqlString = \"SELECT * FROM tbl_accounts WHERE username='\"\n\n& username & \"' AND password = '\" & password & \"'\"\n\nset rsLogin = conn.execute(sqlString)\n\nif (NOT rsLogin.eof()) then\n\n' cho phép đăng nhập, bắt đầu phiên làm việc\n\nelse\n\n' từ chối đăng nhập, báo lỗi\n\nend if\n\n%>\n\n## Hình 2.19. Form đăng nhập (log on) và đoạn mã xử lý xác thực người dùng\n\n## Câu truy vấn sẽ trả về mọi bản ghi trong bảng do thành phần OR 1=1 làm cho điều\n\nkiện trong mệnh đề WHERE trở lên luôn đúng và phần kiểm tra mật khẩu đã bị loại bỏ\n\nbởi ký hiệu (--). Phần lệnh sau ký hiệu (--) được coi là ghi chú và không được thực hiện.\n\nNếu trong bảng tbl_accounts có chứa ít nhất một bản ghi, kẻ tấn công sẽ luôn đăng nhập\n\nthành công vào hệ thống.\n\nc. Chèn, sửa đổi, hoặc xóa dữ liệu\n\n## Xem xét một form tìm kiếm sản phẩm và đoạn mã xử lý tìm sản phẩm lưu trong bảng\n\ncơ sở dữ liệu tbl_products(product_id, product_name, product_desc, product_cost) cho\n\nnhư trên Hình 2.20.\n\n<!— Form tìm kiếm sản phẩm -->\n\n<form method=\"post\" action=\"/search.asp\">\n\n---\n\n41\n\n## Nhập tên sản phẩm: <input type=text name=\"keyword\">\n\n<input type=submit name=\"search\" value=\"Search\">\n\n</form>\n\n<%\n\n' Mã ASP xử lý tìm sản phẩm trong file search.asp:\n\n' giả thiết đã kết nối với CSDL SQL server qua connection\n\n' conn và bảng tbl_products lưu thông tin sản phẩm\n\n## Dim keyword, sqlString, rsSearch\n\n' lấy dữ liệu từ form\n\nkeyword = Request.Form(\"keyword\")\n\n' tạo và thực hiện câu truy vấn SQL\n\nsqlString = \"SELECT * FROM tbl_products WHERE\n\nproduct_name like '%\" & keyword & \"%'\"\n\nset rsSearch = conn.execute(sqlString)\n\nif (NOT rsSearch.eof()) then\n\n' hiển thị danh sách các sản phẩm\n\nelse\n\n' thông báo không tìm thấy sản phẩm\n\nend if\n\n%>\n\n## Hình 2.20. Form tìm kiếm sản phẩm và đoạn mã xử lý tìm sản phẩm\n\n## Nếu người dùng nhập chuỗi \"Samsung Galaxy S8\" vào trường keyword của form, mã\n\nxử lý hoạt động đúng: Nếu tìm thấy các sản phẩm có tên chứa từ khóa, hệ thống sẽ hiển\n\nthị danh sách các sản phẩm tìm thấy; Nếu không tìm thấy sản phẩm nào có tên chứa từ\n\nkhóa, hệ thống thông báo không tìm thấy sản phẩm. Tuy nhiên, nếu người dùng nhập\n\nchuỗi \"Samsung Galaxy S8';DELETE FROM tbl_products;--\" vào trường keyword của\n\nform, mã xử lý sẽ hoạt động sai và chuỗi chứa câu truy vấn SQL trở thành:\n\n## SELECT * FROM tbl_products WHERE keyword like '%Samsung Galaxy\n\n## S8';DELETE FROM tbl_products;--%'\n\n## Chuỗi lệnh SQL mới gồm 2 lệnh SQL: câu lệnh SELECT tìm kiếm các sản phẩm có\n\ntên chứa từ khóa \"Samsung Galaxy S8\" trong bảng tbl_products và câu lệnh DELETE\n\nxóa tất cả các sản phẩm trong bảng tbl_products. Sở dĩ kẻ tấn công có thể làm được điều\n\nnày là do hệ quản trị cơ sở dữ liệu MS-SQL server nói riêng và hầu hết các hệ quản trị cơ\n\nsở dữ liệu nói chung cho phép thực hiện nhiều lệnh SQL theo lô và dùng dấu ; để ngăn\n\ncách các lệnh. Ký hiệu -- dùng để hủy tác dụng của phần lệnh còn lại nếu có.\n\n## Bằng thủ thuật tương tự, kẻ tấn công có thể thay lệnh DELETE bằng lệnh UPDATE\n\nhoặc INSERT để chỉnh sửa, hoặc chèn thêm dữ liệu. Chẳng hạn, kẻ tấn công chèn thêm\n\nlệnh UPDATE để cập nhật mật khẩu của người quản trị bằng cách nhập chuỗi sau làm từ\n\nkhóa tìm kiếm (giả thiết bảng tbl_administrators chứa thông tin người quản trị):\n\n---\n\n42\n\n## Galaxy S8';UPDATE tbl_administrators SET password=abc123 WHERE username =\n\n'admin';--\n\n## Hoặc kẻ tấn công có thể chèn thêm bản ghi vào bảng tbl_administrators bằng cách\n\nnhập chuỗi sau làm từ khóa tìm kiếm:\n\n## Galaxy S8';INSERT INTO tbl_administrators (username, password) VALUES\n\n('attacker', 'abc12345');--\n\nd. Đánh cắp các thông tin trong cơ sở dữ liệu\n\nLỗ hổng chèn mã SQL có thể giúp kẻ tấn công đánh cắp dữ liệu trong cơ sở dữ liệu\n\nthông qua một số bước như sau:\n\n- Tìm lỗ hổng chèn mã SQL và thăm dò các thông tin về hệ quản trị cơ sở dữ liệu:\n\n+ Nhập một số dữ liệu mẫu để kiểm tra một trang web có chứa lỗ hổng chèn mã\n\n## SQL, như các dấu nháy đơn, dấu --,…\n\n+ Tìm phiên bản máy chủ cơ sở dữ liệu: nhập các câu lệnh lỗi và kiểm tra thông\n\nbáo lỗi, hoặc sử dụng @@version (với MS-SQL Server), hoặc version() (với\n\n## MySQL) trong câu lệnh ghép với UNION SELECT.\n\n- Tìm thông tin về số lượng và kiểu dữ liệu các trường của câu truy vấn hiện tại của\n\ntrang web.\n\n+ Sử dụng mệnh đề ORDER BY <số thứ tự của trường>\n\n+ Sử dụng UNION SELECT 1, 2, 3, …\n\n- Trích xuất thông tin về các bảng, các trường của cơ sở dữ liệu thông qua các bảng\n\nhệ thống (metadata).\n\n- Sử dụng lệnh UNION SELECT để ghép các thông tin định trích xuất vào câu truy\n\nvấn hiện tại của ứng dụng.\n\ne. Chiếm quyền điều khiển hệ thống máy chủ cơ sở dữ liệu\n\nKhả năng máy chủ cơ sở dữ liệu bị chiếm quyền điều khiển xảy ra khi trang web tồn\n\ntại đồng thời 2 lỗ hổng: (1) lỗ hổng cho phép tấn công chèn mã SQL và (2) lỗ hổng thiết\n\nlập quyền truy nhập cơ sở dữ liệu – sử dụng người dùng có quyền quản trị để truy nhập\n\nvà thao tác dữ liệu của website. Khai thác 2 lỗ hổng này, kẻ tấn công có thể gọi thực hiện\n\ncác lệnh hệ thống của máy chủ cơ sở dữ liệu cho phép can thiệp sâu vào cơ sở dữ liệu, hệ\n\nquản trị cơ sở dữ liệu và cả hệ điều hành trên máy chủ. Chẳng hạn, hệ quản trị cơ sở dữ\n\nliệu MS-SQL Server cung cấp thủ tục sp_send_dbmail cho phép gửi email từ máy chủ cơ\n\nsở dữ liệu và thủ tục xp_cmdshell cho phép chạy các lệnh và chương trình cài đặt trên hệ\n\nđiều hành Microsoft Windows. Sau đây là một số ví dụ chạy các lệnh Microsoft\n\n## Windows thông qua thủ tục xp_cmdshell:\n\n## EXEC xp_cmdshell 'dir *.exe' : liệt kê nội dung thư mục hiện thời\n\n## EXEC xp_cmdshell 'shutdown /s /t 00' : tắt máy chủ nền chạy hệ quản trị CSDL\n\n## EXEC xp_cmdshell 'net stop W3SVC' : dừng hoạt động máy chủ web\n\n## EXEC xp_cmdshell 'net stop MSSQLSERVER' : dừng hoạt động máy chủ CSDL\n\n---\n\n43\n\nNgoài ra, kẻ tấn công có thể thực hiện các thao tác nguy hiểm đến cơ sở dữ liệu nếu\n\ncó quyền của người quản trị cơ sở dữ liệu hoặc quản trị hệ thống, như:\n\n## Xóa cả bảng (gồm cả cấu trúc): DROP TABLE <tên bảng>\n\n## Xóa cả cơ sở dữ liệu: DROP DATABASE <tên CSDL>\n\n## Tạo 1 tài khoản mới truy nhập CSDL: sp_addlogin <username> <password>\n\n## Đổi mật khẩu tài khoản truy nhập CSDL: sp_password  <password>\n\nf. Phòng chống\n\nDo tính chất nguy hiểm của tấn công chèn mã SQL, nhiều giải pháp đã được đề xuất\n\nnhằm hạn chế tác hại và ngăn chặn triệt để dạng tấn công này. Nhìn chung, cần áp dụng\n\nkết hợp các biện pháp phòng chống tấn công chèn mã SQL để đảm bảo an toàn cho hệ\n\nthống. Các biện pháp, kỹ thuật cụ thể có thể áp dụng gồm:\n\n- Các biện pháp phòng chống dựa trên kiểm tra và lọc dữ liệu đầu vào:\n\n+ Kiểm tra tất cả các dữ liệu đầu vào, đặc biệt dữ liệu nhập từ người dùng và từ\n\ncác nguồn không tin cậy;\n\n+ Kiểm tra kích thước và định dạng dữ liệu đầu vào;\n\n+ Tạo các bộ lọc để lọc bỏ các ký tự đặc biệt (như *, ‘, =, --) và các từ khóa của\n\nngôn ngữ SQL (SELECT, INSERT, UPDATE, DELETE, DROP,....) mà kẻ tấn\n\ncông có thể sử dụng:\n\n- Sử dụng thủ tục cơ sở dữ liệu (stored procedures) và cơ chế tham số hóa dữ liệu:\n\n+ Đưa tất cả các câu truy vấn (SELECT) và cập nhật, sửa, xóa dữ liệu (INSERT,\n\n## UPDATE, DELETE) vào các thủ tục. Dữ liệu truyền vào thủ tục thông qua các\n\ntham số, giúp tách dữ liệu khỏi mã lệnh SQL, nhờ đó hạn ngăn chặn hiệu quả\n\ntấn công chèn mã SQL;\n\n+ Hạn chế thực hiện các câu lệnh SQL động trong thủ tục;\n\n+ Sử dụng cơ chế tham số hóa dữ liệu hỗ trợ bởi nhiều ngôn ngữ lập trình web\n\nnhư ASP.NET, PHP và JSP.\n\n- Các biện pháp phòng chống dựa trên thiết lập quyền truy nhập người dùng cơ sở\n\ndữ liệu:\n\n+ Không sử dụng người dùng có quyền quản trị hệ thống hoặc quản trị cơ sở dữ\n\nliệu làm người dùng truy nhập dữ liệu. Ví dụ: không dùng người dùng sa\n\n(Microsoft SQL) hoặc root (MySQL) làm người dùng truy nhập dữ liệu. Chỉ\n\ndùng các người dùng này cho mục đích quản trị.\n\n+ Chia nhóm người dùng, chỉ cấp quyền vừa đủ để truy nhập các bảng biểu, thực\n\nhiện câu truy vấn và chạy các thủ tục.\n\n+ Tốt nhất, không cấp quyền thực hiện các câu truy vấn, cập nhật, sửa, xóa trực\n\ntiếp trên các bảng dữ liệu. Thủ tục hóa tất cả các câu lệnh và chỉ cấp quyền thực\n\nhiện thủ tục.\n\n---\n\n44\n\n+ Cấm hoặc vô hiệu hóa (disable) việc thực hiện các thủ tục hệ thống (các thủ tục\n\ncơ sở dữ liệu có sẵn) cho phép can thiệp vào hệ quản trị cơ sở dữ liệu và hệ điều\n\nhành nền.\n\n- Sử dụng các công cụ rà quét lỗ hổng chèn mã SQL, như SQLMap, hoặc Acunetix\n\n## Vulnerability Scanner để chủ động rà quét, tìm các lỗ hổng chèn mã SQL và có\n\nbiện pháp khắc phục phù hợp.\n\n2.3.3. Tấn công từ chối dịch vụ\n\n2.3.3.1. Giới thiệu\n\nTấn công từ chối dịch vụ (Denial of Service - DoS) là dạng tấn công nhằm ngăn chặn\n\nngười dùng hợp pháp truy nhập các tài nguyên mạng. Tấn công DoS có thể được chia\n\nthành 2 loại: (1) tấn công logic (Logic attacks) và (2) tấn công gây ngập lụt (Flooding\n\nattacks). Tấn công logic là dạng tấn công khai thác các lỗi phần mềm làm dịch vụ ngừng\n\nhoạt động, hoặc làm giảm hiệu năng hệ thống. Tấn công DoS sử dụng sâu Slammer đề\n\ncập ở Mục 2.3.2.2 là dạng tấn công khai thác lỗi tràn bộ đệm trong phần mềm. Ngược lại,\n\ntrong tấn công gây ngập lụt, kẻ tấn công gửi một lượng lớn yêu cầu gây cạn kiệt tài\n\nnguyên hệ thống hoặc băng thông đường truyền mạng.\n\nCó nhiều kỹ thuật tấn công DoS đã được phát hiện trên thực tế. Các kỹ thuật tấn công\n\nDoS thường gặp bao gồm: SYN Flood, Smurf, Teardrop, Ping of Death, Land Attacks,\n\n## ICMP Flood, HTTP Flood, UDP Flood,… Trong phạm vi của môn học này, chúng ta chỉ\n\nđề cập đến 2 kỹ thuật phổ biến nhất là SYN Flood và Smurf.\n\n2.3.3.2. Tấn công SYN flood\n\na. Giới thiệu\n\nTấn công SYN Flood là kỹ thuật tấn công DoS khai thác điểm yếu trong thủ tục bắt\n\ntay 3 bước (3-way handshake) khi hai bên tham gia truyền thông thiết lập kết nối TCP để\n\nbắt đầu phiên trao đổi dữ liệu. SYN là bit cờ điều khiển của giao thức TCP dùng để đồng\n\nbộ số trình tự gói tin. Thủ tục bắt tay khi một người dùng hợp pháp thiết lập một kết nối\n\n## TCP đến máy chủ, như minh họa trên hình Hình 2.21 (a) gồm 3 bước như sau:\n\n- Người dùng thông qua máy khách gửi yêu cầu mở kết nối (SYN hay SYN-REQ)\n\nđến máy chủ;\n\n- Máy chủ nhận được lưu yêu cầu kết nối vào Bảng kết nối (Backlog) và gửi lại xác\n\nnhận kết nối SYN-ACK cho máy khách;\n\n- Khi nhận được SYN-ACK từ máy chủ, máy khách gửi lại xác nhận kết nối ACK\n\nđến máy chủ. Khi máy chủ nhận được xác nhận kết nối ACK từ máy khách, nó xác\n\nnhận kết nối mở thành công, máy chủ và máy khách bắt đầu phiên truyền thông\n\n## TCP.  Bản ghi mở kết nối được xóa khỏi Bảng kết nối.\n\nb. Kịch bản tấn công\n\n## Kịch bản tấn công SYN Flood, như minh họa trên Hình 2.21 (b) gồm các bước sau:\n\n- Kẻ tấn công gửi một lượng lớn yêu cầu mở kết nối (SYN-REQ) đến máy nạn nhân;\n\n---\n\n45\n\n- Nhận được yêu cầu mở kết nối, máy nạn nhân lưu yêu cầu kết nối vào Bảng kết nối\n\ntrong bộ nhớ;\n\n- Máy nạn nhân sau đó gửi xác nhận kết nối (SYN-ACK) đến kẻ tấn công;\n\n- Do kẻ tấn công không gửi lại xác nhận kết nối ACK, nên máy nạn nhân vẫn phải\n\nlưu tất cả các yêu cầu kết nối chưa được xác nhận trong Bảng kết nối. Khi Bảng\n\nkết nối bị điền đầy thì các yêu cầu mở kết nối của người dùng hợp pháp sẽ bị từ\n\nchối;\n\n- Máy nạn nhân chỉ có thể xóa một yêu cầu kết nối đang mở khi nó hết hạn (timed-\n\nout).\n\n## Hình 2.21. (a) Thủ tục bắt tay 3 bước của TCP và (b) Tấn công SYN Flood\n\nDo kẻ tấn công thường sử dụng địa chỉ IP giả mạo, hoặc địa chỉ không có thực làm\n\nđịa chỉ nguồn (Source IP) trong gói tin IP yêu cầu mở kết nối, nên xác nhận kết nối SYN-\n\n## ACK của máy nạn nhân không thể đến đích. Đồng thời, kẻ tấn công cố tình tạo một\n\nlượng rất lớn yêu cầu mở kết nối dở dang để chúng điền đầy bảng kết nối. Hậu quả là\n\nmáy nạn nhân không thể chấp nhận yêu cầu mở kết nối của những người dùng khác. Tấn\n\ncông SYN Flood làm cạn kiệt tài nguyên bộ nhớ (cụ thể là bộ nhớ Bảng kết nối) của máy\n\nnạn nhân, có thể làm máy nạn nhân ngừng hoạt động và gây nghẽn đường truyền mạng.\n\nc. Phòng chống\n\n## Nhiều biện pháp phòng chống tấn công SYN Flood được đề xuất, nhưng chưa có giải\n\npháp nào có khả năng ngăn chặn triệt để dạng tấn công này. Do vậy, để phòng chống tấn\n\ncông SYN Flood hiệu quả, cần kết hợp các biện pháp sau:\n\n- Sử dụng kỹ thuật lọc địa chỉ giả mạo (Spoofed IP Filtering): Kỹ thuật này đòi hỏi\n\nchỉnh sửa giao thức TCP/IP không cho phép kẻ tấn công giả mạo địa chỉ;\n\n- Tăng kích thước Bảng kết nối: Tăng kích thước Bảng kết nối cho phép tăng khả\n\nnăng chấp nhận các yêu cầu mở kết nối;\n\n---\n\n46\n\n- Giảm thời gian chờ (SYN-RECEIVED Timer): Các yêu cầu mở kết nối chưa được\n\nxác nhận sẽ bị xóa sớm hơn khi thời gian chờ ngắn hơn;\n\n- SYN cache: Một yêu cầu mở kết nối chỉ được cấp phát không gian nhớ đầy đủ khi\n\nnó được xác nhận;\n\n- Sử dụng tường lửa (Firewall) và Proxy: Tường lửa và proxy có khả năng nhận\n\ndạng các địa chỉ IP nguồn là địa chỉ không có thực, đồng thời chúng có khả năng\n\ntiếp nhận yêu cầu mở kết nối, chờ đến khi có xác nhận mới chuyển cho máy chủ\n\nđích.\n\n2.3.3.3. Tấn công Smurf\n\na. Giới thiệu\n\nTấn công Smurf là dạng tấn công DoS sử dụng giao thức điều khiển truyền (ICMP) và\n\nkiểu phát quảng bá có định hướng để gây ngập lụt đường truyền mạng của máy nạn nhân.\n\nTrên mỗi phân vùng mạng IP thường có 1 địa chỉ quảng bá, theo đó khi có một gói tin\n\ngửi tới địa chỉ này, nó sẽ được router của mạng chuyển đến tất cả các máy trong mạng\n\nđó.\n\n## Hình 2.22. Mô hình tấn công Smurf\n\nb. Kịch bản tấn công\n\n## Hình 2.22 minh họa mô hình tấn công DoS Smurf. Theo đó, kịch bản tấn công Smurf\n\ngồm các bước:\n\n- Kẻ tấn công gửi một lượng lớn gói tin chứa yêu cầu ICMP (Ping) với địa chỉ IP\n\nnguồn là địa chỉ của máy nạn nhân đến một địa chỉ quảng bá (IP Broadcast\n\naddress) của một mạng;\n\n- Router của mạng nhận được yêu cầu ICMP gửi đến địa chỉ quảng bá sẽ tự động\n\nchuyển yêu cầu này đến tất cả các máy trong mạng;\n\n- Các máy trong mạng nhận được yêu cầu ICMP sẽ gửi trả lời (reply) đến máy có\n\nđịa chỉ IP là địa nguồn trong yêu cầu ICMP (là máy nạn nhân). Nếu số lượng máy\n\ntrong mạng rất lớn thì máy nạn nhân sẽ bị ngập lụt đường truyền, hoặc ngừng hoạt\n\nđộng.\n\n---\n\n47\n\nc. Phòng chống\n\n## Có thể sử dụng các biện pháp sau để phòng chống tấn công Smurf:\n\n- Cấu hình các máy trong mạng và router không trả lời các yêu cầu ICMP, hoặc các\n\nyêu cầu phát quảng bá;\n\n- Cấu hình các router không chuyển tiếp yêu cầu ICMP gửi đến các địa chỉ quảng\n\nbá;\n\n- Sử dụng tường lửa để lọc các gói tin với địa chỉ giả mạo địa chỉ trong mạng.\n\nViệc cấu hình các router không chuyển tiếp yêu cầu ICMP, hoặc các máy trong mạng\n\nkhông trả lời các yêu cầu ICMP có thể gây khó khăn cho các ứng dụng dựa trên phát\n\nquảng bá và giao thức ICMP, như ứng dụng giám sát trạng thái hoạt động của các máy\n\ntrong mạng dựa trên ICMP/Ping.\n\n2.3.4. Tấn công từ chối dịch vụ phân tán\n\n2.3.4.1. Giới thiệu\n\nTấn công DDoS (Distributed Denial of Service) là một loại tấn công DoS đặc biệt,\n\nliên quan đến việc gây ngập lụt các máy nạn nhân với một lượng rất lớn các yêu cầu kết\n\nnối giả mạo. Điểm khác biệt chính giữa DDoS và DoS là phạm vi (scope) tấn công: trong\n\nkhi số lượng máy tham gia tấn công DoS thường tương đối nhỏ, chỉ gồm một số ít máy\n\ntại một, hoặc một số ít địa điểm, thì số lượng máy tham gia tấn công DDoS thường rất\n\nlớn, có thể lên đến hàng ngàn, hoặc hàng trăm ngàn máy, và các máy tham gia tấn công\n\nDDoS có thể đến từ rất nhiều vị trí địa lý khác nhau trên toàn cầu. Do vậy, việc phòng\n\nchống tấn công DDoS gặp nhiều khó khăn hơn so với việc phòng chống tấn công DoS.\n\n## Có thể chia tấn công DDoS thành 2 dạng chính theo mô hình kiến trúc: tấn công\n\n## DDoS trực tiếp (Direct DDoS) và tấn công DDoS gián tiếp, hay phản xạ\n\n(Indirect/Reflective DDoS). Trong tấn công DDoS trực tiếp, các yêu cầu tấn công được\n\ncác máy tấn công gửi trực tiếp đến máy nạn nhân. Ngược lại, trong tấn công DDoS gián\n\ntiếp, các yêu cầu tấn công được gửi đến các máy phản xạ (Reflectors) và sau đó gián tiếp\n\nchuyển đến máy nạn nhân.\n\n2.3.4.2. Tấn công DDoS trực tiếp\n\nHình 2.23 minh họa kiến trúc điển hình của dạng tấn công DDoS trực tiếp. Tấn công\n\n## DDoS trực tiếp được thực hiện theo nhiều giai đoạn theo kịch bản như sau:\n\n- Kẻ tấn công (Attacker) chiếm quyền điều khiển hàng ngàn, thậm chí hàng chục\n\nngàn máy tính trên mạng Internet, sau đó bí mật cài các chương trình tấn công tự\n\nđộng (Automated agents) lên các máy này. Các automated agents còn được gọi là\n\ncác Bot hoặc Zombie (Máy tính ma);\n\n- Các máy bị chiếm quyền điều khiển hình thành mạng máy tính ma, gọi là botnet\n\nhay zombie network. Các botnet, hay zombie network không bị giới hạn bởi chủng\n\nloại thiết bị và tô pô mạng vật lý;\n\n- Kẻ tấn công có thể giao tiếp với các máy botnet, zombie thông qua một mạng lưới\n\ncác máy trung gian (handler) gồm nhiều tầng. Phương thức giao tiếp có thể là IRC\n\n(Internet Relay Chat), P2P (Peer to Peer), HTTP,…\n\n---\n\n48\n\n- Tiếp theo, kẻ tấn công ra lệnh cho các automated agents đồng loạt tạo các yêu cầu\n\ngiả mạo gửi đến các máy nạn nhân tạo thành cuộc tấn công DDoS;\n\n- Lượng yêu cầu giả mạo có thể rất lớn và đến từ rất nhiều nguồn, vị trí địa lý khác\n\nnhau nên rất khó đối phó và lần vết để tìm ra kẻ tấn công thực sự.\n\n## Hình 2.23. Kiến trúc tấn công DDoS trực tiếp\n\n## Hình 2.24. Kiến trúc tấn công DDoS gián tiếp hay phản xạ\n\n2.3.4.3. Tấn công DDoS gián tiếp\n\nHình 2.24 minh họa kiến trúc tấn công DDoS gián tiếp, hay phản xạ. Tấn công DDoS\n\ngián tiếp cũng được thực hiện theo nhiều giai đoạn theo kịch bản như sau:\n\n- Kẻ tấn công chiếm quyền điều khiển của một lượng lớn máy tính trên mạng\n\n## Internet, cài đặt phần mềm tấn công tự động bot/zombie (còn gọi là slave), hình\n\nthành nên mạng botnet;\n\n---\n\n49\n\n- Theo lệnh của kẻ tấn công điều khiển các Slave/Zombie gửi một lượng lớn yêu cầu\n\ngiả mạo với địa chỉ nguồn là địa chỉ máy nạn nhân đến một số lớn các máy khác\n\n(Reflectors) trên mạng Internet;\n\n- Các Reflectors gửi các phản hồi (Reply) đến máy nạn nhân do địa chỉ của máy nạn\n\nnhân được đặt vào địa chỉ nguồn của yêu cầu giả mạo;\n\n- Khi các Reflectors có số lượng lớn, số phản hồi sẽ rất lớn và gây ngập lụt đường\n\ntruyền mạng hoặc làm cạn kiệt tài nguyên của máy nạn nhân, dẫn đến ngắt quãng\n\nhoặc ngừng dịch vụ cung cấp cho người dùng. Các Reflectors bị lợi dụng để tham\n\ngia tấn công thường là các hệ thống máy chủ có công suất lớn trên mạng Internet\n\nvà không chịu sự điều khiển của kẻ tấn công.\n\n2.3.4.4. Phòng chống tấn công DDoS\n\n## Nhìn chung, để phòng chống tấn công DDoS hiệu quả, cần kết hợp nhiều biện pháp\n\nvà sự phối hợp của nhiều bên do tấn công DDoS có tính phân tán cao và hệ thống mạng\n\nmáy tính ma (botnet) được hình thành và điều khiển theo nhiều tầng, lớp. Một số biện\n\npháp có thể xem xét áp dụng:\n\n- Sử dụng các phần mềm rà quét vi rút và các phần mềm độc hại khác nhằm loại bỏ\n\ncác loại bot, zombie, slaves khỏi các hệ thống máy tính;\n\n- Sử dụng các hệ thống lọc đặt trên các router, tường lửa của các nhà cung cấp dịch\n\nvụ Internet (ISP) để lọc các yêu cầu điều khiển (C&C – Command and Control)\n\ngửi từ kẻ tấn công đến các bot;\n\n- Sử dụng các hệ thống giám sát, phát hiện bất thường, nhằm phát hiện sớm các dấu\n\nhiệu của tấn công DDoS.\n\n- Sử dụng tường lửa để chặn (block) tạm thời các cổng dịch vụ bị tấn công.\n\n2.3.5. Tấn công giả mạo địa chỉ\n\n2.3.5.1. Giới thiệu\n\nDạng tấn công giả mạo địa chỉ thường gặp nhất là tấn công giả mạo địa chỉ IP, trong\n\nđó kẻ tấn công sử dụng địa chỉ IP giả làm địa chỉ nguồn (Source IP) của các gói tin IP,\n\nthường để đánh lừa máy nạn nhân nhằm vượt qua các hàng rào kiểm soát an ninh thông\n\nthường. Chẳng hạn, nếu kẻ tấn công giả địa chỉ IP là địa chỉ cục bộ của mạng LAN, hắn\n\ncó thể có nhiều cơ hội xâm nhập vào các máy khác trong mạng LAN đó do chính sách\n\nkiểm soát an ninh với các máy trong cùng mạng LAN thường được giảm nhẹ.\n\n2.3.5.2. Kịch bản\n\n## Hình 2.25 minh họa một cuộc tấn công giả mạo địa chỉ IP vào một máy nạn nhân\n\ntrong mạng cục bộ. Các bước thực hiện như sau:\n\n- Giả sử máy của kẻ tấn công có địa chỉ IP là 192.168.0.25 và hắn muốn gửi gói tin\n\ntấn công đến máy nạn nhân có địa chỉ IP là 100.0.0.75;\n\n- Kẻ tấn công tạo và gửi yêu cầu giả mạo với địa chỉ IP nguồn của các gói tin IP của\n\nyêu cầu là 100.0.0.80 đến máy nạn nhân. Địa chỉ 100.0.0.80 là địa chỉ cùng mạng\n\nLAN với máy nạn nhân 100.0.0.75;\n\n---\n\n50\n\n- Nếu tường lửa mạng LAN không lọc được các gói tin với địa chỉ nguồn giả mạo,\n\nyêu cầu giả mạo của kẻ tấn công có thể đến được và gây tác hại cho máy nạn nhân.\n\n## Hình 2.25. Minh họa tấn công giả mạo địa chỉ IP\n\n2.3.5.3. Phòng chống\n\nBiện pháp phòng chống tấn công giả mạo địa chỉ IP hiệu quả nhất là sử dụng kỹ thuật\n\nlọc trên tường lửa, hoặc các router với nguyên tắc lọc: các gói tin từ mạng ngoài đi vào\n\nmạng LAN mà có địa chỉ nguồn là địa chỉ nội bộ của mạng LAN đó thì chúng là các gói\n\ntin giả mạo và phải bị chặn.\n\n2.3.6. Tấn công nghe lén\n\n## Tấn công nghe lén (Sniffing/Eavesdropping), như minh họa trên Hình 2.26 là dạng\n\ntấn công sử dụng thiết bị phần cứng hoặc phần mềm, lắng nghe trên card mạng, hub,\n\nswitch, router, hoặc môi trường truyền dẫn để bắt các gói tin dùng cho phân tích, hoặc\n\nlạm dụng về sau. Đây là kiểu tấn công thụ động nhằm thu thập các thông tin nhạy cảm,\n\nhoặc giám sát lưu lượng mạng. Các thông tin nhạy cảm như tên người dùng, mật khẩu,\n\nthông tin thanh toán nếu không được mã hóa có thể bị nghe lén và lạm dụng. Các thông\n\ntin truyền trong mạng WiFi, hoặc các mạng không dây cũng có thể bị nghe lén dễ dàng\n\ndo môi trường truyền dẫn vô tuyến và nếu không sử dụng các cơ chế bảo mật đủ mạnh.\n\n## Hình 2.26. Một mô hình tấn công nghe lén\n\n---\n\n51\n\n## Để phòng chống tấn công nghe lén, có thể áp dụng các biện pháp sau:\n\n- Có cơ chế bảo vệ các thiết bị mạng và hệ thống truyền dẫn ở mức vật lý;\n\n- Sử dụng các biện pháp, cơ chế xác thực người dùng đủ mạnh;\n\n- Sử dụng các biện pháp bảo mật thông tin truyền dựa trên các kỹ thuật mã hóa.\n\n2.3.7. Tấn công kiểu người đứng giữa\n\n2.3.7.1. Giới thiệu\n\nTấn công kiểu người đứng giữa (Man in the middle) là dạng tấn công dụng quá trình\n\nchuyển gói tin đi qua nhiều trạm (hop) thuộc các mạng khác nhau, trong đó kẻ tấn công\n\nchặn bắt các thông điệp giữa 2 bên tham gia truyền thông và chuyển thông điệp lại cho\n\nbên kia. Mục đích chính của dạng tấn công này là đánh cắp thông tin. Hình 2.27 minh\n\nhọa mô hình tấn công kiểu người đứng giữa trong một phiên truyền file ở dạng rõ\n\n(plaintext) sử dụng giao thức FTP giữa máy khách (Client) và máy chủ (Server).\n\n## Hình 2.27. Mô hình chung của tấn công kiểu người đứng giữa\n\n2.3.7.2. Kịch bản\n\nHình 2.28 minh họa một kịch bản tấn công kiểu người đứng giữa, trong đó hai bên A\n\nvà B (Công ty A và Công ty B) trao đổi các thông điệp bí mật và kẻ tấn công C (Hacker)\n\nbắt và có thể sửa đổi, lạm dụng các thông điệp truyền giữa A và B. Các bước tấn công cụ\n\nthể như sau:\n\n## Hình 2.28. Một kịch bản tấn công kiểu người đứng giữa\n\n---\n\n52\n\n- A gửi các thông điệp để thiết lập một phiên làm việc bảo mật với B;\n\n- C bắt được các thông điệp A gửi. C giả làm B và trao đổi các khóa của mình với A.\n\nSau đó C giả làm A để thiết lập một phiên làm việc với B (có trao đổi khóa với B);\n\n- B gửi các thông điệp cho C mà vẫn tưởng như đang liên lạc với A. C nhận các\n\nthông điệp B gửi, giải mã bằng khóa của mình (và có thể sửa đổi), sau đó chuyển\n\ntiếp thông điệp cho A. A nhận các thông điệp mà không biết là chúng đã bị C lạm\n\ndụng.\n\n2.3.7.3. Phòng chống\n\nMột trong các biện pháp hiệu quả để phòng chống tấn công kiểu người đứng giữa là\n\nhai bên tham gia truyền thông phải có cơ chế xác thực thông tin nhận dạng của nhau và\n\nxác thực tính toàn vẹn của các thông điệp trao đổi. Chẳng hạn, các bên có thể sử dụng\n\nchứng chỉ số khóa công khai (Public key certificate) để xác thực thông tin nhận dạng của\n\nnhau và sử dụng chữ ký số để đảm bảo tính toàn vẹn của các thông điệp trao đổi.\n\n2.3.8. Tấn công bằng bom thư và thư rác\n\n## Tấn công bằng bom thư (Mail bombing attack) là một dạng tấn công DoS khi kẻ tấn\n\ncông gửi một lượng rất lớn email đến hộp thư của nạn nhân. Khi đó hộp thư và cả máy\n\nchủ nạn nhân có thể bị tê liệt và không thể hoạt động bình thường. Tấn công bằng bom\n\nthư có thể được thực hiện bằng một số thủ thuật:\n\n- Gửi bom thư bằng cách sử dụng kỹ thuật xã hội, đánh lừa người dùng phát tán\n\nemail;\n\n- Khai thác lỗi trong hệ thống gửi nhận email SMTP;\n\n- Lợi dụng các máy chủ email không được cấu hình tốt để gửi email (relay) cho\n\nchúng.\n\nTấn công bằng thư rác (Email spamming attack) là dạng tấn công gửi các thư không\n\nmong muốn, như thư quảng cáo, thư chứa các phần mềm độc hại. Theo một số thống kê,\n\nkhoảng 70-80% lượng email gửi trên mạng Internet là thư rác. Kẻ tấn công thường sử\n\ndụng các máy tính bị điều khiển (bot/zombie) để gửi email cho chúng. Spam email gây\n\nlãng phí tài nguyên tính toán và thời gian của người dùng.\n\nCó thể hạn chế, hoặc giảm thiểu tác hại của hình thức tấn công bằng bom thư và thư\n\nrác sử dụng các biện pháp sau:\n\n- Cấu hình máy chủ email SMTP hỗ trợ các giải pháp bảo mật email, như xác thực\n\nngười gửi, hoặc xác thực máy chủ gửi email (SPF, DKIM, S/MINE…);\n\n- Sử dụng các bộ lọc thư rác tập trung trên máy chủ email cũng như phân tán trên\n\ncác máy khách email.\n\n2.3.9. Tấn công sử dụng các kỹ thuật xã hội\n\n2.3.9.1. Giới thiệu\n\nTấn công sử dụng các kỹ thuật xã hội (Social engineering attack) là dạng tấn công phi\n\nkỹ thuật nhằm vào người dùng. Dạng tấn công này khai thác các điểm yếu cố hữu của\n\nngười dùng, như tính cả tin, ngây thơ, tò mò và lòng tham. Dạng thường gặp của kiểu tấn\n\n---\n\n53\n\ncông này là thuyết phục người dùng tiết lộ thông tin truy nhập hoặc các thông tin có giá\n\ntrị cho kẻ tấn công. Một số kỹ thuật mà kẻ tấn công thường áp dụng gồm:\n\n- Kẻ tấn công có thể giả danh làm người có vị trí cao hơn so với nạn nhân để có\n\nđược sự tin tưởng, từ đó thuyết phục hoặc đánh lừa nạn nhân cung cấp thông tin;\n\n- Kẻ tấn công có thể mạo nhận là người được ủy quyền của người có thẩm quyền để\n\nyêu cầu các nhân viên tiết lộ thông tin về cá nhân/tổ chức;\n\n- Kẻ tấn công có thể lập trang web giả để đánh lừa người dùng cung cấp các thông\n\ntin cá nhân, thông tin tài khoản, thẻ tín dụng,…\n\n2.3.9.2. Trò lừa đảo Nigeria 4-1-9\n\nTrò lừa đảo Nigeria 4-1-9 là một trong các dạng tấn công sử dụng các kỹ thuật xã hội\n\nnổi tiếng nhất, trong đó đã có hàng chục nghìn người ở Mỹ, Canada và Châu Âu đã sập\n\nbẫy của kẻ lừa đảo. Kẻ lừa đảo lợi dụng sự ngây thơ và lòng tham của một số người với\n\nkịch bản tóm tắt như sau:\n\n- Kẻ lừa đảo gửi thư tay, hoặc email đến nhiều người nhận, mô tả về việc có 1 khoản\n\ntiền lớn (từ thừa kế, hoặc lợi tức,..) cần chuyển ra nước ngoài, nhờ người nhận giúp\n\nđỡ để hoàn thành giao dịch. Khoản tiền có thể lên đến hàng chục, hoặc trăm triệu\n\n## USD. Kẻ lừa đảo hứa sẽ trả cho người tham gia một phần số tiền (lên đến 20-\n\n30%);\n\n- Nếu người nhận có phản hồi và đồng ý tham gia, kẻ lừa đảo sẽ gửi tiếp thư, hoặc\n\nemail khác, yêu cầu chuyển cho hắn 1 khoản phí giao dịch (từ vài ngàn đến hàng\n\nchục ngàn USD);\n\n- Nếu người nhận gửi tiền phí giao dịch theo yêu cầu thì người đó sẽ mất tiền, do\n\ngiao dịch mà kẻ lừa đảo hứa hẹn là giả mạo.\n\nNhiều biến thể của trò lừa đảo Nigeria 4-1-9 đã xuất hiện trong những năm gần đây\n\ntrên thế giới cũng như ở Việt Nam, chẳng hạn như thông báo lừa trúng thưởng các tài sản\n\ncó giá trị lớn để chiếm đoạt khoản \"phí trả thưởng\", lừa đầu tư vào tài khoản ảo với hứa\n\nhẹn lãi suất cao,…\n\n2.3.9.3.  Phishing\n\nPhishing là một dạng đặc biệt phát triển rất mạnh của tấn công sử dụng các kỹ thuật\n\nxã hội, trong đó kẻ tấn công bẫy người dùng để lấy thông tin cá nhân, thông tin tài khoản,\n\nthẻ tín dụng,… Kẻ tấn công có thể giả mạo trang web của các tổ chức tài chính, ngân\n\nhàng, sau đó chúng gửi email cho người dùng (địa chỉ email thu thập trên mạng), yêu cầu\n\nxác thực thông tin. Hình 2.29 và Hình 2.30 minh họa 2 phishing email gửi cho khách\n\nhàng của mạng đấu giá trực tuyến eBay và ngân hàng Royal Bank yêu cầu người dùng\n\ncập nhật thông tin thanh toán đã hết hạn, hoặc xác nhận thông tin tài khoản không sử\n\ndụng. Nếu người dùng làm theo hướng dẫn thì sẽ vô tình cung cấp các thông tin cá nhân,\n\nthông tin tài khoản, thẻ tín dụng cho kẻ tấn công.\n\n---\n\n54\n\n## Hình 2.29. Một phishing email gửi cho khách hàng của mạng đấu giá eBay\n\n## Hình 2.30. Một phishing email gửi cho khách hàng của ngân hàng Royal Bank\n\n2.3.9.4. Phòng chống\n\n## Do tấn công sử dụng các kỹ thuật xã hội nhắm đến người dùng nên biện pháp phòng\n\nchống hiệu quả là giáo dục, đào tạo nâng cao ý thức cảnh giác cho người dùng. Một số\n\nkhuyến nghị giúp người dùng phòng tránh dạng tấn công này:\n\n- Cảnh giác với các lời mời, hoặc thông báo trúng thưởng bằng email, tin nhắn điện\n\nthoại, hoặc quảng cáo trên các trang web, diễn đàn mà không có lý do, nguồn gốc\n\ntrúng thưởng rõ ràng;\n\n- Cảnh giác với các yêu cầu cung cấp thông tin, xác nhận tài khoản, thông tin thanh\n\ntoán, thông tin thẻ tín dụng,..;\n\n- Kiểm tra kỹ địa chỉ (URL) các trang web, đảm bảo truy nhập đúng trang web của\n\ncơ quan, tổ chức.\n\n---\n\n55\n\n2.3.10. Tấn công pharming\n\nPharming là kiểu tấn công vào trình duyệt của người dùng, trong đó người dùng gõ\n\nđịa chỉ 1 website, trình duyệt lại yêu cầu và tải 1 website khác, thường là website độc hại.\n\nCó 2 dạng tấn công pharming: (1) kẻ tấn công thường sử dụng sâu, vi rút hoặc các phần\n\nmềm độc hại cài vào hệ thống để điều khiển trình duyệt của người dùng và (2) kẻ tấn\n\ncông có thể tấn công vào hệ thống tên miền (DNS) để thay đổi kết quả truy vấn: thay địa\n\nchỉ IP của website hợp pháp thành IP của website độc hại.\n\nHình 2.31 minh họa cửa sổ trình duyệt của người dùng bị tấn công pharming ở dạng\n\n(1), hay còn gọi là tấn công cướp trình duyệt (Browser hijacking), trong đó người dùng\n\nnhập địa chỉ trang google.com thì trình duyệt lại nạp trang adventureinsecurity.com.\n\nTrong trường hợp này, trình duyệt của nạn nhân đã bị cài đặt trình cắm (plug-in, hoặc\n\nadd-on) độc hại có khả năng điều khiển trình duyệt.\n\n## Hình 2.31. Tấn công pharming \"cướp\" trình duyệt\n\nHình 2.32 minh họa các bước của tấn công pharming dạng (2), trong đó kẻ tấn công\n\nxâm nhập vào máy chủ DNS chỉnh sửa địa chỉ IP của website hợp pháp thành địa chỉ IP\n\ncủa máy chủ của chúng. Kết quả là trình duyệt người dùng bị chuyển hướng yêu cầu nạp\n\nwebsite của kẻ tấn công. Các bước cụ thể của tấn công pharming dạng này như sau:\n\n(1) Kẻ tấn công (Attacker) xâm nhập vào máy chủ DNS của người dùng thực hiện\n\nchỉnh sửa địa chỉ IP của website hợp pháp thành IP của máy chủ web của chúng;\n\n(2) Người dùng (User) sử dụng trình duyệt để gửi yêu cầu truy cập website hợp pháp,\n\nchẳng hạn trang (Website - www.nicebank.com);\n\n(3) Trình duyệt của người dùng gửi yêu cầu phân giải địa chỉ IP của trang website hợp\n\npháp lên máy chủ DNS (DNS Server);\n\n(4) Máy chủ DNS thực hiện yêu cầu phân giải địa chỉ IP và trả về kết quả. Tuy nhiên,\n\ndo máy chủ DNS đã bị kiểm soát nên địa chỉ IP nó trả về là địa chỉ IP của máy chủ\n\nweb của kẻ tấn công;\n\n---\n\n56\n\n(5) Trình duyệt của người dùng gửi yêu cầu, tải và nạp trang web giả mạo từ máy chủ\n\nweb của kẻ tấn công (Fake website – www.n1cebank.com).\n\n## Hình 2.32. Tấn công pharming thông qua tấn công vào máy chủ DNS\n\n2.3.11. Tấn công APT\n\n## Tấn công APT (Advanced Persistent Threat), hay còn được gọi là tấn công có chủ\n\nđích là hình thức tấn công tập trung, có chủ đích, được thiết kế riêng cho từng mục tiêu,\n\ntừng đối tượng cụ thể nhằm mục đích tìm kiếm các thông tin giá trị và gửi ra bên ngoài\n\n[12]. Hai thuộc tính quan trọng của tấn công APT là tiên tiến, hay cao cấp (Advanced) và\n\nKiên trì, dai dẳng (Persistent). Thuộc tính “tiên tiến” có nghĩa là các kỹ thuật tiên tiến\n\nđược sử dụng để tấn công vào hệ thống mục tiêu một cách bài bản. Bên cạnh đó các cuộc\n\ntấn công APT thường kết hợp nhiều kỹ thuật khác nhau một cách khoa học. Tính “tiên\n\ntiến” còn thể hiện ở khả năng ẩn mình, thay đổi liên tục khiến cho việc phát hiện tấn công\n\nAPT trở nên rất khó khăn. Phần lớn các cuộc tấn công được ghi nhận trên thế giới đều có\n\nnhững đặc điểm và cách thức tấn công, khai thác khác nhau.\n\nThuộc tính “kiên trì” có nghĩa là mục tiêu được xác định rất cụ thể để thực hiện tấn\n\ncông, ẩn mình và khai thác theo từng giai đoạn. Nhiều kỹ thuật, phương pháp tấn công\n\nkhác nhau vào mục tiêu được sử dụng cho đến khi thành công. Bên cạnh đó sự kiên trì\n\ncủa kẻ tấn công còn thể hiện ở chỗ, chúng có thể sử dụng hàng tháng, thậm chí hàng năm\n\nchỉ để thu thập thông tin của nạn nhân làm tiền đề cho cuộc tấn công. Ví dụ, để tấn công\n\nvào người dùng chúng kiên trì tìm hiểu thông tin về người dùng đó như sở thích, tính\n\ncách hay cách đặt tên file, mối quan hệ của nạn nhân trên thế giới ảo. Đồng thời, tấn công\n\nAPT dai dẳng ở chỗ khi chúng đã xâm nhập được vào hệ thống và đã đánh cắp được dữ\n\nliệu và gửi ra ngoài, chúng không bao giờ dừng việc đánh cắp dữ liệu mà mục đích của\n\nchúng là cài cắm mã độc vào hệ thống để lấy được càng nhiều dữ liệu càng tốt. Một cuộc\n\ntấn công APT điển hình thường được thực hiện theo các giai đoạn sau:\n\n---\n\n57\n\n- Truy cập ban đầu: Mục tiêu của giai đoạn này là lây nhiễm mã độc vào hệ thống\n\nmục tiêu thông qua bẫy người dùng tải và cài đặt mã độc, hoặc tấn công khai thác\n\ncác lỗ hổng của hệ điều hành hoặc các ứng dụng;\n\n- Thâm nhập lần đầu và triển khai mã độc: Sau khi có quyền truy cập, kẻ tấn công\n\ncài đặt mã độc thường trú lâu dài trong hệ thống mục tiêu và duy trì kết nối với hệ\n\nthống điều khiển của kẻ tấn công. Các kỹ thuật tiến tiến như mã hóa, xáo trộn mã,\n\nđa hình được sử dụng giúp mã độc có thể tồn tài lâu dài trong hệ thống mục tiêu;\n\n- Mở rộng truy cập và di chuyển ngang: Các xâm nhập sâu hơn vào các hệ thống\n\nđược thực hiện để có thể đánh cắp nhiều dữ liệu nhạy cảm hơn. Các cửa hậu và các\n\nđường hầm cũng có thể được cài đặt để thuận tiện cho việc vận chuyển dữ liệu\n\nđánh cắp được sau này;\n\n- Giai đoạn tấn công: Kẻ tấn công thực hiện quá trình giám sát các đối tượng, hoặc\n\nhệ thống nhằm trích xuất và vận chuyển dữ liệu nhạy cảm đến nơi an toàn trong hệ\n\nthống. Các dữ liệu trích xuất được thường được nén và mã hóa trước khi được vận\n\nchuyển ra ngoài;\n\n- Gây thiệt hại: Thực hiện việc vận chuyển dữ liệu đánh cắp được ra ngoài. Kẻ tấn\n\ncông có thể thực hiện một số dạng tấn công khác, như tấn công DDoS vào hệ\n\nthống mục tiêu để đánh lạc hướng người quản trị và xóa các dấu vết việc sao chép\n\nvà truyền dữ liệu ra ngoài;\n\n- Tấn công tiếp theo: Thông thường cuộc tấn công APT không kết thúc sau khi đã\n\nlấy được dữ liệu mong muốn. Kẻ tấn công vẫn giám sát hệ thống thông qua các\n\ncửa hậu đã mở hoặc các mã độc thường trú nhằm chờ cơ hội xâm nhập sâu hơn,\n\nhoặc thực hiện các cuộc tấn công trong tương lai.\n\nDo tấn công APT là dạng tấn công phức tạp, kết hợp của việc sử dụng mã độc cao cấp\n\nvới các kỹ thuật tấn công tinh vi nên cần có một chiến lược thích hợp để phòng chống\n\ndạng tấn công này. Chiến lược tổng quát là kết hợp nhiều biện pháp, hoặc lớp phòng vệ,\n\nkết hợp với việc đào tạo nâng cao ý thức người dùng về an toàn thông tin. Trong đó, các\n\nlớp phòng vệ cần thiết bao gồm: tường lửa, kiểm soát truy cập, các hệ thống phát hiện và\n\ndiệt mã độc, các hệ thống giám sát phát hiện xâm nhập có tích hợp khả năng phân tích\n\ntương quan các dạng nguy cơ, kết hợp với hệ thống quản lý và chính sách an toàn thông\n\ntin đầy đủ và được giám sát thực hiện nghiêm ngặt.\n\n2.4. Các dạng phần mềm độc hại\n\n## Các phần mềm độc hại, còn gọi là phần mềm mã độc (Malware hay Malicious\n\nsoftware), hay ngắn gọn là mã độc là các chương trình, phần mềm được viết ra nhằm các\n\nmục đích xấu, như đánh cắp thông tin nhạy cảm, hoặc phá hoại các hệ thống. Khi mới\n\nđược phát hiện vào những năm 1970-1980, các phần mềm độc hại còn tương đối ít chủng\n\nloại và được gọi chung là vi rút (virus). Tuy nhiên, theo thời gian vi rút đã phát triển rất\n\nmạnh thành nhiều dạng khác nhau, đặc biệt với sự bùng nổ của mạng Internet toàn cầu và\n\nthuật ngữ “phần mềm độc hại” hay “mã độc” (malware)  được sử dụng chỉ các dạng mã\n\nđộc thay thế cho thuật ngữ “vi rút”.\n\n---\n\n58\n\n2.4.1. Phân loại\n\n## Các phần mềm độc hại (Malware hay Malicious software) là các chương trình, phần\n\nmềm được viết ra nhằm các mục đích xấu, như đánh cắp thông tin nhạy cảm, hoặc phá\n\nhoại các hệ thống.\n\n## Có nhiều phương pháp phân loại các phần mềm độc hại, trong đó một phương pháp\n\nđược thừa nhận rộng rãi là chia các phần mềm độc hại thành 2 nhóm chính như biểu diễn\n\ntrên Hình 2.33. Theo đó, các phần mềm độc hại được chia thành 2 nhóm chính dựa trên\n\nphương pháp lây nhiễm như sau:\n\n- Các phần mềm độc hại cần chương trình chủ, vật chủ (host) để ký sinh và lây\n\nnhiễm. Các phần mềm độc hại thuộc nhóm này gồm Logic bomb (Bom logic),\n\nBack door (Cửa hậu), Trojan horse (Con ngựa thành Tơ roa), Virus (Vi rút),\n\n## Rootkit, Adware (Phần mềm quảng cáo) và Spyware (Phần mềm gián điệp).\n\n- Các phần mềm độc hại không cần chương trình chủ, vật chủ để lây nhiễm. Các\n\nphần mềm độc hại thuộc nhóm này gồm Worm (Sâu) và Zombie hay Bot (Phần\n\nmềm máy tính ma).\n\n## Hình 2.33. Các dạng phần mềm độc hại\n\n## Trong số các phần mềm độc hại, các phần mềm độc hại có khả năng tự lây nhiễm\n\n(self-infection), hay tự nhân bản (self-replicate) gồm Vi rút, Sâu và Phần mềm máy tính\n\nma. Các dạng còn lại không có khả năng tự lây nhiễm. Việc phân loại các phần mềm độc\n\nhại kể trên mang tính chất tương đối do hiện nay, các dạng phần mềm độc hại và các biến\n\nthể của chúng phát triển rất nhanh và nhiều dạng mã độc mới được phát hiện trong thời\n\ngian gần đây. Chẳng hạn, các dạng mã độc mã hóa dữ liệu nhằm tống tiền\n\n(Ransomeware), mã độc đào tiền ảo và mã độc chuyên dụng cho tấn công APT đang phát\n\ntriển rất mạnh. Ngoài ra, có một số phần mềm độc hại có các đặc tính kết hợp của nhiều\n\ndạng phần mềm độc hại kể trên, chẳng hạn một phần mềm độc hại có các đặc tính của cả\n\nvi rút, sâu và phần mềm gián điệp. Mục tiếp theo trình bày chi tiết từng dạng phần mềm\n\nđộc hại đã nêu trên Hình 2.33.\n\n---\n\n59\n\n2.4.2. Mô tả các dạng phần mềm độc hại\n\n2.4.2.1. Logic bomb\n\n## Logic bomb (Bom lô gíc) là các đoạn mã độc thường được “nhúng” vào các chương\n\ntrình bình thường và thường hẹn giờ để “phát nổ” trong một số điều kiện cụ thể. Điều\n\nkiện để bom “phát nổ” có thể là sự xuất hiện hoặc biến mất của các file cụ thể, một thời\n\nđiểm cụ thể, hoặc một ngày trong tuần. Khi “phát nổ” bom logic có thể xoá dữ liệu, file,\n\ntắt cả hệ thống...\n\n## Thực tế đã ghi nhận quả bom logic do Tim Lloyd cài lại đã “phát nổ” tại công ty\n\nOmega Engineering vào ngày 30/7/1996, 20 ngày sau khi Tim Lloyd bị sa thải. Bom lô\n\ngíc này đã xoá sạch các bản thiết kế và các chương trình, gây thiệt hại 10 triệu USD cho\n\ncông ty. Bản thân Tim Lloyd bị phạt 2 triệu USD và 41 tháng tù.\n\n2.4.2.2. Trojan Horse\n\nTrojan horse lấy tên theo tích “Con ngựa thành Tơ roa”, là chương trình chứa mã độc,\n\nthường giả danh những chương trình có ích, nhằm lừa người dùng kích hoạt chúng.\n\nTrojan horse thường được sử dụng để thực thi gián tiếp các tác vụ, mà tác giả của chúng\n\nkhông thể thực hiện trực tiếp do không có quyền truy nhập. Chẳng hạn, trong một hệ\n\nthống nhiều người dùng, một người dùng (kẻ tấn công) có thể tạo ra một trojan đội lốt\n\nmột chương trình hữu ích đặt ở thư mục chung. Khi trojan này được thực thi bởi một\n\nngười dùng khác, nó sẽ thay đổi quyền truy nhập các file và thư mục của người dùng đó,\n\ncho phép tất cả người dùng (trong đó có kẻ tấn công) truy nhập vào các file của người\n\ndùng đó.\n\n2.4.2.3. Back door\n\nBack door (Cửa hậu) thường được các lập trình viên tạo ra, dùng để gỡ rối và kiểm\n\nthử chương trình trong quá trình phát triển. Cửa hậu thường cho phép truy nhập trực tiếp\n\nvào hệ thống mà không qua các thủ tục kiểm tra an ninh thông thường. Khi cửa hậu được\n\nlập trình viên tạo ra để truy nhập bất hợp pháp vào hệ thống, nó trở thành một mối đe dọa\n\nđến an ninh hệ thống. Cửa hậu thường được thiết kế và cài đặt khéo léo và chỉ được kích\n\nhoạt trong một ngữ cảnh nào đó, do vậy nó rất khó bị phát hiện.\n\nThực tế đã phát hiện nhiều cửa hậu được bí mật cài đặt trên các hệ thống máy tính,\n\nnhư mã độc cửa hậu được bí mật cài đặt trong BIOS của một loạt máy tính của hãng\n\n## Lenovo, Trung quốc. Do mã độc được tích hợp vào BIOS của máy nên người dùng\n\nkhông thể loại bỏ được chúng bằng cách cài đặt lại hệ điều hành, hoặc sử dụng các công\n\ncụ rà quét phần mềm độc hại. Mã độc này tự động được kích hoạt khi hệ thống khởi động\n\nvà âm thầm thu thập dữ liệu người dùng và gửi về máy chủ đặt tại Trung quốc.\n\n2.4.2.4. Vi rút\n\na. Giới thiệu\n\nVi rút (Virus) là một chương trình có thể “nhiễm” vào các chương trình khác, bằng\n\ncách sửa đổi các chương trình này. Nếu các chương trình đã bị sửa đổi chứa vi rút được\n\nkích hoạt thì vi rút sẽ tiếp tục “lây nhiễm” sang các chương trình khác. Tương tự như vi\n\nrút sinh học, vi rút máy tính cũng có khả năng tự nhân bản, tự lây nhiễm sang các chương\n\n---\n\n60\n\ntrình khác mà nó tiếp xúc. Có nhiều con đường lây nhiễm vi rút, như sao chép file, gọi\n\ncác ứng dụng và dịch vụ qua mạng, email...\n\nVi rút có thể thực hiện được mọi việc mà một chương trình thông thường có thể thực\n\nhiện. Khi đã lây nhiễm vào một chương trình, vi rút tự động được thực hiện khi chương\n\ntrình này chạy. Hình 2.34 minh họa việc chèn mã vi rút vào cuối một chương trình và\n\nchỉnh sửa chương trình để khi chương trình được kích hoạt, mã vi rút luôn được thực hiện\n\ntrước, sau đó mới thực hiện mã chương trình.\n\n## Hình 2.34. Chèn và gọi thực hiện mã vi rút\n\nb. Các loại vi rút\n\nDạng vi rút đầu tiên được phát hiện là vi rút lây nhiễm vào các file chương trình. Theo\n\nthời gian, có nhiều loại vi rút xuất hiện khai thác nhiều phương thức lây nhiễm khác nhau\n\nvà được tích hợp các kỹ thuật ẩn tinh vi mình nhằm lẩn tránh bị rà quét. Hiện nay, các\n\nloại vi rút thường gặp bao gồm boot vi rút, file vi rút, macro vi rút và email vi rút.\n\nBoot vi rút là dạng vi rút lây nhiễm vào cung khởi động (boot sector) của đĩa hoặc\n\nphần hệ thống của đĩa như cung khởi động chủ của đĩa cứng (master boot record). Do\n\nboot vi rút lây nhiễm vào cung khởi động nên nó luôn được nạp vào bộ nhớ mỗi khi hệ\n\nthống máy khởi động. Boot vi rút có thể gây hỏng phần khởi động của đĩa, thậm chí có\n\nthể làm cho đĩa không thể truy nhập được.\n\nFile vi rút là dạng vi rút phổ biến nhất, đối tượng lây nhiễm của chúng là các file\n\nchương trình và các file dữ liệu. Mỗi khi chương trình được kích hoạt hoặc file dữ liệu\n\nđược nạp vào bộ nhớ, vi rút được kích hoạt. Mọi chương trình tiếp theo được kích hoạt\n\nđều bị lây nhiễm vi rút này. File vi rút có thể làm hỏng chương trình, hỏng hoặc phá hủy\n\ncác file dữ liệu, đánh cắp các dữ liệu nhạy cảm,…\n\nMacro vi rút là một loại file vi rút đặc biệt do chúng chỉ lây nhiễm vào các tài liệu của\n\nbộ phần mềm Microsoft Office. Macro vi rút hoạt động được nhờ tính năng cho phép tạo\n\nvà thực hiện các đoạn mã macro trong các tài liệu của bộ ứng dụng Microsoft Office,\n\ngồm ứng dụng soạn thảo Word, bảng tính Excel, trình email Outlook,…. Các đoạn mã\n\nmacro thường được dùng để tự động hóa 1 số việc và được viết bằng ngôn ngữ Visual\n\nBasic for Applications (VBA). Macro vi rút thường lây nhiễm vào các file định dạng\n\n---\n\n61\n\nchuẩn (các template như normal.dot và normal.dotx) và từ đó lây nhiễm vào tất cả các\n\nfile tài liệu được mở. Macro vi rút cũng có thể được tự động kích hoạt nhờ các auto-\n\nexecuted macros, như AutoExecute, Automacro và Command macro. Theo thống kê,\n\nmacro vi rút chiếm khoảng 2/3 tổng lượng vi rút đã được phát hiện. Lượng tài liệu bị lây\n\nnhiễm macro vi rút đã giảm đáng kể từ khi Microsoft Office 2010 có thiết lập ngầm định\n\nkhông cho phép tự động chạy các macro.\n\nEmail vi rút lây nhiễm bằng cách tự động gửi một bản copy của nó như 1 file đính\n\nkèm đến tất cả các địa chỉ email trong sổ địa chỉ của người dùng trên máy bị lây nhiễm.\n\nNếu người dùng mở email hoặc file đính kèm, vi rút được kích hoạt. Email vi rút có thể\n\nlây nhiễm rất nhanh chóng, lan tràn trên khắp thế giới trong một thời gian ngắn. Hình\n\n2.35 là một email do vi rút gửi đến người dùng, theo đó email có đính kèm một file giả\n\ndạng một giấy biên nhận chứa mã vi rút lừa người dùng mở và kích hoạt.\n\n## Hình 2.35. Một email do vi rút gửi đến người dùng\n\n2.4.2.5. Sâu\n\nSâu (Worm) là một loại phần mềm độc hại có khả năng tự lây nhiễm từ máy này sang\n\nmáy khác mà không cần chương trình chủ, vật chủ, hoặc sự trợ giúp của người dùng. Khi\n\nsâu lây nhiễm vào một máy, nó sử dụng máy này làm “bàn đạp” để tiếp tục rà quét, tấn\n\ncông các máy khác. Một trong các dạng sâu phổ biến là sâu mạng (network worm) sử\n\ndụng kết nối mạng để lây lan từ máy này sang máy khác. Hình 2.36 minh họa một mô\n\nhình lây lan của sâu mạng: Bắt đầu từ máy F, sâu quét các máy B và E trên cổng 25\n\n(SMTP) để lây nhiễm. Khi sâu lây nhiễm thành công lên máy B, nó lại tiếp tục rà quét\n\ncác máy A, C và D trên cổng 25 để tìm đích lây nhiễm tiếp theo. Mặc dù sử dụng phương\n\nthức lây lan khác vi rút, khi sâu hoạt động, nó tương tự vi rút.\n\nHiện nay, sâu có thể lây lan sử dụng nhiều phương pháp khác nhau. Một số sâu chỉ sử\n\ndụng một phương pháp lây lan, nhưng một số sâu khác có khả năng lây lan theo nhiều\n\nphương pháp. Các phương pháp lây lan chính của sâu gồm:\n\n---\n\n62\n\n## Hình 2.36. Một mô hình lây lan của sâu mạng\n\n- Lây lan qua thư điện tử: Sâu sử dụng email để gửi bản sao của mình đến các máy\n\nkhác.\n\n- Lây lan thông qua khả năng thực thi từ xa: Sâu gửi và thực thi một bản sao của nó\n\ntrên một máy khác thông qua việc khai thác các lỗ hổng an ninh của hệ điều hành,\n\ncác dịch vụ, hoặc phần mềm ứng dụng.\n\n- Lây lan thông qua khả năng log-in (đăng nhập) từ xa: Sâu đăng nhập vào hệ thống\n\nở xa như một người dùng và sử dụng lệnh để sao chép bản thân nó từ máy này\n\nsang máy khác.\n\n## Sâu Code Red được phát hiện vào tháng 7/2001 lây nhiễm thông qua việc khai thác\n\nlỗi tràn bộ đệm khi xử lý các file .ida trong máy chủ web Microsoft IIS (Internet\n\nInformation Service). Code Red quét các địa chỉ IP ngẫu nhiên để tìm các hệ thống có lỗi\n\nvà lây nhiễm vào 360.000 máy chủ trong vòng 14 giờ. Sau đó, sâu Nimda được phát hiện\n\nvào tháng 9/2001 là sâu có khả năng lây lan theo nhiều con đường:\n\n- Qua email từ máy client sang client.\n\n- Qua các thư mục chia sẻ trên mạng.\n\n- Từ máy chủ web sang trình duyệt.\n\n- Từ máy khách đến máy chủ nhờ khai thác các lỗi máy chủ.\n\nChỉ 22 phút sau khi ra đời, Nimda trở thành sâu có tốc độ lan truyền nhanh nhất trên\n\n## Internet vào thời điểm đó.\n\n2.4.2.6. Zombie/Bot\n\n## Zombie/Bot (còn gọi là Automated agent – từ đây thống nhất gọi là Bot) là một\n\nchương trình được thiết kế để giành quyền kiểm soát một máy tính, hoặc thiết bị tính toán\n\ncó kết nối Internet và sử dụng máy tính bị kiểm soát để tấn công các hệ thống khác, hoặc\n\ngửi thư rác. Tương tự như sâu, bot có khả năng tự lây nhiễm sang các hệ thống khác mà\n\nkhông cần chương trình chủ, vật chủ, hoặc hỗ trợ từ người dùng. Một tập hợp các máy\n\ntính bot dưới sự kiểm soát của một, hoặc một nhóm kẻ tấn công được gọi là mạng máy\n\n---\n\n63\n\ntính ma, hay botnet. Kẻ tấn công kiểm soát và điều khiển các bot trong botnet thông qua\n\nmột hệ thống các máy chủ lệnh và điều khiển trung gian (Command and control – C&C)\n\nsử dụng các giao thức truyền thông thông dụng như HTTP, hoặc IRC. Hình 2.37 minh\n\nhọa mô hình giao tiếp giữa các thành phần trong botnet: kẻ tấn công/chủ của botnet\n\n(botmaster) gửi lệnh cho các bot thông qua các máy chủ C&C.\n\n## Hình 2.37. Mô hình mô hình giao tiếp giữa các thành phần trong botnet\n\nKhác với các phần mềm độc hại khác, các bot có khả năng tự tải mã cập nhật và nâng\n\ncấp phiên bản từ các máy chủ C&C nhằm tăng khả năng sống sót. Các bot định kỳ truy\n\ncập đến các máy chủ C&C để tải lệnh và mã cập nhật. Các bot thường được điều phối và\n\nsử dụng để thực hiện các cuộc tấn công DDoS các máy chủ, các website của các công ty,\n\nhoặc các tổ chức chính phủ, như đã minh hoạ trên Hình 2.23 và Hình 2.24 trong mục\n\n2.3.4. Các máy tính bot/zombie cũng có thể được sử dụng để gửi thư rác tạo ra khoản tiền\n\nkhông nhỏ cho các nhóm tin tặc/kẻ tấn công, như minh họa trên Hình 2.38.\n\n2.4.2.7. Rootkit\n\n## Rootkit là một dạng phần mềm độc hại gồm một tập các công cụ có mục đích giành\n\nquyền truy nhập vào hệ thống máy tính mà người dùng không có thẩm quyền không thể\n\ntruy nhập. Rootkit thường che giấu mình bằng cách đội lột một phần mềm khác. Rootkit\n\ncó thể được cài đặt tự động, hoặc tin tặc cài đặt rootkit khi chiếm được quyền quản trị hệ\n\nthống. Do rootkit có quyền truy nhập hệ thống ở mức quản trị nên nó có toàn quyền truy\n\nnhập vào các thành phần trong hệ thống và rất khó bị phát hiện.\n\n## Hình 2.38. Mô hình tin tặc sử dụng các máy tính Zombie/Bot để gửi thư rác\n\n---\n\n64\n\n2.4.2.8. Adware và Spyware\n\nAdware (tên đầy đủ là advertising-supported software) là các phần mềm tự động hiển\n\nthị các bảng quảng cáo trong thời gian người dùng tải hoặc sử dụng các phần mềm.\n\nAdware thường được đóng gói chung với các phần mềm khác có thể dưới dạng như một\n\nphần của một phần mềm hoặc một dịch vụ miễn phí. Adware trong một số trường hợp có\n\nthể được coi là một phần mềm độc hại nếu chúng được tự động cài đặt và kích hoạt mà\n\nkhông được sự đồng ý của người dùng.\n\nSpyware là một dạng phần mềm độc hại được cài đặt tự động nhằm giám sát, thu thập\n\nvà đánh cắp các thông tin nhạy cảm trên hệ thống nạn nhân. Có 4 loại spyware thường\n\ngặp, gồm system monitor (giám sát hệ thống), trojan, adware, and tracking cookies (các\n\ncookie theo dõi). Spyware có thể được cài đặt vào hệ thống nạn nhân thông qua nhiều\n\nphương pháp, như tích hợp, đóng gói vào các phần mềm khác, bẫy nạn nhân tự tải và cài\n\nđặt, hoặc tin tặc có thể sử dụng vi rút, sâu để tải và cài đặt. Spyware thường được trang bị\n\nkhả năng ẩn mình nên rất khó có thể phát hiện bằng các phương pháp thông thường.\n\n2.4.3. Phòng chống phần mềm độc hại\n\n2.4.3.1. Nguyên tắc chung\n\nCó thể thấy các phần mềm độc hại là một trong các nguy cơ gây mất an toàn lớn nhất\n\nvà thường trực nhất đối với thông tin, hệ thống và người dùng do sự bùng nổ về số lượng,\n\nmức độ tinh vi ngày càng cao và khả năng phá hoại ngày càng lớn của chúng. Nguyên tắc\n\nchung trong phòng chống phần mềm độc hại vẫn là phòng vệ theo chiều sâu, trong đó\n\nnhiều nhóm biện pháp đảm bảo an toàn cần được áp dụng để phòng ngừa và ngăn chặn\n\nviệc lây nhiễm các phần mềm độc hại vào hệ thống. Có thể liệt kê các biện pháp phòng\n\nchống các phần mềm độc hại theo thứ tự ưu tiên từ cao đến thấp như sau:\n\n(1) Sử dụng các biện pháp kiểm soát truy cập cung cấp bởi tường lửa và hệ điều hành\n\nđể hạn chế giao diện tiếp xúc của hệ thống với mạng ngoài. Chẳng hạn, tường lửa\n\ncó thể chặn các kết nối trái phép từ Internet đến hệ thống máy tính để khai thác các\n\nlỗ hổng, hoặc tải các phần mềm độc hại;\n\n(2) Sử dụng công cụ rà quét và diệt trừ các phần mềm độc hại. Với mỗi hệ thống máy\n\ntính, nhất là các máy trạm và máy tính cá nhân, cần cài đặt một bộ công cụ (và chỉ\n\nnên một tại mỗi thời điểm) rà quét phần mềm độc hại có khả năng bảo vệ hệ thống\n\ntheo thời gian thực. Bộ công cụ này cần được cập nhật thường xuyên để đảm bảo\n\nkhả năng phát hiện và diệt trừ các phần mềm độc hại mới nhất;\n\n(3) Đào tạo và nâng cao ý thức cảnh giác của người dùng về mã độc, phần mềm độc\n\nhại, các chương trình ứng dụng trên máy tính, trên mạng Internet không rõ nguồn\n\ngốc. Việc nâng cao ý thức người dùng đóng vai trò quan trọng trong việc phòng\n\nngừa việc lây lan của các dạng phần mềm độc hại;\n\n(4) Sử dụng các phần mềm có bản quyền. Sử dụng các phần mềm có bản quyền là\n\ncách hiệu quả để hạn chế các loại phần mềm độc hại, như trojan, adware và\n\nspyware thường được tích hợp vào các công cụ phá khoá (cracker) hệ điều hành và\n\ncác phần mềm ứng dụng;\n\n---\n\n65\n\n(5) Thường xuyên cập nhật hệ điều hành và các phần mềm ứng dụng. Việc cập nhật\n\nthường xuyên, nhất là các bản vá an ninh nhằm giảm thiểu các lỗ hổng bảo mật đã\n\nbiết trên hệ thống và nhờ vậy giảm thiểu khả năng bị khai thác bởi các dạng phần\n\nmềm độc hại;\n\n(6) Phân quyền người dùng phù hợp giúp hạn chế khả năng tự động cài đặt các dạng\n\nphần mềm độc hại lên hệ thống. Không sử dụng người dùng có quyền quản trị\n\n(root, hoặc administrator) để thực thi các ứng dụng. Người dùng thông thường chỉ\n\nnên được cấp quyền truy cập vừa đủ để thực thi nhiệm vụ.\n\n2.4.3.2. Các công cụ rà quét phần mềm độc hại\n\nCác công cụ rà quét vi rút và các phần mềm độc hại (Antivirus software) là các phần\n\nmềm có khả năng rà quét, bảo vệ hệ thống khỏi vi rút và các phần mềm độc hại khác theo\n\nthời gian thực. Hầu hết các công cụ này đều cho phép thực hiện 2 chế độ quét: (i) quét\n\nđịnh kỳ từng phần, hoặc toàn bộ hệ thống các file và (ii) bảo vệ hệ thống theo thời gian\n\nthực (Realtime protection). Chúng cho phép giám sát tất cả các thao tác đọc/ghi hệ thống\n\nfile để phát hiện các phần mềm độc hại. Đa số công cụ rà quét vi rút và các phần mềm\n\nđộc hại hoạt động dựa trên một cơ sở dữ liệu các mẫu, hoặc chữ ký của các phần mềm\n\nđộc hại đã biết. Do vậy, để đảm bảo hiệu quả rà quét, cơ sở dữ liệu này phải được cập\n\nnhật thường xuyên. Một số bộ công cụ cho phép quét theo hành vi hoặc heuristics.\n\n## Hình 2.39. Màn hình chính của Microsoft Windows Defender\n\nCó thể liệt kê một số công cụ rà quét vi rút và các phần mềm độc hại thông dụng, như:\n\n- Microsoft Security Essentials (Microsoft Windows 7 trở lên)\n\n- Microsoft Windows Defender (Microsoft Windows 8 trở lên) – Hình 2.39\n\n- Semantec Norton Antivirus\n\n- Kaspersky Antivirus\n\n- BitDefender Antivirus\n\n- AVG Antivirus\n\n---\n\n66\n\n- McAfee VirusScan\n\n- Trend Micro Antivirus\n\n- F-secure Antivirus và\n\n- BKAV Antivirus.\n\n2.5. Câu hỏi ôn tập\n\n1) Điểm yếu hệ thống là gì? Liệt kê các nguyên nhân của sự tồn tại các điểm yếu trong\n\nhệ thống.\n\n2) Lỗ hổng bảo mật là gì? Các lỗ hổng bảo mật thường tồn tại nhiều nhất trong thành\n\nphần nào của hệ thống?\n\n3) Nêu các dạng lỗ hổng bảo mật thường gặp trong hệ điều hành và các phần mềm ứng\n\ndụng.\n\n4) Mối đe dọa (threat) là gì? Nêu quan hệ giữa lỗ hổng và mối đe dọa.\n\n5) Tấn công là gì? Có thể giảm thiểu khả năng bị tấn công bằng cách nào?\n\n6) Mô tả 4 loại tấn công chính và 2 kiểu tấn công chủ động và thụ động.\n\n7) Nêu mục đích và các dạng tấn công vào mật khẩu.\n\n8) Tấn công chèn mã SQL là gì? Nêu các nguyên nhân của lỗ hổng chèn mã SQL. Tấn\n\ncông chèn mã SQL có khả năng cho phép tin tặc thực hiện hành động gì trên hệ thống\n\nnạn nhân?\n\n9) Nêu các biện pháp phòng chống tấn công chèn mã SQL.\n\n10) Vẽ sơ đồ, mô tả cơ chế tấn công SYN Flood và các biện pháp phòng chống.\n\n11) Vẽ sơ đồ, mô tả cơ chế tấn công Smurf và các biện pháp phòng chống.\n\n12) Vẽ sơ đồ và mô tả kịch bản tấn công DDoS trực tiếp và tấn công DDoS gián tiếp.\n\n13) Mô tả cơ chế và các biện pháp phòng chống tấn công người đứng giữa.\n\n14) Đối tượng của tấn công sử dụng các kỹ thuật xã hội là gì? Mô tả kịch bản của Trò lừa\n\nđảo Nigeria 4-1-9.\n\n15) Tấn công pharming là gì? Mô tả các dạng tấn công pharming.\n\n16) Tấn công APT là gì? Mô tả các thuộc tính chính của tấn công APT.\n\n17) Phần mềm độc hại là gì? Phân loại các phần mềm độc hại.\n\n18) Vi rút là gì? Nêu các phương pháp lây nhiễm và các loại vi rút.\n\n19) Trojan là gì? Mô tả cơ chế hoạt động của trojan.\n\n20) Sâu máy tính là gì? Nêu điểm khác biệt cơ bản của sâu và vi rút. Nêu các phương\n\npháp lây lan của sâu.\n\n21) Zombie/Bot là gì? Mô tả cơ chế hoạt động của Zombie/Bot.\n\n22) Nêu nguyên tắc chung trong phòng chống phần mềm độc hại. Tại sao chỉ nên cài đặt\n\nvà chạy một bộ phần mềm quét phần mềm độc hoạt động ở chế độ “bảo vệ theo thời\n\ngian thực” hại tại mỗi thời điểm?\n\n---\n\n67\n\n# CHƯƠNG 3. ĐẢM BẢO AN TOÀN THÔNG TIN\n\n# DỰA TRÊN MÃ HÓA\n\n## Chương 3 giới thiệu các khái niệm cơ bản về mật mã, hệ mã hóa, các phương pháp\n\nmã hóa. Phần tiếp theo của chương trình bày một số giải thuật cơ bản của mã hóa khóa\n\nđối xứng (DES, 3-DES và AES), mã hóa khóa bất đối xứng (RSA), các hàm băm (MD5 và\n\nSHA1), chữ ký số, chứng chỉ số và PKI. Phần cuối của chương đề cập vấn đề quản lý và\n\nphân phối khóa, và một số giao thức đảm bảo an toàn thông tin dựa trên mã hóa.\n\n3.1. Khái quát về mã hóa thông tin và ứng dụng\n\n3.1.1. Các khái niệm\n\n## Mật mã\n\nTheo từ điển Webster's Revised Unabridged Dictionary: “cryptography is the act or\n\nart of writing secret characters”, hay mật mã là một hành động hoặc nghệ thuật viết các\n\nký tự bí mật. Còn theo từ điển Free Online Dictionary of Computing: “cryptography is\n\nencoding data so that it can only be decoded by specific individuals”, có nghĩa là mật mã\n\nlà việc mã hóa dữ liệu mà nó chỉ có thể được giải mã bởi một số người chỉ định.\n\n## Bản rõ, Bản mã, Mã hóa và Giải mã\n\nBản rõ (Plaintext), hay thông tin chưa mã hóa (Unencrypted information) là thông tin\n\nở dạng có thể hiểu được.\n\nBản mã (Ciphertext), hay thông tin đã được mã hóa (Encrypted information) là thông\n\ntin ở dạng đã bị xáo trộn.\n\nMã hóa (Encryption) là hành động xáo trộn (scrambling) bản rõ để chuyển thành bản\n\nmã.\n\n## Giải mã (Decryption) là hành động giải xáo trộn (unscrambling) bản mã để chuyển\n\nthành bản rõ.\n\n## Hình 3.1 mô tả 2 khâu chính của một hệ mã hóa, trong đó khâu Mã hóa chuyển Bản\n\nrõ thành Bản mã sử dụng khoá mã hoá K1 được thực hiện ở phía người gửi và khâu Giải\n\nmã chuyển Bản mã thành Bản rõ sử dụng khoá giải mã K2 được thực hiện ở phía người\n\nnhận. Các khoá K1 và K2 có thể giống nhau hoặc khác nhau. Nếu K1 khác K2 thì chúng\n\ncó quan hệ về mặt toán học với nhau.\n\n## Giải thuật mã hóa & giải mã, Bộ mã hóa, Khóa/Chìa, Không gian khóa\n\nGiải thuật mã hóa (Encryption algorithm) là giải thuật dùng để mã hóa thông tin và\n\ngiải thuật giải mã (Decryption algorithm) dùng để giải mã thông tin.\n\nMột bộ mã hóa (Cipher) gồm một giải thuật để mã hóa và một giải thuật để giải mã\n\nthông tin.\n\n## Khóa/Chìa (Key) là một chuỗi được sử dụng trong giải thuật mã hóa và giải mã.\n\nKhông gian khóa (Keyspace) là tổng số khóa có thể có của một hệ mã hóa. Ví dụ, nếu\n\nsử dụng khóa kích thước 64 bit thì không gian khóa là 264.\n\n---\n\n68\n\n## Hình 3.1. Các khâu Mã hóa và Giải mã của một hệ mã hóa\n\n## Mã hóa khóa đối xứng, Mã hóa khóa bất đối xứng, Hàm băm, Thám mã\n\n## Mã hóa khóa đối xứng (Symmetric key cryptography) là dạng mã hóa trong đó một\n\nkhóa được sử dụng cho cả khâu mã hóa và khâu giải mã. Do khóa sử dụng chung cần\n\nphải được giữ bí mật nên mã hóa khóa đối xứng còn được gọi là mã hóa khóa bí mật\n\n(Secret key cryptography). Hình 3.2 minh họa hoạt động của một hệ mã hóa khóa đối\n\nxứng, trong đó một khóa bí mật duy nhất được sử dụng cho cả hai khâu mã hóa và giải\n\nmã một thông điệp.\n\n## Hình 3.2. Mã hóa khóa đối xứng sử dụng chung 1 khóa bí mật\n\n## Mã hóa khóa bất đối xứng (Asymmetric key cryptography) là dạng mã hóa trong đó\n\nmột cặp khóa được sử dụng: khóa công khai (public key) dùng để mã hóa, khóa riêng\n\n(private key) dùng để giải mã. Chỉ có khóa riêng cần phải giữ bí mật, còn khóa công khai\n\ncó thể phổ biến rộng rãi. Do khóa để mã hóa có thể công khai nên đôi khi mã hóa khóa\n\nbất đối xứng còn được gọi là mã hóa khóa công khai (Public key cryptography). Hình 3.3\n\nminh họa hoạt động của một hệ mã hóa khóa bất đối xứng, trong đó một khóa công khai\n\nđược sử dụng cho khâu mã hóa và khóa riêng cho khâu giải mã thông điệp.\n\nHàm băm (Hash function) là một ánh xạ chuyển các dữ liệu có kích thước thay đổi về\n\ndữ liệu có kích thước cố định. Hình 3.4 minh họa đầu vào (Input) và đầu ra (Digest) của\n\nhàm băm. Trong các loại hàm băm, hàm băm 1 chiều (One-way hash function) là hàm\n\n---\n\n69\n\nbăm, trong đó việc thực hiện mã hóa tương đối đơn giản, còn việc giải mã thường có độ\n\nphức tạp rất lớn, hoặc không khả thi về mặt tính toán.\n\n## Hình 3.3. Mã hóa khóa bất đối xứng sử dụng một cặp khóa\n\n## Hình 3.4. Minh họa đầu vào (Input) và đầu ra (Digest) của hàm băm\n\nThám mã hay phá mã (Cryptanalysis) là quá trình giải mã thông điệp đã bị mã hóa mà\n\nkhông cần có trước thông tin về giải thuật mã hóa và khóa mã. Thám mã ra đời, phát triển\n\nsong hành với mật mã và là công việc đòi hỏi khối lượng tính toán rất lớn, cũng như kinh\n\nnghiệm, tri thức chuyên gia. Nhìn chung, thám mã liên quan đến việc phân tích toán học\n\ncác giải thuật mật mã, khai thác các điểm yếu trong giải thuật và cài đặt các hệ mã hóa\n\nnhằm khôi phục thông điệp gốc và/hoặc khóa mã.\n\n3.1.2. Các thành phần của một hệ mã hóa\n\nMột hệ mã hóa hay hệ mật mã (Cryptosystem) là một bản cài đặt của các kỹ thuật mật\n\nmã và các thành phần có liên quan để cung cấp dịch vụ bảo mật thông tin. Hình 3.5 nêu\n\ncác thành phần của một hệ mã hóa đơn giản dùng để đảm bảo tính bí mật của thông tin từ\n\nngười gửi truyền đến người nhận mà không bị một bên thứ ba nghe lén. Các thành phần\n\ncủa một hệ mã hóa đơn giản gồm bản rõ, giải thuật mã hóa, bản mã, giải thuật giải mã,\n\n---\n\n70\n\nkhóa mã hóa và khóa giải mã. Một thành phần quan trọng khác của một hệ mã hóa là\n\nkhông gian khóa - là tập hợp tất cả các khóa có thể có. Ví dụ, nếu chọn kích thước khóa\n\nlà 64 bit thì không gian khóa sẽ là 264. Nhìn chung, hệ mã hóa có độ an toàn càng cao nếu\n\nkhông gian khóa lựa chọn càng lớn.\n\n## Hình 3.5. Các thành phần của một hệ mã hóa đơn giản\n\n3.1.3. Lịch sử mã hóa\n\nCó thể nói mã hóa hay mật mã là con đẻ của toán học nên sự phát triển của mật mã đi\n\nliền với sự phát triển của toán học. Tuy nhiên, do nhiều giải thuật mật mã đòi hỏi khối\n\nlượng tính toán lớn nên mật mã chỉ thực sự phát triển mạnh cùng với sự ra đời và phát\n\ntriển của máy tính điện tử. Sau đây là một số mốc trong sự phát triển của mật mã và ứng\n\ndụng mật mã:\n\n- Các kỹ thuật mã hoá thô sơ đã được người cổ Ai cập sử dụng cách đây 4000 năm.\n\n- Người cổ Hy lạp, Ấn độ cũng đã sử dụng mã hoá cách đây hàng ngàn năm.\n\n- Các kỹ thuật mã hoá chỉ thực sự phát triển mạnh từ thế kỷ 1800 nhờ công cụ toán\n\nhọc, và phát triển vượt bậc trong thế kỷ 20 nhờ sự phát triển của máy tính và ngành\n\ncông nghệ thông tin.\n\n- Trong chiến tranh thế giới thứ I và II, các kỹ thuật mã hóa được sử dụng rộng rãi\n\ntrong liên lạc quân sự sử dụng sóng vô tuyến. Quân đội các nước đã sử dụng các\n\ncông cụ phá mã, thám mã để giải mã các thông điệp của quân địch.\n\n- Năm 1976 chuẩn mã hóa DES (Data Encryption Standard) được Cơ quan mật vụ\n\n## Mỹ (NSA – National Security Agency) thừa nhận và sử dụng rộng rãi.\n\n- Năm 1976, hai nhà khoa học Whitman Diffie và Martin Hellman đã đưa ra khái\n\nniệm mã hóa khóa bất đối xứng (Asymmetric key cryptography), hay mã hóa khóa\n\ncông khai (Public key cryptography) đưa đến những thay đổi lớn trong kỹ thuật\n\nmật mã. Theo đó, các hệ mã hóa khóa công khai bắt đầu được sử dụng rộng rãi nhờ\n\nkhả năng hỗ trợ trao đổi khóa dễ dàng hơn và do các hệ mã hóa khóa bí mật gặp\n\nkhó khăn trong quản lý và trao đổi khóa, đặc biệt khi số lượng người dùng lớn.\n\n- Năm 1977, ba nhà khoa học Ronald Rivest, Adi Shamir, và Leonard Adleman giới\n\nthiệu giải thuật mã hóa khóa công khai RSA. Từ đó, RSA trở thành giải thuật mã\n\nhóa khóa công khai được sử dụng rộng rãi nhất do RSA có thể vừa được sử dụng\n\nđể mã hóa thông tin và sử dụng trong chữ ký số.\n\n---\n\n71\n\n- Năm 1991, phiên bản đầu tiên của PGP (Pretty Good Privacy) ra đời.\n\n- Năm 2000, chuẩn mã hóa AES (Advanced Encryption Standard) được thừa nhận\n\nvà ứng dụng rộng rãi.\n\n3.1.4. Mã hóa dòng và mã hóa khối\n\n3.1.4.1. Mã hóa dòng\n\nMã hóa dòng hay mã hóa luồng (Stream cipher) là kiểu mã hóa mà từng bit, hoặc ký\n\ntự của bản rõ được kết hợp với từng bit, hoặc ký tự tương ứng của khóa để tạo thành bản\n\nmã. Hình 3.6 biểu diễn quá trình mã hóa và giải mã trong mã hóa dòng. Theo đó, ở bên\n\ngửi các bit Pi của bản rõ được liên tục đưa vào kết hợp với bit tương ứng Ki của khóa để\n\ntạo thành bit mã Ci; Ở bên nhận, bit mã Ci được kết hợp với bit khóa Ci để khôi phục bit\n\nrõ Pi. Một bộ sinh luồng khóa được sử dụng để liên tục sinh các bit khóa Ki từ khóa gốc\n\nK. Các giải thuật mã hóa dòng tiêu biểu như A5, hoặc RC4 được sử dụng rộng rãi trong\n\ntruyền thông, viễn thông.\n\n## Hình 3.6. Mô hình phương pháp mã hóa dòng\n\n3.1.4.2. Mã hóa khối\n\n## Hình 3.7. Mô hình phương pháp mã hóa khối\n\nMã hóa khối (Block cipher) là kiểu mã hóa mà dữ liệu được chia ra thành từng khối\n\ncó kích thước cố định để mã hóa và giải mã. Hình 3.7 biểu diễn quá trình mã hóa và giải\n\nmã trong mã hóa khối. Theo đó, ở bên gửi bản rõ được chia thành các khối có kích thước\n\ncố định, sau đó từng khối được mã hóa để chuyển thành khối mã. Các khối mã được ghép\n\nlại thành bản mã. Ở bên nhận, bản mã lại được chia thành các khối và từng lại được giải\n\nmã để chuyển thành khối rõ. Cuối cùng ghép các khối rõ để có bản rõ hoàn chỉnh. Các\n\ngiải thuật mã hóa khối tiêu biểu như DES, 3-DES, IDEA, AES được sử dụng rất rộng rãi\n\ntrong mã hóa dữ liệu với kích thước khối 64, hoặc 128 bit.\n\n---\n\n72\n\n3.1.5. Ứng dụng của mã hóa\n\n## Mã hoá thông tin có thể được sử dụng để đảm bảo an toàn thông tin với các thuộc\n\ntính: bí mật (confidentiality), toàn vẹn (integrity), xác thực (authentication), không thể\n\nchối bỏ (non-repudiation). Cụ thể, các kỹ thuật mã hóa được ứng dụng rộng rãi trong các\n\nhệ thống, công cụ và dịch vụ bảo mật như:\n\n- Dịch vụ xác thực (Kerberos, SSO, RADIUS,…)\n\n- Kiểm soát truy cập\n\n- Các công cụ cho đảm bảo an toàn cho truyền thông không dây\n\n- Các nền tảng bảo mật như PKI, PGP\n\n- Các giao thức bảo mật như SSL/TLS, SSH, SET, IPSec\n\n- Các hệ thống bảo mật kênh truyền, như VPN\n\n- Các công nghệ và ứng dụng dựa trên mật mã, như công nghệ khối chuỗi\n\n(Blockchain), tiền kỹ thuật số (Bitcoin, Ethereum,...).\n\n3.2. Các phương pháp mã hóa\n\n## Phương pháp mã hóa là phương pháp xáo trộn dữ liệu để tạo bản mã từ bản rõ. Các\n\nphương pháp mã hóa cổ điển thường phải giữ bí mật phương pháp xáo trộn dữ liệu.\n\nNgược lại, các phương pháp mã hóa hiện đại thường không giữ bí mật phương pháp xáo\n\ntrộn dữ liệu, nhưng giữ bí mật khóa mã. Mục này mô tả một số phương pháp mã hóa cổ\n\nđiển và hiện đại đã và đang được sử dụng, bao gồm phương pháp thay thế, phương pháp\n\nhoán vị, phương pháp XOR, phương pháp Vernam, phương pháp sách hoặc khóa chạy và\n\nphương pháp hàm băm. Phần tiếp theo của mục này trình bày chi tiết các phương pháp\n\nmã hóa kể trên.\n\n3.2.1. Phương pháp thay thế\n\nPhương pháp thay thế (Substitution) là phương pháp thay thế một giá trị này bằng một\n\ngiá trị khác, như thay một ký tự bằng một ký tự khác, hoặc thay một bit bằng một bit\n\nkhác. Hình 3.8 biểu diễn bộ chữ gốc, bộ chữ mã và ví dụ mã hóa sử dụng hệ mã hóa nổi\n\ntiếng thời La Mã là Caesar cipher.  Nguyên tắc của Caesar cipher là dịch 3 chữ trong bộ\n\nký tự tiếng Anh sang bên phải (A→D, B→E, C→F,….). Bản rõ “LOVE” được mã hóa\n\nthành “ORYH”.\n\n## Hình 3.8. Mã hóa bằng hệ mã hóa Caesar cipher\n\nĐể tăng độ an toàn của phương pháp thay thế, người ta có thể sử dụng nhiều bộ chữ\n\nmã, như minh họa trên Hình 3.9 với 4 bộ chữ mã (Substitution cipher), với nguyên tắc\n\nthay thế: ký tự số 1 ở bản rõ thay thế sử dụng bộ chữ mã số 1, ký tự số 2 sử dụng bộ chữ\n\nmã số 2,…, ký tự số 5 sử dụng bộ chữ mã số 1, ký tự số 6 sử dụng bộ chữ mã số 2,…\n\nNếu các bộ chữ mã được sắp đặt ngẫu nhiên thì một ký tự xuất hiện ở các vị trí khác nhau\n\n---\n\n73\n\ntrong bản rõ sẽ được chuyển đổi thành các ký tự khác nhau trong bản mã. Điều này giúp\n\ntăng độ an toàn do làm tăng độ khó trong việc phân tích đoán bản rõ từ bản mã.\n\n## Hình 3.9. Phương pháp thay thế với 4 bộ chữ mã\n\n3.2.2. Phương pháp hoán vị\n\nPhương pháp hoán vị, hoặc đổi chỗ (permutation) thực hiện sắp xếp lại các giá trị\n\ntrong một khối bản rõ để tạo bản mã. Thao tác hoán vị có thể thực hiện với từng bit hoặc\n\ntừng byte (ký tự). Hình 3.10 minh họa ví dụ mã hóa bằng phương pháp hoán vị thực hiện\n\nđổi chỗ các bit, trong đó việc đổi chỗ được thực hiện theo khóa trong khối 8 bit, tính từ\n\nbên phải. Hình 3.11 minh họa ví dụ mã hóa bằng phương pháp hoán vị thực hiện đổi chỗ\n\ncác ký tự, trong đó việc đổi chỗ được thực hiện theo khóa trong khối 8 ký tự, tính từ bên\n\nphải. Với bản rõ “SACKGAULSPARENOONE” ta có 3 khối, 2 khối đầu đủ 8 ký tự, còn\n\nkhối cuối chỉ có 2 ký tự “NE” nên phải chèn thêm dấu trắng cho đủ khối 8 ký tự.\n\n## Hình 3.10. Phương pháp hoán vị thực hiện đổi chỗ các bit\n\n## Hình 3.11. Phương pháp hoán vị thực hiện đổi chỗ các ký tự\n\n3.2.3. Phương pháp XOR\n\n## Hình 3.12. Ví dụ mã hóa bằng phương pháp XOR\n\n## Phương pháp mã hóa XOR sử dụng phép toán logic XOR để tạo bản mã, trong đó\n\ntừng bit của bản rõ được XOR với bit tương ứng của khóa. Để giải mã, ta thực hiện XOR\n\ntừng bit của bản mã với bit tương ứng của khóa. Hình 3.12 minh họa quá trình mã hóa\n\n---\n\n74\n\nbản rõ “CAT” với khóa “VVV”. Theo đó, các ký tự của bản rõ và khóa được chuyển\n\nthành mã ASCII và biểu diễn dưới dạng nhị phân. Sau đó, thực hiện phép toán XOR trên\n\ncác bit tương ứng của bản rõ và khóa để tạo bản mã.\n\n3.2.4. Phương pháp Vernam\n\n## Phương pháp Vernam sử dụng một tập ký tự để nối vào các ký tự của bản rõ để tạo\n\nbản mã. Tập ký tự này được gọi là one-time pad và mỗi ký tự trong tập chỉ dùng 1 lần\n\ntrong một tiến trình mã hóa. Với bộ chữ tiếng Anh có 26 chữ, mã hóa bằng phương pháp\n\n## Vernam được thực hiện như sau:\n\n- Các ký tự của bản rõ và các ký tự của tập nối thêm (one-time pad) được chuyển\n\nthành số trong khoảng 1-26;\n\n- Cộng giá trị của ký tự trong bản rõ với giá trị tương ứng trong tập nối thêm;\n\n- Nếu giá trị cộng lớn hơn 26 thì đem trừ cho 26 (đây chính là phép modulo – chia\n\nlấy phần dư).\n\n- Chuyển giá trị số thành ký tự mã.\n\n## Hình 3.13 minh họa mã hóa bản rõ “SACKGAULSPARENOONE” bằng phương\n\npháp Vernam với tập nối thêm “FPQRNSBIEHTZLACDGJ”.\n\n## Hình 3.13. Mã hóa bằng phương pháp Vernam\n\n3.2.5. Phương pháp sách hoặc khóa chạy\n\n## Phương pháp sách, hoặc khóa chạy thực hiện việc mã hóa và giải mã sử dụng các\n\nkhóa mã chứa trong các cuốn sách. Hiện nay phương pháp này thường được dùng trong\n\ncác bộ phim trinh thám do tính chất kỳ bí của nó. Ví dụ như, với bản mã “259,19,8;\n\n22,3,8; 375,7,4; 394,17,2” và cuốn sách được dùng chứa khóa là “A Fire Up on the\n\n## Deep”, ta có thể giải mã như sau:\n\n- Trang 259, dòng 19, từ thứ 8 là sack\n\n- Trang 22, dòng 3, từ thứ 8 là island\n\n- Trang 375, dòng 7, từ thứ 4 là sharp\n\n- Trang 394, dòng 17, từ thứ 2 là path\n\n## Bản rõ tương ứng của bản mã “259,19,8;22,3,8;375,7,4;394,17,2” là “sack island\n\nsharp path”.\n\n3.2.6. Phương pháp hàm băm\n\nCác hàm băm (Hash functions) là các giải thuật để tạo các bản tóm tắt (digest) của\n\nthông điệp, thường được sử dụng để nhận dạng và đảm bảo tính toàn vẹn của thông điệp.\n\n---\n\n75\n\nĐộ dài của thông điệp đầu vào là bất kỳ, nhưng đầu ra hàm băm thường có độ dài cố\n\nđịnh. Chi tiết về các hàm băm được ở mục 3.3.3. Các hàm băm thông dụng gồm:\n\n- Các hàm băm MD2, MD4, MD5 với độ dài chuỗi đầu ra là 128 bit;\n\n- Hàm băm MD6 cho chuỗi đầu ra có độ dài trong khoảng 0 đến 512 bit;\n\n- Các hàm băm SHA0, SHA1 với độ dài chuỗi đầu ra là 160 bit;\n\n- Các hàm băm SHA2, gồm SHA256, SHA384, SHA512 cho phép một số lựa chọn\n\nchuỗi đầu ra tương ứng 256, 384 và 512 bit;\n\n- Hàm băm SHA3 cho chuỗi đầu ra có độ dài trong khoảng 0 đến 512 bit;\n\n- Hàm băm CRC32 với chuỗi đầu ra 32 bit sử dụng trong kiểm tra dư thừa mạch\n\nvòng.\n\n3.3. Các giải thuật mã hóa\n\nCác giải thuật mã hóa là các giải thuật cho phép đảm bảo tính bí mật của thông tin lưu\n\ntrữ, hoặc thông điệp truyền đưa bằng cách chuyển đổi thông điệp bản rõ thành bản mã ở\n\nbên người gửi và khôi phục bản rõ ban đầu từ bản mã ở bên người nhận. Mục này tập\n\ntrung trình bày hai nhóm giải thuật mã hóa được sử dụng phổ biến, bao gồm:\n\n-\n\n## Các giải thuật mã hóa khóa đối xứng với các đại diện là DES, 3-DES và AES, và\n\n-\n\n## Các giải thuật mã hóa khóa bất đối xứng với đại diện tiêu biểu là RSA.\n\n3.3.1. Các giải thuật mã hóa khóa đối xứng\n\n3.3.1.1. Khái quát\n\n## Mã hóa khóa đối xứng hay thường gọi là mã hóa khóa bí mật sử dụng một khóa bí\n\nmật duy nhất cho cả quá trình mã hóa và giải mã. Khóa bí mật được sử dụng trong quá\n\ntrình mã hóa và giải mã còn được gọi là khóa chung, hay khóa chia sẻ (Shared key).\n\nKhóa bí mật dùng chung cần được bên gửi và bên nhận chia sẻ một cách an toàn trước\n\nkhi có thể thực hiện việc mã hóa và giải mã các thông điệp. Hình 3.2, mục 3.1 đã mô tả\n\nhoạt động của một hệ mã hóa bất đối xứng, trong đó một khóa bí mật chia sẻ được sử\n\ndụng cho cả quá trình mã hóa và giải mã.\n\n## Các hệ mã hóa khóa đối xứng thường sử dụng khóa với kích thước tương đối ngắn.\n\nMột số kích thước khóa được sử dụng phổ biến là 64, 128, 192 và 256 bit. Do sự phát\n\ntriển nhanh về tốc độ tính toán của máy tính, nên các khóa có kích thước nhỏ hơn 128 bit\n\nđược xem là không an toàn và hầu hết các hệ mã hóa khóa đối xứng đảm bảo an toàn\n\nhiện tại sử dụng khóa có kích thước từ 128 bit trở lên. Ưu điểm nổi bật của các hệ mã hóa\n\nkhóa đối xứng là có độ an toàn cao và tốc độ thực thi nhanh. Tuy nhiên, nhược điểm lớn\n\nnhất của các hệ mã hóa khóa đối xứng là việc quản lý và phân phối khóa rất khó khăn,\n\nđặc biệt là trong các môi trường mở như mạng Internet do các bên tham gia phiên truyền\n\nthông cần thực hiện việc trao đổi các khóa bí mật một cách an toàn trước khi có thể sử\n\ndụng chúng để mã hóa và giải mã các thông điệp trao đổi.\n\nMột số hệ mã hóa khóa đối xứng tiêu biểu, gồm DES (Data Encryption Standard), 3-\n\n## DES (Triple-DES), AES (Advanced Encryption Standard), IDEA (International Data\n\nEncryption Algorithm), Blowfish, Twofish, RC4 và RC5. Phần tiếp theo của mục này là\n\n---\n\n76\n\nmô tả các giải thuật mã hóa DES, 3-DES và AES do chúng là các giải thuật đã và đang\n\nđược sử dụng rộng rãi nhất trên thực tế.\n\n3.3.1.2. Giải thuật mã hóa DES\n\na. Giới thiệu\n\nDES (Data Encryption Standard) được phát triển tại IBM với tên gọi Lucifer vào đầu\n\nnhững năm 1970 và được chấp nhận là chuẩn mã hóa ở Mỹ vào năm 1977. DES được sử\n\ndụng rộng rãi trong những năm 1970 và 1980. DES là dạng mã hóa khối với khối dữ liệu\n\nvào kích thước 64 bit và khóa 64 bit, trong đó thực sử dụng 56 bit (còn gọi là kích thước\n\nhiệu dụng của khóa) và 8 bit dùng cho kiểm tra chẵn lẻ.\n\n## Một ưu điểm của DES là sử dụng chung một giải thuật cho cả khâu mã hóa và khâu\n\ngiải mã, như minh họa trên Hình 3.14, trong đó P là khối bản rõ 64 bit, K là khóa với\n\nkích thước hiệu dụng 56 bit, C là khối bản mã 64 bit, DES biểu diễn khâu mã hóa và\n\nDES-1 biểu diễn khâu giải mã. Hiện nay DES được coi là không an toàn do nó có không\n\ngian khóa nhỏ, dễ bị vét cạn và tốc độ tính toán của các hệ thống máy tính ngày càng\n\nnhanh trong những năm gần đây.\n\n## Hình 3.14. Các khâu mã hóa và giải mã của DES\n\nb. Thủ tục sinh khoá phụ\n\n## DES sử dụng một thủ tục sinh 16 khóa phụ từ khóa chính để sử dụng trong 16 vòng\n\nlặp hàm Feistel. Hình 3.15 minh họa thủ tục sinh 16 khóa phụ từ khóa chính của DES.\n\n## Các bước xử lý chính của thủ tục sinh khóa phụ như sau:\n\n- 56 bit khóa được chọn từ khóa gốc 64 bit bởi PC1 (Permuted Choice 1). 8 bit còn\n\nlại được hủy hoặc dùng để kiểm tra chẵn lẻ;\n\n- 56 bit được chia thành 2 phần 28 bit, mỗi phần được xử lý riêng;\n\n- Mỗi phần được quay trái 1 hoặc 2 bit;\n\n- Hai phần được ghép lại và 48 bit được chọn làm khóa phụ 1 (Subkey 1) bởi PC2;\n\n- Lặp lại bước trên để tạo 15 khóa phụ còn lại.\n\nc. Mã hoá khối bản rõ\n\nVới mỗi khối dữ liệu đầu vào 64 bit, DES thực hiện 3 bước xử lý như minh họa trên\n\n## Hình 3.16 để chuyển nó thành khối mã 64 bit tương ứng. Các bước cụ thể gồm:\n\n- Bước 1: Hoán vị khởi tạo (IP – Initial Permutation);\n\n- Bước 2: 16 vòng lặp chính thực hiện xáo trộn dữ liệu sử dụng hàm Feistel (F). Sau\n\nmỗi vòng lặp, các kết quả trung gian được kết hợp lại sử dụng phép  (XOR);\n\n- Bước 3: Hoán vị kết thúc (FP – Final Permutation).\n\n---\n\n77\n\n## Hình 3.15. Thủ tục sinh các khóa phụ từ khóa chính của DES\n\n## Hình 3.16. Các bước xử lý chuyển khối rõ 64 bit thành khối mã 64 bit của DES\n\n---\n\n78\n\nHàm Feistel (F) là hạt nhân trong các vòng lặp xử lý dữ liệu của DES. Trước hết, khối\n\n64 bit được chia thành 2 khối 32 bit và được xử lý lần lượt. Hàm Feistel được thực hiện\n\ntrên một khối dữ liệu 32 bit gồm 4 bước xử lý như minh họa trên Hình 3.17. Cụ thể, các\n\nbước xử lý của DES trên mỗi khối 32 bit (Half Block 32 bits) như sau:\n\n- E (Expansion): thực hiện mở rộng 32 bit khối đầu vào thành 48 bit bằng cách nhân\n\nđôi một nửa số bit.\n\n- : Trộn khối 48 bit kết quả ở bước E với khóa phụ 48 bit. Có 16 khóa phụ\n\n(Subkey) được tạo từ khóa chính để sử dụng cho 16 vòng lặp.\n\n- Si (Substitution): Khối dữ liệu 48 bit được chia thành 8 khối 6 bit và được chuyển\n\ncho các bộ thay thế (S1-S8). Mỗi bộ thay thế Si sử dụng phép chuyển đổi phi tuyến\n\ntính để chuyển 6 bit đầu vào thành 4 bit đầu ra theo bảng tham chiếu. Các bộ thay\n\nthế là thành phần nhân an ninh (Security core) của DES.\n\n- P (Permutation): khối 32 bit đầu ra từ các bộ thay thế được sắp xếp bằng phép\n\nhoán vị cố định (Fixed permutation) cho ra đầu ra 32 bit.\n\n## Hình 3.17. Các bước xử lý của hàm Feistel (F)\n\nd. Giải mã khối bản mã\n\nNhư đã đề cập, giải thuật DES có thể sử dụng cho cả khâu mã hóa và giải mã. Trong\n\nkhâu giải mã các bước xử lý tương tự khâu mã hóa. Tuy nhiên, các khóa phụ sử dụng cho\n\ncác vòng lặp được sử dụng theo trật tự ngược lại: khóa phụ số 16, 15,…, 2, 1 được sử\n\ndụng cho các vòng lặp số 1, 2,…, 15, 16 tương ứng.\n\n# 3.3.1.3. 3-DES\n\n3-DES hay Triple DES có tên đầy đủ là Triple Data Encryption Algorithm (TDEA)\n\nđược phát triển từ giải thuật DES bằng cách áp dụng DES 3 lần cho mỗi khối dữ liệu đầu\n\nvào 64 bit. 3-DES sử dụng một bộ gồm 3 khóa DES: K1, K2, K3, trong đó mỗi khóa kích\n\nthước hiệu dụng là 56 bit. 3-DES cho phép lựa chọn các bộ khóa:\n\n- Lựa chọn 1: cả 3 khóa độc lập, với tổng kích thước bộ khóa là 168 bit;\n\n- Lựa chọn 2: K1 và K2 độc lập, K3 = K1, với tổng kích thước bộ khóa là 112 bit;\n\n---\n\n79\n\n- Lựa chọn 3: 3 khóa giống nhau, K1 = K2 = K3, với tổng kích thước bộ khóa là 56\n\nbit.\n\nHình 3.18 biểu diễn quá trình mã hóa và giải mã với giải thuật 3-DES, trong đó khâu\n\nmã hóa được ký hiệu là E và khâu giải mã được ký hiệu là D. Theo đó, ở bên gửi bản rõ\n\n(Plaintext) được mã hóa bằng khóa K1, giải mã bằng khóa K2 và mã hóa bằng khóa K3\n\nđể cho ra bản mã (Ciphertext). Ở bên nhận, quá trình giải mã bắt đầu bằng việc giải mã\n\nbằng khóa K3, sau đó mã hóa bằng khóa K2 và cuối cùng giải mã bằng khóa K1 để khôi\n\nphục bản rõ. Ưu điểm của 3-DES là nâng cao được độ an toàn nhờ tăng kích thước khóa.\n\nTuy nhiên, nhược điểm chính của 3-DES là tốc độ thực thi chậm do phải thực hiện DES\n\nlặp 3 lần cho mỗi khâu mã hóa và giải mã.\n\n## Hình 3.18. Mã hóa và giải mã với giải thuật 3-DES\n\n3.3.1.4. Giải thuật mã hóa AES\n\na. Giới thiệu\n\n## AES (Advanced Encryption Standard) là một chuẩn mã hóa dữ liệu được Viện Tiêu\n\nchuẩn và Công nghệ Mỹ (NIST) công nhận năm 2001. AES được xây dựng dựa trên\n\nRijndael cipher phát triển và công bố năm 1998 bởi 2 nhà mật mã học người Bỉ là Joan\n\n## Daemen và Vincent Rijmen. AES là dạng mã hóa khối, với khối dữ liệu vào có kích\n\nthước là 128 bit và khóa bí mật với kích thước có thể là 128, 192, hoặc 256 bit. AES\n\nđược thiết kế dựa trên mạng hoán vị-thay thế (Substitution-permutation network) và nó\n\ncó thể cho tốc độ thực thi cao khi cài đặt bằng cả phần mềm và phần cứng. Đặc biệt, giải\n\nthuật AES đã được tích hợp vào các bộ vi xử lý gần đây của hãng Intel dưới dạng tập\n\nlệnh AES-NI, giúp tăng đáng kể tốc độ thực thi các thao tác mã hóa và giải mã dựa trên\n\n# AES.\n\nAES vận hành dựa trên một ma trận vuông 4x4, được gọi là state (trạng thái). Ma trận\n\nnày gồm 16 phần tử, mỗi phần tử là 1 byte dữ liệu. State được khởi trị là khối 128 bit bản\n\nrõ và qua quá trình biến đổi sẽ chứa khối 128 bit bản mã ở đầu ra. Như đã đề cập, AES\n\nhỗ trợ 3 kích thước khóa và kích thước của khóa quyết định số vòng lặp chuyển đổi cần\n\nthực hiện để chuyển bản rõ thành bản mã như sau:\n\n- 10 vòng lặp với khóa 128 bit;\n\n---\n\n80\n\n- 12 vòng lặp với khóa 192 bit;\n\n- 14 vòng lặp với khóa 256 bit.\n\nb. Quá trình mã hóa\n\nGiải thuật AES cho mã hóa dữ liệu, như minh họa trên Hình 3.19, gồm các bước xử lý\n\nchính như sau:\n\n- Mở rộng khóa (Key Expansion): các khóa vòng (Round key) dùng trong các vòng\n\nlặp được sinh ra từ khóa chính AES sử dụng thủ tục sinh khóa Rijndael.\n\n## Hình 3.19. Các bước xử lý mã hóa dữ liệu của AES\n\n- Vòng khởi tạo (Initial Round): Thực hiện hàm AddRoundKey, trong đó mỗi byte\n\ntrong state được kết hợp với khóa vòng sử dụng phép XOR.\n\n- Các vòng lặp chính (Rounds): Có 4 hàm biến đổi dữ liệu được thực hiện trong mỗi\n\nvòng, gồm:\n\n+ SubBytes: hàm thay thế phi tuyến tính, trong đó mỗi byte trong state được thay\n\nthế bằng một byte khác sử dụng bảng tham chiếu S-box;\n\n+ ShiftRows: hàm đổi chỗ, trong đó mỗi dòng trong state được dịch một số bước\n\ntheo chu kỳ;\n\n+ MixColumns: trộn các cột trong state, kết hợp 4 bytes trong mỗi cột.\n\n+ AddRoundKey.\n\n---\n\n81\n\n- Vòng cuối (Final Round): Tương tự các vòng lặp chính, nhưng chỉ thực hiện 3 hàm\n\nbiến đổi dữ liệu, gồm:\n\n+ SubBytes;\n\n+ ShiftRows;\n\n+ AddRoundKey.\n\nc. Mở rộng khóa\n\n## Hình 3.20. Thủ tục sinh khóa Rijndael\n\n## Khâu mở rộng khóa AES sử dụng thủ tục sinh khóa Rijndael để sinh các khóa vòng\n\n(Round key) cho các vòng lặp xử lý như biểu diễn trên Hình 3.20. Thủ tục Rijndael nhận\n\nđầu vào là khóa chính AES (cipher key) và xuất ra một khóa vòng (Subkey/Round key)\n\nsau mỗi vòng lặp. Một vòng lặp của thủ tục Rijndael gồm các khâu:\n\n- Rotword: quay trái 8 bit từng từ 32 bit từ khóa gốc;\n\n- SubBytes: thực hiện phép thay thế sử dụng bảng tham chiếu S-box.\n\n- Rcon: tính toán giá trị Rcon(i) = x(i-1) mod x8 + x4 + x3 + x + 1\n\n- ShiftRow: thực hiện đổi chỗ tương tự hàm ShiftRows của AES.\n\nd. Các hàm xử lý chính\n\nHàm SubBytes: Mỗi byte trong ma trận state được thay thế bởi 1 byte trong Rijndael\n\nS-box, hay bij = S(aij) như minh họa trên Hình 3.21. S-box là một bảng tham chiếu phi\n\ntuyến tính, được tạo ra bằng phép nhân nghịch đảo một số cho trước trong trường GF(28).\n\nNếu như trong khâu mã hóa S-box được sử dụng thì bảng S-box đảo được sử dụng trong\n\nkhâu giải mã.\n\n## Hàm ShiftRows: Các dòng của ma trận state được dịch theo chu kỳ sang trái theo\n\nnguyên tắc: hàng số 0 giữ nguyên, hàng số 1 dịch 1 byte sang trái, hàng số 2 dịch 2 byte\n\nvà hàng số 3 dịch 3 byte, như minh họa trên Hình 3.22.\n\n---\n\n82\n\n## Hàm MixColumns: Mỗi cột của ma trận state được nhân với một đa thức c(x), như\n\nminh họa trên Hình 3.23. Đa thức c(x) = 3x3 + x2 + x +2.\n\n## Hàm AddRoundKey: Mỗi byte của ma trận state được kết hợp với một byte tương ứng\n\ncủa khóa vòng sử dụng phép  (XOR), như minh họa trên Hình 3.24.\n\n## Hình 3.21. Hàm SubBytes sử dụng Rijndael S-box\n\n## Hình 3.22. Hàm ShiftRows\n\n## Hình 3.23. Hàm MixColumns\n\n## Hình 3.24. Hàm AddRoundKey\n\n---\n\n83\n\ne. Quá trình giải mã\n\n## Hình 3.25. Quá trình mã hóa và giải mã trong AES\n\n## Khâu giải mã trong AES cũng gồm các bước xử lý tương tự như khâu mã hóa. Hình\n\n3.25 biểu diễn quá trình mã hóa và giải mã trong AES. Theo đó, ngoài bước Mở rộng\n\nkhóa, quá trình giải mã gồm Vòng khởi tạo (AddRoundKey), Các vòng lặp chính\n\n(Decryption round) và Vòng cuối (Last round) để chuyển khối mã thành khối rõ. Điểm\n\nkhác biệt chính của khâu giải mã so với khâu mã hóa là các hàm đảo được sử dụng, như\n\ncác hàm đảo InvSubBytes, InvShiftRows và InvMixColumns tương ứng thay cho các\n\nhàm SubBytes, ShiftRows và MixColumns.\n\n3.3.2. Các giải thuật mã hóa khóa bất đối xứng\n\n3.3.2.1. Khái quát\n\n## Mã hóa khóa bất đối xứng, đôi khi được gọi là mã hóa khóa công khai sử dụng một\n\ncặp khóa cho quá trình mã hóa và giải mã. Trong cặp khóa, khóa công khai được sử dụng\n\ncho mã hóa và khóa riêng được sử dụng cho giải mã. Chỉ khóa riêng cần giữ bí mật, còn\n\nkhóa công khai có thể phổ biến rộng rãi, nhưng phải đảm bảo tính toàn vẹn và xác thực\n\nchủ thể của khóa. Hình 3.3, mục 3.1 đã mô tả hoạt động của một hệ mã hóa khóa bất đối\n\nxứng, trong đó một cặp khóa, gồm khóa công khai và khóa riêng tương ứng được sử dụng\n\ncho quá trình mã hóa và giải mã.\n\nĐặc điểm nổi bật của các hệ mã hóa khóa bất đối xứng là kích thước khóa lớn, lên đến\n\nhàng ngàn bit. Do vậy, các hệ mã hóa dạng này thường có tốc độ thực thi chậm hơn nhiều\n\nlần so với các hệ mã hóa khóa đối xứng với độ an toàn tương đương. Mặc dù vậy, các hệ\n\nmã hóa khóa bất đối xứng có khả năng đạt độ an toàn cao và ưu điểm nổi bật nhất là việc\n\nquản lý và phân phối khóa đơn giản hơn do khóa công khai có thể phân phối rộng rãi.\n\n---\n\n84\n\nCác giải thuật mã hóa khóa bất đối xứng điển hình bao gồm: RSA, Rabin, ElGamal,\n\nMcEliece và Knapsack. Trong mục tiếp theo chúng ta tìm hiểu về giải thuật mã hóa RSA\n\n– một trong các giải thuật mã hóa khóa đối xứng được sử dụng rộng rãi nhất trên thực tế.\n\n3.3.2.2. Giải thuật mã hóa RSA\n\na. Giới thiệu\n\n## Giải thuật mã hóa RSA được 3 nhà khoa học người Mỹ là R. Rivest, A. Shamir và\n\nL. Adleman phát minh năm 1977, và tên giải thuật RSA lấy theo chữ cái đầu của tên 3\n\nđồng tác giả. Độ an toàn của RSA dựa trên tính khó của việc phân tích số nguyên rất lớn,\n\nvới độ lớn cỡ hàng trăm chữ số thập phân. Giải thuật RSA sử dụng một cặp khóa, trong\n\nđó khóa công khai dùng để mã hóa và khóa riêng dùng để giải mã. Chỉ khóa riêng RSA\n\ncần giữ bí mật. Khóa công khai có thể công bố rộng rãi. Hiện nay, các khóa RSA có kích\n\nthước nhỏ hơn 1024 bit được coi là không an toàn do tốc độ các hệ thống máy tính tăng\n\nnhanh. Để đảm bảo an toàn, khuyến nghị sử dụng khóa 2048 bit trong giai đoạn 2010-\n\n2020. Trong tương lai, cần sử dụng khóa RSA có kích thước lớn hơn, chẳng hạn 3072 bit.\n\nb. Sinh khóa\n\n## RSA cung cấp một thủ tục sinh cặp khóa (khóa công khai và khóa riêng) tương đối\n\nđơn giản. Cụ thể, thủ tục sinh khóa gồm các bước như sau:\n\n- Tạo 2 số nguyên tố p và q;\n\n- Tính modulo n = p × q\n\n- Tính (n) = (p-1) × (q-1)\n\n- Chọn số e sao cho  1 < e < (n) và gcd(e, (n)) = 1, trong đó hàm gcd() tính ước\n\nsố chung lớn nhất của 2 số nguyên. Do gcd(e, (n)) = 1 nên e và (n) là 2 số\n\nnguyên tố cùng nhau.\n\n- Chọn số d sao cho  d  e-1 mod (n),\n\nhoặc (d × e) mod (n) = 1\n\nhay d là modulo nghịch đảo của e.\n\n- Ta có (n, e) là khóa công khai, (n, d) là khóa riêng và n còn được gọi là modulo.\n\nc. Mã hóa và giải mã\n\n- Mã hóa\n\n+ Thông điệp bản rõ m đã được chuyển thành số, với m < n. Nếu thông điệp bản\n\nrõ m có kích thước lớn thì được chia thành các khối mi, với mi < n.\n\n+ Bản mã c = me mod n\n\n- Giải mã\n\n+ Bản mã c, với c < n\n\n+ Bản rõ m = cd mod n\n\nd. Ví dụ\n\n- Sinh khóa:\n\n+ Chọn 2 số nguyên tố p = 3 và q = 11\n\n---\n\n85\n\n+ Tính n = p × q = 3 × 11 = 33\n\n+ Tính (n) = (p-1) × (q-1) = 2 × 10 = 20\n\n+ Chọn số e sao cho 1 < e < 20, và e và (n) là số nguyên tố cùng nhau ((n)\n\nkhông chia hết cho e). Chọn e = 7\n\n+ Tính (d x e) mod (n) → (d × 7) mod 20 = 1\n\nd = (20 × k +1)/7 → d = 3  (k=1)\n\n+ Ta có: khóa công khai là (33, 7) và khóa riêng là (33, 3)\n\n- Mã hóa:\n\n+ Với bản rõ m = 6,\n\n+ c = me mod n = 67 mod 33 = 279936 mod 33 = 30\n\n+ Vậy bản mã c = 30\n\n- Giải mã:\n\n+ Với bản mã c = 30\n\n+ m =  cd mod n = 303 mod 33 = 27000 mod 33 = 6\n\n+ Vậy bản rõ m = 6.\n\ne. Một số yêu cầu với quá trình sinh khóa\n\nDưới đây liệt kê các yêu cầu đặt ra với các tham số sinh khóa và khóa để đảm bảo sự\n\nan toàn cho cặp khóa RSA. Các yêu cầu cụ thể gồm:\n\n- Yêu cầu với các tham số sinh khóa p và q:\n\n+ Các số nguyên tố p và q phải được chọn sao cho việc phân tích n (n = p × q) là\n\nkhông khả thi về mặt tính toán. p và q nên có cùng độ lớn (tính bằng bit) và phải\n\nlà các số đủ lớn. Nếu n có kích thước 2048 bit thì p và q nên có kích thước\n\nkhoảng 1024 bit.\n\n+ Hiệu số p – q không nên quá nhỏ, do nếu p – q quá nhỏ, tức p  q và p  √𝑛.\n\n## Như vậy, có thể chọn các số nguyên tố ở gần √𝑛 và thử. Khi có được p, có thể\n\ntính q và tìm ra d là khóa bí mật từ khóa công khai e và (n) = (p - 1)(q - 1).\n\n## Nếu p và q được chọn ngẫu nhiên và p – q đủ lớn, khả năng hai số này bị phân\n\ntích từ n giảm đi.\n\n- Vấn đề sử dụng số mũ mã hóa (e) nhỏ: Khi sử dụng số mũ mã hóa (e) nhỏ, chẳng\n\nhạn\n\ne = 3 có thể tăng tốc độ mã hóa. Kẻ tấn công có thể nghe lén và lấy được bản mã,\n\ntừ đó phân tích bản mã để khôi phục bản rõ. Do số mũ mã hóa nhỏ nên chi phí cho\n\nphân tích, hoặc vét cạn không quá lớn. Do vậy, nên sử dụng số mũ mã hóa e đủ lớn\n\nvà thêm chuỗi ngẫu nhiên vào khối rõ trước khi mã hóa để giảm khả năng bị vét\n\ncạn hoặc phân tích bản mã.\n\n- Vấn đề sử dụng số mũ giải mã (d) nhỏ: Khi sử dụng số mũ giải mã (d) nhỏ, có thể\n\ntăng tốc độ giải mã. Nếu d nhỏ và gcd(p-1, q-1) cũng nhỏ thì d có thể tính được\n\n---\n\n86\n\ntương đối dễ dàng từ khóa công khai (n, e). Do vậy, để đảm bảo an toàn, nên sử\n\ndụng số mũ giải mã d đủ lớn.\n\n3.3.3. Các hàm băm\n\nTheo định nghĩa trong mục 3.1.1, hàm băm là một ánh xạ chuyển đổi dữ liệu đầu vào\n\ncó kích thước thay đổi sang dữ liệu đầu ra có kích thước cố định. Hầu hết các hàm băm\n\nđều hỗ trợ độ dài thông điệp đầu vào rất lớn, đến 264 bit, hoặc thậm chí đến 2128 bit, nên\n\ncó thể coi độ dài thông điệp đầu vào của hàm băm là bất kỳ. Do chuỗi băm đầu ra thường\n\ncó kích thước cố định và nhỏ hơn nhiều lần so với thông điệp đầu vào, nó thường được\n\ngọi là chuỗi đại diện, hay bản tóm lược (digest) của thông điệp. Mục này giới thiệu các\n\ntính chất cơ bản của hàm băm, phân loại các hàm băm, mô hình xử lý dữ liệu và mô tả\n\nmột số hàm băm thông dụng gồm MD5 và SHA1.\n\n3.3.3.1. Khái quát về hàm băm\n\na. Giới thiệu\n\n## Hàm băm (hash function) là một hàm toán học h có tối thiểu 2 thuộc tính:\n\n- Nén (Compression): h là một ánh xạ từ chuỗi đầu vào x có chiều dài bất kỳ sang\n\nmột chuỗi đầu ra h(x) có chiều dài cố định n bit;\n\n- Dễ tính toán (Ease of computation): cho trước hàm h và đầu vào x, việc tính toán\n\nh(x) là dễ dàng.\n\n## Hình 3.26 minh họa mô hình nén thông  tin của hàm băm, theo đó thông điệp\n\n(Message) đầu vào với chiều dài tùy ý đi qua nhiều vòng xử lý của hàm băm để tạo chuỗi\n\nrút gọn, hay chuỗi đại diện (Digest) có kích thước cố định ở đầu ra.\n\n## Hình 3.26. Mô hình nén thông tin của hàm băm\n\nb. Phân loại\n\nCó thể phân loại các hàm băm theo khóa sử dụng hoặc theo chức năng. Theo khóa sử\n\ndụng, các hàm băm gồm 2 loại: hàm băm không khóa và hàm băm có khóa, như biểu diễn\n\ntrên Hình 3.27. Trong khi hàm băm không khóa nhận đầu vào chỉ là thông điệp (dạng\n\n---\n\n87\n\nh(x), với hàm băm h và thông điệp x), hàm băm có khóa nhận đầu vào gồm thông điệp và\n\nkhóa bí mật (theo dạng h(x, K), với hàm băm h và thông điệp x và K là khóa bí mật).\n\n## Trong các hàm băm không khóa, các mã phát hiện sửa đổi (MDC – Modification\n\nDetection Code) được sử dụng rộng rãi nhất, bên cạnh một số hàm băm không khóa khác.\n\n## Tương tự, trong các hàm băm có khóa, các mã xác thực thông điệp (MAC - Message\n\nAuthentication Code) được sử dụng rộng rãi nhất, bên cạnh một số hàm băm có khóa\n\nkhác.\n\n## Hình 3.27. Phân loại các hàm băm theo khóa sử dụng\n\n## Theo chức năng, có thể chia các hàm băm thành 2 loại chính:\n\n- Mã phát hiện sửa đổi (MDC - Modification Detection Code): MDC thường được\n\nsử dụng để tạo chuỗi đại diện cho thông điệp và dùng kết hợp với các kỹ thuật\n\nkhác (như chữ ký số) để đảm bảo tính toàn vẹn của thông điệp. MDC thuộc loại\n\nhàm băm không khóa. MDC gồm 2 loại nhỏ:\n\n+ Hàm băm một chiều (OWHF - One-way hash functions): Với hàm băm một\n\nchiều, việc tính giá trị băm là dễ dàng, nhưng việc khôi phục thông điệp từ giá\n\ntrị băm là rất khó khăn;\n\n+ Hàm băm chống đụng độ (CRHF - Collision resistant hash functions): Với hàm\n\nbăm chống đụng độ, sẽ là rất khó để tìm được 2 thông điệp khác nhau nhưng có\n\ncùng giá trị băm.\n\n- Mã xác thực thông điệp (MAC - Message Authentication Code): MAC cũng được\n\ndùng để đảm bảo tính toàn vẹn của thông điệp mà không cần một kỹ thuật bổ sung\n\nnào khác. MAC là loại hàm băm có khóa như đã đề cập ở trên, với đầu vào là\n\nthông điệp và một khóa bí mật.\n\nc. Mô hình xử lý dữ liệu\n\nHình 3.28 biểu diễn mô hình tổng quát xử lý dữ liệu của các hàm băm. Theo đó, thông\n\nđiệp đầu vào với độ dài tùy ý đi qua hàm nén lặp nhiều vòng để tạo chuỗi đầu ra có kích\n\nthước cố định. Chuỗi này đi qua một khâu chuyển đổi định dạng tùy chọn để tạo ra chuỗi\n\nbăm kết quả.\n\nHình 3.29 mô tả chi tiết quá trình xử lý dữ liệu của các hàm băm. Theo đó, quá trình\n\nxử lý gồm 3 bước chính: (1) tiền xử lý, (2) xử lý lặp và (3) chuyển đổi định dạng. Trong\n\nbước tiền xử lý, thông điệp đầu vào x trước hết được nối đuôi thêm một số bit và kích\n\n---\n\n88\n\nthước khối, sau đó chia thành các khối có kích thước xác định. Kết quả của bước này là t\n\nkhối dữ liệu có cùng kích thước có dạng x = x1x2…xt làm đầu vào cho bước 2. Trong bước\n\n2, từng khối dữ liệu xi được xử lý thông qua hàm nén f để tạo đầu ra là Hi. Kết quả của\n\nbước 2 là chuỗi đầu ra Ht và Ht được chuyển đổi định dạng bởi hàm g để tạo chuỗi giá trị\n\nbăm hết quả h(x).\n\n## Hình 3.28. Mô hình tổng quát xử lý dữ liệu của hàm băm\n\n## Hình 3.29. Mô hình chi tiết xử lý dữ liệu của hàm băm\n\n3.3.3.2. Một số hàm băm thông dụng\n\nCác hàm băm thông dụng giới thiệu trong mục này đều là các hàm băm không khóa,\n\ngồm các họ hàm băm chính như sau:\n\n---\n\n89\n\n- Họ hàm băm MD (Message Digest) gồm các hàm băm MD2, MD4, MD5 và MD6.\n\n- Họ hàm băm SHA (Secure Hash Algorithm) gồm các hàm băm SHA0, SHA1,\n\n## SHA2 và SHA3.\n\n- Một số hàm băm khác, gồm CRC (Cyclic redundancy checks), Checksums,...\n\n## Các mục con tiếp theo của mục này giới thiệu 2 hàm băm đã và đang được sử dụng\n\nrộng rãi nhất là hàm băm MD5 và SHA1.\n\na. Hàm băm MD5\n\n* Giới thiệu\n\n## MD5 (Message Digest) là hàm băm không khóa được Ronald Rivest thiết kế năm\n\n1991 để thay thế MD4. Chuỗi giá trị băm đầu ra của MD5 là 128 bit (16 byte) và thường\n\nđược biểu diễn thành 32 số hexa. MD5 được sử dụng khá rộng rãi trong nhiều ứng dụng,\n\nnhư tạo chuỗi đảm bảo tính toàn vẹn thông điệp, tạo chuỗi kiểm tra lỗi, hoặc kiểm tra tính\n\ntoàn vẹn dữ liệu (Checksum) và mã hóa mật khẩu trong các hệ điều hành và các ứng\n\ndụng. MD5 hiện nay được khuyến nghị không nên sử dụng do nó không còn đủ an toàn.\n\nNhiều điểm yếu của MD5 đã bị khai thác, như điển hình MD5 bị khai thác bởi mã độc\n\n## Flame vào năm 2012.\n\n* Quá trình xử lý thông điệp\n\nQuá trình xử lý thông điệp của MD5 gồm 2 khâu là tiền xử lý và các vòng lặp xử lý.\n\n## Cụ thể, chi tiết về các khâu này như sau:\n\n- Tiền xử lý: Thông điệp được chia thành các khối 512 bit (16 từ 32 bit). Nếu kích\n\nthước thông điệp không là bội số của 512 thì nối thêm số bit còn thiếu.\n\n- Các vòng lặp xử lý: Phần xử lý chính của MD5 làm việc trên state 128 bit, chia\n\nthành 4 từ 32 bit (A, B, C, D):\n\n+ Các từ A, B, C, D được khởi trị bằng một hằng cố định;\n\n+ Từng phần 32 bit của khối đầu vào 512 bit được đưa dần vào để thay đổi state;\n\n+ Quá trình xử lý gồm 4 vòng, mỗi vòng gồm 16 thao tác tương tự nhau.\n\n+ Mỗi thao tác gồm: Xử lý bởi hàm F (4 dạng hàm khác nhau cho mỗi vòng),\n\n## Cộng modulo và Quay trái. Hình 3.30 biểu diễn lưu đồ xử lý của một thao tác\n\ncủa MD5, trong đó A, B, C, D là các từ 32 bit của state, Mi: khối 32 bit thông\n\nđiệp đầu vào, Ki là 32 bit hằng khác nhau cho mỗi thao tác, <<<s là thao tác\n\ndịch trái s bit,\n\nbiểu diễn phép cộng modulo 32 bit và F là hàm phi tuyến tính.\n\n## Hàm F gồm 4 dạng được dùng cho 4 vòng lặp. Cụ thể, F có các dạng như sau:\n\n# F(B, C, D) = (B  C)  (B  D)\n\n# G(B, C, D) = (B  D)  (C  D)\n\n# H(B, C, D) = B  C  D\n\n# I(B, C, D) = C  (B  D)\n\ntrong đó, các ký hiệu , , ,  biểu diễn các phép toán lô gíc XOR, AND, OR và\n\n## NOT tương ứng.\n\n---\n\n90\n\n## Hình 3.30. Lưu đồ xử lý một thao tác của MD5\n\nb. Hàm băm SHA1\n\n* Giới thiệu\n\n## SHA1 (Secure Hash Function) được Cơ quan mật vụ Mỹ thiết kế năm 1995 để thay\n\nthế cho hàm băm SHA0. Chuỗi giá trị băm đầu ra của SHA1 có kích thước 160 bit và\n\nthường được biểu diễn thành 40 số hexa. Tương tự MD5, SHA1 được sử dụng rộng rãi để\n\nđảm bảo tính xác thực và toàn vẹn thông điệp.\n\n* Quá trình xử lý thông điệp\n\nSHA1 sử dụng thủ tục xử lý thông điệp tương tự MD5, cũng gồm 2 khâu là tiền xử lý\n\nvà các vòng lặp xử lý. Cụ thể, chi tiết về các khâu này như sau:\n\n- Tiền xử lý: Thông điệp được chia thành các khối 512 bit (16 từ 32 bit). Nếu kích\n\nthước thông điệp không là bội số của 512 thì nối thêm số bit còn thiếu.\n\n- Các vòng lặp xử lý: Phần xử lý chính của SHA1 làm việc trên state 160 bit, chia\n\nthành 5 từ 32 bit (A, B, C, D, E):\n\n+ Các từ A, B, C, D, E được khởi trị bằng một hằng cố định;\n\n+ Từng phần 32 bit của khối đầu vào 512 bit được đưa dần vào để thay đổi state;\n\n+ Quá trình xử lý gồm 80 vòng, mỗi vòng gồm các thao tác: add, and, or, xor,\n\nrotate, mod.\n\n+ Mỗi vòng xử lý gồm: Xử lý bởi hàm phi tuyến tính F (có nhiều dạng hàm khác\n\nnhau), Cộng modulo và Quay trái. Hình 3.31 biểu diễn lưu đồ một vòng xử lý\n\ncủa SHA1, trong đó A, B, C, D, E là các từ 32 bit của state, Wt: khối 32 bit\n\nthông điệp đầu vào, Kt là 32 bit hằng khác nhau cho mỗi vòng, <<<n là thao tác\n\ndịch trái n bit,\n\nbiểu diễn phép cộng modulo 32 bit và F là hàm phi tuyến tính.\n\n## Hàm phi tuyến tính F phụ thuộc vào số vòng lặp t như sau:\n\n---\n\n91\n\ntrong đó, các ký hiệu , , ,  tương ứng biểu diễn các phép toán lô gíc XOR,\n\n## AND, OR và NOT.\n\n## Hình 3.31. Lưu đồ một vòng xử lý của SHA1\n\n3.4. Chữ ký số, chứng chỉ số và PKI\n\n3.4.1. Chữ ký số\n\n3.4.1.1. Một số khái niệm\n\n## Chữ ký số (Digital signature) là một chuỗi dữ liệu liên kết với một thông điệp\n\n(message) và thực thể tạo ra thông điệp. Chữ ký số thường được sử dụng để đảm bảo tính\n\ntoàn vẹn của thông điệp.\n\nGiải thuật tạo chữ ký số (Digital signature generation algorithm) là một phương pháp\n\nsinh chữ ký số;\n\nGiải thuật kiểm tra chữ ký số (Digital signature verification algorithm) là một phương\n\npháp xác minh tính xác thực của chữ ký số, có nghĩa là nó thực sự được tạo ra bởi 1 bên\n\nchỉ định;\n\nMột hệ chữ ký số (Digital signature scheme) bao gồm giải thuật tạo chữ ký số và giải\n\nthuật kiểm tra chữ ký số.\n\n## Quá trình tạo chữ ký số (Digital signature signing process) bao gồm:\n\n- Giải thuật tạo chữ ký số, và\n\n- Phương pháp chuyển dữ liệu thông điệp thành dạng có thể ký được.\n\n## Quá trình kiểm tra chữ ký số (Digital signature verification process) bao gồm:\n\n- Giải thuật kiểm tra chữ ký số, và\n\n- Phương pháp khôi phục dữ liệu từ thông điệp.\n\n---\n\n92\n\n3.4.1.2. Quá trình ký và kiểm tra\n\n## Hình 3.32. Quá trình tạo chữ ký số và kiểm tra chữ ký số\n\nHình 3.32 biểu diễn quá trình tạo chữ ký số và kiểm tra chữ ký số cho một thông điệp\n\n(Message). Trong khi quá trình tạo chữ ký số cho thông điệp được thực hiện ở bên người\n\ngửi (Sender) thì quá trình kiểm tra chữ ký số của thông điệp được thực hiện ở bên người\n\nnhận (Receiver). Để có thể tạo và kiểm tra chữ ký số cho thông điệp, người gửi phải sở\n\nhữu cặp khóa công khai (Public key) và khóa riêng (Private key). Khóa riêng dùng để tạo\n\nchữ ký số và khóa công khai dùng để kiểm tra chữ ký số.\n\n## Các bước của quá trình tạo chữ ký số cho thông điệp (bên người gửi - Sender):\n\n- Tính toán chuỗi đại diện (message digest/hash value) của thông điệp sử dụng một\n\ngiải thuật băm (Hashing algorithm);\n\n- Chuỗi đại diện được ký sử dụng khóa riêng (Private key) của người gửi và một giải\n\nthuật tạo chữ ký (Signature/Encryption algorithm). Kết quả là chữ ký số (Digital\n\nsignature) của thông điệp hay còn gọi là chuỗi đại diện được mã hóa (Encrypted\n\nmessage digest);\n\n- Thông điệp ban đầu (message) được ghép với chữ ký số (Digital signature) tạo\n\nthành thông điệp đã được ký (Signed message);\n\n- Thông điệp đã được ký (Signed message) được gửi cho người nhận.\n\n## Các bước của quá trình kiểm tra chữ ký số của thông điệp (bên người nhận -\n\n## Receiver):\n\n- Tách chữ ký số và thông điệp gốc khỏi thông điệp đã ký để xử lý riêng;\n\n---\n\n93\n\n- Tính toán chuỗi đại diện MD1 (message digest) của thông điệp gốc sử dụng giải\n\nthuật băm (là giải thuật sử dụng trong quá trình ký);\n\n- Sử dụng khóa công khai (Public key) của người gửi để giải mã chữ ký số để khôi\n\nphục chuỗi đại diện thông điệp MD2. Trên thực tế, người gửi thường chuyển\n\nchứng chỉ số khóa công khai của mình cho người nhận và người nhận thực hiện\n\nviệc kiểm tra chứng chỉ số của người gửi và tách lấy khóa công khai nếu việc kiểm\n\ntra thành công.\n\n- So sánh hai chuỗi đại diện MD1 và MD2:\n\n+ Nếu MD1 = MD2 : chữ ký kiểm tra thành công. Thông điệp đảm bảo tính toàn\n\nvẹn và thực sự xuất phát từ người gửi (do khóa công khai được chứng thực).\n\n+ Nếu MD1 <> MD2 : chữ ký không hợp lệ. Thông điệp có thể đã bị sửa đổi hoặc\n\nkhông thực sự xuất phát từ người gửi.\n\n3.4.1.3. Các giải thuật chữ ký số\n\n## Mục này trình bày 2 giải thuật chữ ký số thông dụng là RSA và DSA. RSA được sử\n\ndụng rộng rãi do RSA có thể được sử dụng để mã hóa thông điệp và tạo chữ ký số cho\n\nthông điệp. DSA là thuật toán chữ ký chuẩn được Viện NIST (Hoa Kỳ) phát triển.\n\na. Giải thuật chữ ký số RSA\n\nGiải thuật RSA đề cập ở mục 3.3.2.2 có thể được sử dụng với hai mục đích để mã hóa\n\n- giải mã thông điệp và tạo chữ ký số - kiểm tra chữ ký số cho thông điệp. Điểm khác biệt\n\ngiữa việc sử dụng RSA cho mã hóa và chữ ký số là bên sở hữu các cặp khóa và việc sử\n\ndụng các khóa trong quá trình mã hóa và giải mã. Cụ thể:\n\n- RSA sử dụng cho mã hóa thông điệp:\n\n+ Người nhận phải sở hữu cặp khóa công khai (Public key) và khóa riêng (Private\n\nkey). Người nhận chuyển khóa công khai của mình cho người gửi;\n\n+ Người gửi mã hóa thông điệp sử dụng khóa công khai của người nhận và\n\nchuyển bản mã cho người nhận;\n\n+ Người nhận giải mã thông điệp sử dụng khóa riêng của mình để khôi phục bản\n\nrõ của thông điệp.\n\n- RSA sử dụng cho tạo chữ ký số thông điệp:\n\n+ Người gửi phải sở hữu cặp khóa công khai (Public key) và khóa riêng (Private\n\nkey). Người gửi chuyển khóa công khai của mình cho người nhận;\n\n+ Người gửi sử dụng khóa riêng để tạo chữ ký số cho thông điệp (bản chất là sử\n\ndụng khóa riêng để mã hóa chuỗi đại diện cho thông điệp);\n\n+ Người nhận sử dụng khóa công khai của người gửi để kiểm tra chữ ký số của\n\nthông điệp (bản chất là sử dụng khóa công khai để giải mã khôi phục chuỗi đại\n\ndiện cho thông điệp).\n\nQuá trình ký và kiểm tra chữ ký số sử dụng giải thuật RSA tương tự như quá trình ký\n\nvà kiểm tra chữ ký số tổng quát đã trình bày ở mục 3.4.1.2 và Hình 3.32, trong đó quá\n\n---\n\n94\n\ntrình ký sử dụng giải thuật mã hóa RSA với khóa riêng của người gửi và quá trình kiểm\n\ntra sử dụng giải thuật giải mã RSA với khóa công khai của người gửi.\n\nb. Giải thuật chữ ký số DSA\n\nDSA (Digital Signature Algorithm) là thuật toán chữ ký số được phát triển từ giải\n\nthuật ElGamal Signature Algorithm và được công nhận là chuẩn chữ ký số sử dụng trong\n\ncác cơ quan chính phủ bởi Viện NIST (Hoa Kỳ) vào năm 1991. DSA gồm 3 gồm 3 khâu:\n\n(1) sinh cặp khóa, (2) quá trình ký thông điệp và (3) quá trình kiểm tra chữ ký của thông\n\nđiệp.\n\n* Sinh khóa cho một người dùng:\n\n- Chọn số ngẫu nhiên x sao cho 0 < x < q;\n\n- Tính y = gx mod p;\n\n- Khóa công khai là (q, p, g, y);\n\n- Khóa riêng là x.\n\n* Quá trình ký thông điệp:\n\n- H là hàm băm sử dụng và m là thông điệp gốc;\n\n- Tính H(m) từ thông điệp gốc;\n\n- Tạo số ngẫu nhiên k cho mỗi thông điệp, 0 < k < q;\n\n- Tính r = (gk mod p) mod q;\n\n- Nếu r = 0, chọn một k mới và tính lại r;\n\n- Tính s = k-1(H(m) + xr) mod q;\n\n- Nếu s = 0, chọn một k mới và tính lại r và s;\n\n- Chữ ký là cặp (r, s).\n\n* Quá trình kiểm tra chữ ký\n\n- Loại bỏ chữ ký nếu r và s không thỏa mãn 0 < r , s < q;\n\n- Tính H(m) từ thông điệp nhận được;\n\n- Tính w = s-1 mod q;\n\n- Tính u1 = H(m) * w mod q;\n\n- Tính u2 = r * w mod q;\n\n- Tính v = ((gu1 * yu2) mod p) mod q;\n\n- Chữ ký là xác thực nếu v = r.\n\nTheo một số nghiên cứu, giải thuật chữ ký số DSA và giải thuật chữ ký số RSA có độ\n\nan toàn tương tương. Ưu điểm của giải thuật chữ ký số DSA so với giải thuật chữ ký số\n\nRSA là quá trình sinh cặp khóa và quá trình ký nhanh hơn. Tuy nhiên, quá trình kiểm tra\n\nchữ ký số bởi DSA thực hiện chậm hơn RSA. Trên thực tế, giải thuật chữ ký số RSA\n\nđược sử dụng rộng rãi hơn do RSA có thể sử dụng cho cả mục đích mã hóa/giải mã và\n\nký/kiểm tra chữ ký, trong khi DSA chỉ có thể sử dụng để ký/kiểm tra chữ ký.\n\n---\n\n95\n\n3.4.2. Chứng chỉ số\n\n3.4.2.1. Giới thiệu\n\nChứng chỉ số (Digital certificate), còn gọi là chứng chỉ khóa công khai (Public key\n\ncertificate), hay chứng chỉ nhận dạng (Identity certificate) là một tài liệu điện tử sử dụng\n\nmột chữ ký số để liên kết một khóa công khai và thông tin nhận dạng của một thực thể.\n\n## Ba thành phần cơ bản nhất của một chứng chỉ số gồm:\n\n- Chữ ký số: là chữ ký của một bên thứ 3 tin cậy cung cấp chứng chỉ số, thường gọi\n\nlà CA – Certificate Authority;\n\n- Khóa công khai: là khóa công khai trong cặp khóa công khai và khóa riêng của\n\nthực thể;\n\n- Thông tin nhận dạng: là tên, địa chỉ, tên miền hoặc các thông tin định danh của\n\nthực thể.\n\n## Chứng chỉ số có thể được sử dụng để xác minh chủ thể thực sự của một khóa công\n\nkhai. Hình 3.33 là giao diện kiểm tra thông tin một chứng chỉ số do bên thứ 3 là một đơn\n\nvị của công ty Verisign cấp cho tên miền www.vietcombank.com.vn của ngân hàng\n\n## TMCP Ngoại thương Việt Nam.\n\n## Hình 3.33. Giao diện kiểm tra thông tin một chứng chỉ số\n\n3.4.2.2. Nội dung chứng chỉ số\n\nNhư biểu diễn trên Hình 3.34, nội dung của một chứng chỉ số gồm nhiều trường thông\n\ntin. Các trường thông tin cụ thể theo chuẩn chứng chỉ số X.509 gồm:\n\n- Serial Number: Số nhận dạng của chứng chỉ số;\n\n- Subject:  Thông tin nhận dạng một cá nhân hoặc một tổ chức;\n\n- Signature Algorithm: Giải thuật tạo chữ ký;\n\n---\n\n96\n\n- Signature Hash Algorithm: Giải thuật tạo chuỗi băm cho tạo chữ ký;\n\n- Signature: Chữ ký của người/tổ chức cấp chứng chỉ;\n\n- Issuer: Người/tổ chức có thẩm quyền/tin cậy cấp chứng chỉ;\n\n- Valid-From: Ngày bắt đầu có hiệu lực của chứng chỉ;\n\n- Valid-To: Ngày hết hạn sử dụng chứng chỉ;\n\n- Key-Usage: Mục địch sử dụng khóa (chữ ký số, mã hóa,…);\n\n- Public Key: Khóa công khai của chủ thể;\n\n- Thumbprint Algorithm: Giải thuật băm sử dụng để tạo chuỗi băm cho khóa công\n\nkhai;\n\n- Thumbprint: Chuỗi băm tạo từ khóa công khai;\n\n## Các mục thông tin của trường Subject gồm:\n\n- CN (Common Name): Tên chung, nhưng một tên miền được gán chứng chỉ;\n\n- OU (Organisation Unit): Tên bộ phận/phòng ban;\n\n- O (Organisation): Tổ chức/Cơ quan/công ty;\n\n- L (Location): Địa điểm/Quận huyện;\n\n- S (State/Province): Bang/Tỉnh/Thành phố;\n\n- C (Country): Đất nước.\n\n## Hình 3.34. Nội dung chi tiết của một chứng chỉ số\n\n3.4.2.3. Ứng dụng của chứng chỉ số\n\nChứng chỉ số được sử dụng rộng rãi trong bảo mật thông tin truyền và xác thực thông\n\ntin nhận dạng của các bên tham gia giao dịch điện tử, trao đổi khóa trong nhiều ứng dụng\n\nkhác nhau. Cụ thể:\n\n---\n\n97\n\n- Sử dụng chứng chỉ số trong đảm bảo an toàn giao dịch trên nền web: với chứng chỉ\n\nsố, một website có thể được cấu hình để hoạt động theo chế độ “an toàn”\n\n(HTTPS), trong đó  toàn bộ thông tin trao đổi giữa máy chủ và máy khách được\n\nđảm bảo tính bí mật (sử dụng mã hóa khóa đối xứng), tính toàn vẹn và xác thực (sử\n\ndụng hàm băm có khóa MAC). Ngoài ra, các máy chủ và máy khách có thể xác\n\nthực thông tin nhận dạng của nhau sử dụng chứng chỉ số.\n\n- Chứng chỉ số cũng có thể được sử dụng để bảo mật thông tin truyền trong nhiều\n\nứng dụng khác, như email, truyền file,…\n\n- Sử dụng chứng chỉ số có thể ngăn chặn hiệu quả dạng tấn công người đứng giữa do\n\ncác bên tham gia giao dịch có thể xác thực thông tin nhận dạng của nhau. Nếu các\n\nbên sử dụng thêm chữ ký số thì có thể ngăn chặn việc sửa đổi các thông điệp trao\n\nđổi trên đường truyền.\n\n- Chứng chỉ số có thể được sử dụng trong trao đổi khóa.\n\n# 3.4.3. PKI\n\nHạ tầng khóa công khai (Public-key infrastructure - PKI) là một tập các phần cứng,\n\nphần mềm, nhân lực, chính sách và các thủ tục để tạo, quản lý, phân phối, sử dụng, lưu\n\ntrữ và thu hồi các chứng chỉ số. Một PKI gồm các thành phần sau:\n\n- Certificate Authority (CA): Cơ quan cấp và kiểm tra chứng chỉ số;\n\n- Registration Authority (RA): Bộ phận tiếp nhận, kiểm tra thông tin nhận dạng của\n\nngười dùng theo yêu cầu của CA;\n\n- Validation Authority (VA): Cơ quan xác nhận thông tin nhận dạng của người dùng\n\nthay mặt CA;\n\n- Central Directory (CD): Là nơi lưu danh mục và lập chỉ số các khóa;\n\n- Certificate Management System: Hệ thống quản lý chứng chỉ;\n\n- Certificate Policy: Chính sách về chứng chỉ.\n\nHình 3.35 biểu diễn lưu đồ cấp và sử dụng chứng chỉ số trong PKI gồm 2 khâu chính:\n\n## Hình 3.35. Lưu đồ cấp và sử dụng chứng chỉ số trong PKI\n\n---\n\n98\n\n- Đăng ký, xét duyệt và cấp chứng chỉ số:\n\n+ Người dùng có yêu cầu cấp chứng chỉ số tạo một cặp khóa, gồm 1 khóa công\n\nkhai và 1 khóa riêng;\n\n+ Người dùng tạo yêu cầu cấp chứng chỉ số (Certificate request), trong đó tích hợp\n\nkhóa công khai và thông tin định danh của mình. Yêu cầu cấp chứng chỉ số\n\nthường được lưu dưới dạng 1 file văn bản theo định dạng của chuẩn X.509;\n\n+ Người dùng gửi yêu cầu cấp chứng chỉ số đến Bộ phận tiếp nhận (RA). RA\n\nkiểm tra các thông tin trong yêu cầu cấp chứng chỉ số, nếu hợp lệ thì chuyển yêu\n\ncầu đến Cơ quan cấp chứng chỉ (CA);\n\n+ CA sẽ thực hiện việc xác minh các thông tin nhận dạng của chủ thể và nếu xác\n\nminh thành công thì cấp chứng chỉ số cho người yêu cầu. Chứng chỉ số được\n\n## CA ký bằng khóa riêng của mình để đảm bảo tính xác thực và toàn vẹn và\n\nthường được lưu dưới dạng 1 file văn bản theo định dạng của chuẩn X.509;\n\n+ Sau khi phát hành chứng chỉ số cho người dùng, CA chuyển thông tin về chứng\n\nchỉ số đã cấp cho thành phần VA để xác nhận thông tin nhận dạng theo yêu cầu;\n\n+ Người dùng cài đặt chứng chỉ số vào hệ thống và có thể bắt đầu sử dụng trong\n\ncác ứng dụng của mình.\n\n- Sử dụng và kiểm tra chứng chỉ số:\n\n+ Người dùng tạo đơn hàng, ký vào đơn hàng bằng khóa riêng, gửi đơn hàng đã\n\nký và chứng chỉ số cho nhà cung cấp;\n\n+ Nhà cung cấp chuyển chứng chỉ số của người dùng cho VA để kiểm tra, nếu\n\nchứng chỉ số hợp lệ  thì tiến hành xác thực chữ ký số của người dùng sử dụng\n\nkhóa công khai của người dùng lấy từ chứng chỉ số. Nếu chữ ký của người dùng\n\nxác thực thành công thì đơn hàng được duyệt.\n\n3.5. Quản lý khóa và phân phối khóa\n\n3.5.1. Giới thiệu\n\n3.5.1.1. Một số khái niệm\n\nQuan hệ khóa (Keying relationship) là trạng thái mà trong đó các bên tham gia truyền\n\nthông chia sẻ dữ liệu chia sẻ (thường là khóa hoặc thành phần tạo ra khóa) để sử dụng\n\ncho các kỹ thuật mã hóa. Các dữ liệu chia sẻ có thể gồm:\n\n- Khóa bí mật\n\n- Khóa công khai\n\n- Các giá trị khởi tạo\n\n- Các tham số bổ sung không bí mật.\n\nQuản lý khóa (Key management) là một tập các kỹ thuật cho phép thiết lập và duy trì\n\ncác quan hệ khóa giữ các bên có thẩm quyền. Cụ thể, quản lý khóa gồm các kỹ thuật và\n\nthủ tục cho phép:\n\n- Khởi tạo các người dùng hệ thống (system users) trong một vùng (domain);\n\n---\n\n99\n\n- Sinh khóa, phân phối và cài đặt các dữ liệu khóa;\n\n- Kiểm soát việc sử dụng các dữ liệu khóa;\n\n- Cập nhật, thu hồi và hủy các dữ liệu khóa;\n\n- Lưu, sao lưu/khôi phục và lưu trữ các dữ liệu khóa.\n\nPhân phối khóa (Key distribution) là một thành phần của quản lý khóa, trong đó các\n\nkhóa mật mã được vận chuyển, hoặc trao đổi giữa các thực thể trong một hệ thống, hay\n\ngiữa các bên tham gia phiên truyền thông.\n\n3.5.1.2. Vai trò và các nguy cơ mất an toàn quản lý khóa\n\nQuản lý khóa là một khâu có vai trò quan trọng trong việc đảm bảo tính bí mật, toàn\n\nvẹn, xác thực, không thể chối bỏ và dịch vụ chữ ký số của một hệ mã hóa. Khâu quản lý\n\nkhóa được thực hiện phù hợp sẽ đảm bảo cho các thông tin khóa được an toàn, đặc biệt\n\nkhi có nhiều thực thể tham gia truyền thông. Các thông tin khóa được đảm bảo an toàn là\n\nyếu tố tiên quyết cho việc đảm bảo tính an toàn của hệ mã hóa.\n\nĐứng trên góc độ quản lý, vấn đề quản lý khóa phải luôn được thực hiện trong khuôn\n\nkhổ chính sách an ninh cụ thể. Chính sách an ninh của cơ quan, tổ chức cần có các nội\n\ndung mô tả về quản lý khóa, bao gồm:\n\n- Các thực tế và thủ tục cần thực hiện trong các khía cạnh kỹ thuật và quản trị khóa\n\ntự động hoặc thủ công;\n\n- Trách nhiệm của các bên có liên quan;\n\n- Các bản ghi dữ liệu cần phải lưu để tạo các báo cáo về các vấn đề có liên quan đến\n\nan toàn khóa.\n\nNgoài ra, việc phân tích, nhận dạng các nguy cơ đe dọa an toàn của khâu quản lý khóa\n\nlà một việc cần thiết, từ đó có thể đề ra và áp dụng các biện pháp đảm bảo an toàn phù\n\nhợp. Các nguy cơ đối với quản lý khóa bao gồm:\n\n- Các khóa bí mật bị lộ;\n\n- Tính xác thực của các khóa bí mật và công khai bị thỏa hiệp. Tính xác thực bao\n\ngồm các hiểu biết và việc kiểm chứng thông tin nhận dạng của một bên mà khóa\n\nđược chia sẻ;\n\n- Sử dụng trái phép các khóa bí mật và công khai:\n\n+ Sử dụng các khóa đã hết hiệu lực;\n\n+ Sử dụng các khóa sai mục đích.\n\n3.5.1.3. Phân loại khóa\n\nCác khóa/chìa mật mã có thể được phân loại theo (1) khả năng sử dụng và (2) thời\n\ngian sử dụng. Theo khả năng sử dụng, có thể chia các khóa thành 3 lớp:\n\n- Khóa chủ (Master key):\n\n+ Là các khóa ở mức cao nhất và không được bảo vệ bằng các kỹ thuật mật mã.\n\n+ Các khóa chủ thường được chuyển giao trực tiếp và được bảo vệ bằng các cơ\n\nchế kiểm soát vật lý.\n\n---\n\n100\n\n- Khóa dùng cho trao đổi khóa (Key – encrypting key):\n\n+ Là những khóa được sử dụng để vận chuyển hoặc lưu trữ các khóa khác.\n\n+ Các khóa này cũng có thể được bảo vệ bằng khóa khác.\n\n- Khóa dữ liệu (Data keys):\n\n+ Là các khóa được sử dụng để mã hóa dữ liệu cho người dùng.\n\n+ Thường là các khóa ngắn hạn.\n\n## Theo thời gian sử dụng, có thể chia các khóa thành 2 lớp:\n\n- Khóa dài hạn (long-term key):\n\n+ Là các khóa được sử dụng trong một khoảng thời gian dài;\n\n+ Gồm khóa chủ, khóa dùng cho trao đổi khóa, hoặc khóa dùng cho thỏa thuận\n\nkhóa.\n\n- Khóa ngắn hạn:\n\n+ Là các khóa được sử dụng trong một khoảng thời gian ngắn hoặc chỉ trong một\n\nphiên làm việc;\n\n+ Gồm các khóa được trao đổi trong quá trình trao đổi khóa, thỏa thuận khóa;\n\n+ Thường được dùng để mã hóa dữ liệu của người dùng.\n\n3.5.2. Phân phối khóa bí mật\n\n3.5.2.1. Đặt vấn đề\n\nNhư đã đề cập trong mục 3.3.1, các hệ mã hóa khóa đối xứng, hay khóa bí mật có ưu\n\nđiểm là độ an toàn cao và tốc độ xử lý nhanh do kích thước khóa tương đối nhỏ. Tuy\n\nnhiên, hạn chế lớn nhất của chúng là khó khăn trong quản lý và phân phối khóa bí mật –\n\ncác khóa bí mật dùng chung phải được phân phối, chia sẻ an toàn đến các bên tham gia\n\ntrước khi có thể thực hiện phiên truyền thông an toàn.\n\nVấn đề phân phối khóa bí mật được khái quát hóa thành bài toán phân phối n2 khóa.\n\nBài toán này phát biểu như sau: Nếu một hệ thống có n người dùng tham gia truyền thông\n\nsử dụng kỹ thuật mã hóa khóa đối xứng và mỗi cặp người dùng cần trao đổi thông tin an\n\ntoàn, thì mỗi cặp người dùng cần chia sẻ một khóa bí mật duy nhất. Như vậy, mỗi người\n\ndùng cần sở hữu n-1 khóa bí mật và tổng số khóa cần quản lý trong hệ thống là n(n-1)/2 \n\nn2. Ví dụ, nếu hệ thống có 10 người dùng, tổng số khóa cần quản lý là 10×9/2 = 45 khóa;\n\nvới 100 người dùng, số khóa là 100×99/2 = 4.950 khóa; và với 1000 người dùng, số khóa\n\nlà 1000×999/2 = 499.500 khóa. Số khóa cần quản lý sẽ rất lớn nếu số người dùng lớn và\n\nviệc quản lý số lượng lớn khóa đảm bảo an toàn là rất khó khăn.\n\n## Để giải quyết bài toán phân phối n2 khóa và đảm bảo an toàn trong phân phối các\n\nkhóa bí mật, một số mô hình và kỹ thuật phân phối khóa bí mật được đề xuất và ứng\n\ndụng, bao gồm:\n\n-  Phân phối khóa điểm – điểm (Point-to-point key distribution)\n\n- Trung tâm phân phối khóa (Key distribution center – KDC)\n\n- Trung tâm dịch khóa (Key translation center – KTC)\n\n---\n\n101\n\n- Sử dụng mã hóa khóa công khai để phân phối khóa bí mật.\n\n## Các mục tiếp theo mô tả chi tiết các mô hình và kỹ thuật phân phối khóa bí mật.\n\n3.5.2.2. Phân phối khóa điểm – điểm\n\nPhân phối khóa điểm – điểm (Point-to-point key distribution) là hình thức phân phối\n\nkhóa chỉ liên quan trực tiếp đến 2 thực thể tham gia truyền thông, như minh họa trên\n\nHình 3.36. Hình thức phân phối khóa điểm – điểm có thể thực hiện thông qua các kênh\n\ntin cậy, như kênh truyền thuê riêng, hoặc thư bảo đảm. Phương pháp này có thể sử dụng\n\nvới các trao đổi không thường xuyên và thích hợp với các hệ thống cỡ nhỏ hoặc đóng\n\nkín. Nhược điểm của phương pháp này là trễ có thể lớn (như sử dụng thư bảo đảm) và\n\ncác kênh tin cậy dùng riêng thường đắt tiền.\n\n## Hình 3.36. Phân phối khóa điểm – điểm\n\n3.5.2.3. Trung tâm phân phối khóa\n\na. Giới thiệu\n\nTrung tâm phân phối khóa (Key distribution center – KDC) là một trong các kỹ thuật\n\nđược sử dụng rộng rãi để giải quyết bài toán n2 khóa trong hệ thống có n người dùng.\n\nMục tiêu là KDC tạo và phân phối khóa bí mật an toàn đến các thực thể trong hệ thống và\n\ngiảm thiểu số lượng khóa dài hạn mà mỗi thực thể và KDC phải quản lý. Hình 3.37 biểu\n\ndiễn mô hình hoạt động của hệ thống KDC gồm 3 thực thể: Trung tâm phân phối khóa\n\nKDC ký hiệu là T và 2 thực thể thành viên tham gia trao đổi khóa là A và B. Khóa bí mật\n\ncần trao đổi là K. Hoạt động của hệ thống KDC gồm 2 khâu: (1) Khởi tạo – thiết lập môi\n\ntrường và các tham số hoạt động và (2) Thủ tục phân phối khóa sử dụng KDC.\n\n## Hình 3.37. Mô hình hoạt động của trung tâm phân phối khóa – KDC\n\nb. Khởi tạo\n\nTrong quá trình khởi tạo, thực thể A sở hữu khóa dài hạn KAT và A chia sẻ KAT với\n\n## KDC T. Thực thể B sở hữu khóa dài hạn KBT và B chia sẻ KBT với KDC T. Trung tâm\n\nphân phối khóa T là một máy chủ tin cậy, cho phép hai bên A và B không trực tiếp chia\n\nsẻ thông tin khóa thiết lập kênh truyền thông an toàn sử dụng hai khóa dài hạn KAT và\n\n# KBT.\n\n---\n\n102\n\nc. Thủ tục phân phối khóa\n\nTheo mô hình hoạt động của trung tâm phân phối khóa biểu diễn trên Hình 3.37, gọi\n\nE là hàm mã hóa, D là hàm giải mã, thủ tục phân phối khóa sử dụng KDC T như sau:\n\n- A yêu cầu chia sẻ khóa với B;\n\n- T sẽ tạo ra hoặc lấy khóa có sẵn K và mã hóa K thành EKAT(K) và gửi cho A;\n\n- T cũng có thể gửi khóa cho B dưới dạng EKBT(K) thông qua A (hình i);\n\n- T cũng có thể gửi khóa trực tiếp cho B dưới dạng EKBT(K) (hình ii);\n\n- A nhận được EKAT(K), giải mã sử dụng KAT để có được K: DKAT(EKAT(K)) = K\n\n- B nhận được EKBT(K), giải mã sử dụng KBT để có được K: DKBT(EKBT(K)) = K\n\n3.5.2.4. Trung tâm dịch khóa\n\na. Giới thiệu\n\nTrung tâm dịch chuyển khóa (Key translation center – KTC) là một trong các kỹ thuật\n\nđược sử dụng rộng rãi để giải quyết bài toán n2 khóa trong hệ thống có n người dùng. Vai\n\ntrò của KTC tương tự KDC, tuy nhiên một bên tham gia truyền thông sẽ cung cấp khóa\n\ntrao đổi. Mục tiêu là KTC chuyển khóa bí mật an toàn đến các thực thể còn lại tham gia\n\ntruyền thông trong hệ thống và giảm thiểu số lượng khóa dài hạn mà mỗi thực thể và\n\n## KTC phải quản lý. Điểm khác biệt của KTC so với KDC là KTC cho phép sinh khóa\n\nphân tán (các thực thể tự sinh khóa), còn KDC cho phép sinh khóa tập trung (KDC sinh\n\nkhóa). Hình 3.38 biểu diễn mô hình hoạt động của hệ thống KTC gồm 3 thực thể: Trung\n\ntâm dịch chuyển khóa KTC ký hiệu là T và 2 thực thể thành viên tham gia trao đổi khóa\n\nlà A và B. Khóa bí mật cần trao đổi là K. Hoạt động của hệ thống KTC gồm 2 khâu: (1)\n\nKhởi tạo – thiết lập môi trường và các tham số hoạt động và (2) Thủ tục phân phối khóa\n\nsử dụng KTC.\n\n## Hình 3.38. Mô hình hoạt động của trung tâm dịch chuyển khóa – KTC\n\nb. Khởi tạo\n\nTrong quá trình khởi tạo, thực thể A sở hữu khóa dài hạn KAT và A chia sẻ KAT với\n\n## KTC T. Thực thể B sở hữu khóa dài hạn KBT và B chia sẻ KBT với KTC T. Trung tâm\n\nphân phối khóa T là một máy chủ tin cậy, cho phép hai bên A và B không trực tiếp chia\n\nsẻ thông tin khóa thiết lập kênh truyền thông an toàn sử dụng hai khóa dài hạn KAT và\n\n# KBT.\n\n---\n\n103\n\nc. Thủ tục phân phối khóa\n\nTheo mô hình hoạt động của trung tâm dịch chuyển khóa biểu diễn trên Hình 3.38,\n\ngọi E là hàm mã hóa, D là hàm giải mã, thủ tục phân phối khóa sử dụng KTC T như sau:\n\n- A tạo ra khóa K và mã hóa K thành EKAT(K) và gửi cho T;\n\n- T nhận được EKAT(K), giải mã sử dụng KAT thu được K: DKAT(EKAT(K)) = K\n\n- Sau đó, T mã hóa khóa K sử dụng KBT để có EKBT(K);\n\n- T có thể gửi khóa cho B dưới dạng EKBT(K) thông qua A (hình i);\n\n- T cũng có thể gửi khóa trực tiếp cho B dưới dạng EKBT(K) (hình ii);\n\n- B nhận được EKBT(K), giải mã sử dụng KBT để có được K: DKBT(EKBT(K)) = K\n\nd. Ưu điểm và nhược điểm của quản lý khóa tập trung (KDC và KTC)\n\n- Ưu điểm:\n\n+ Hiệu quả trong lưu trữ khóa: mỗi bên chỉ cần duy trì một khóa bí mật dài hạn\n\nvới bên tin cậy (không phải với bên trao đổi thông tin);\n\n+ Tổng số khóa dài hạn cần lưu trữ là n khóa (so với n2 khóa).\n\n- Nhược điểm:\n\n+ Cả hệ thống có thể bị mất an toàn nếu trung tâm quản lý khóa bị thỏa hiệp (bị\n\nđiều khiển);\n\n+ Trung tâm quản lý khóa có thể thành điểm nút cổ chai;\n\n+ Dịch vụ sẽ phải ngừng nếu trung tâm quản lý khóa gặp trục trặc;\n\n+ Cần có một máy chủ tin cậy ở chế độ trực tuyến.\n\n3.5.2.5. Sử dụng mã hóa khóa công khai để phân phối khóa bí mật\n\nDo các hệ mã hóa khóa công khai có ưu điểm là phân phối khóa công khai dễ dàng,\n\ncó thể sử dụng mã hóa khóa công khai để phân phối khóa bí mật. Giả thiết bên A cần\n\nchuyển khóa bí mật Ks cho bên B. Các bước hai bên A và B cần thực hiện để chuyển\n\nkhóa bí mật Ks từ A đến B sử dụng mã hóa khóa công khai như sau:\n\n- B tạo cặp khóa, khóa công khai Kp và khóa riêng Kr;\n\n- B gửi khóa công khai Kp của mình cho A (cần đảm bảo tính xác thực và toàn vẹn);\n\n- A sử dụng Kp để mã hóa khóa bí mật Ks tạo bản mã Cs và gửi cho B;\n\n- B sử dụng khóa riêng Kr để giải mã Cs để khôi phục khóa bí mật Ks.\n\nTrên thực tế, các giao thức SSL/TLS và PGP đều sử dụng mã hóa khóa công khai một\n\ncách hiệu quả để trao đổi khóa bí mật, hoặc dữ liệu khóa bí mật cho phiên làm việc. Chi\n\ntiết về các giao thức này được đề cập ở mục 3.6.\n\n3.5.3. Phân phối khóa công khai\n\n3.5.3.1. Giới thiệu\n\nKhác với khóa bí mật, việc phân phối khóa công khai thuận lợi hơn do khóa công khai\n\ncó thể trao đổi công khai giữa các thực thể tham gia truyền thông. Tuy nhiên, việc phân\n\nphối khóa công khai phải đảm bảo tính xác thực (authentic public keys). Tính xác thực\n\n---\n\n104\n\ncủa khóa công khai thể hiện ở 2 yếu tố: (1) tính toàn vẹn và chủ thể luôn xác định. Các\n\nphương pháp phân phối khóa công khai được sử dụng rộng rãi bao gồm:\n\n- Trao đổi kiểu điểm-điểm thông qua kênh tin cậy;\n\n- Truy nhập trực tiếp vào danh mục công cộng (public-key registry);\n\n- Sử dụng một máy chủ trực tuyến tin cậy;\n\n- Sử dụng một máy chủ không trực tuyến và chứng chỉ.\n\n## Phương pháp trao đổi khóa công khai kiểu điểm-điểm thông qua kênh tin cậy được\n\nthực hiện tương tự như phương pháp trao đổi khóa bí mật kiểu điểm-điểm đã được trình\n\nbày ở mục 3.5.2.2. Các phương pháp phân phối khóa công khai còn lại được trình bày\n\ntrong các mục tiếp theo.\n\n3.5.3.2. Truy nhập trực tiếp vào danh mục công cộng (public-key registry)\n\nTrong phương pháp này, một cơ sở dữ liệu công cộng tin cậy được thiết lập, trong đó\n\nmỗi bản ghi gồm tên người dùng và khóa công khai tương ứng. Cơ sở dữ liệu công cộng\n\nnày có thể được vận hành bởi 1 bên tin cậy và người dùng có thể truy nhập khóa công\n\nkhai từ cơ sở dữ liệu này nếu biết tên người dùng. Một phương pháp thực hiện được sử\n\ndụng phổ biến là cây xác thực khóa công khai (Tree authentication of public keys).\n\n3.5.3.3. Sử dụng một máy chủ trực tuyến tin cậy\n\n## Trong phương pháp này, một máy chủ trực tuyến tin cậy được sử dụng để cung cấp\n\ntruy nhập đến cơ sở dữ liệu công cộng các khóa công khai. Khóa công khai cần phân phối\n\nđược ký sử dụng khóa riêng của máy chủ và gửi cho bên yêu cầu. Phương pháp này\n\nkhông đòi hỏi phải sử dụng kênh truyền bí mật. Bên yêu cầu sử dụng khóa công khai của\n\nmáy chủ để xác thực chữ ký của máy chủ và qua đó kiểm tra tính xác thực, toàn vẹn của\n\nkhóa. Phương pháp này có nhược điểm là máy chủ phải luôn trực tuyến để hệ thống có\n\nthể hoạt động và bản thân máy chủ có thể trở thành điểm nút cổ chai trong hệ thống.\n\n3.5.3.4. Sử dụng một máy chủ không trực tuyến và chứng chỉ\n\n## Đây là phương pháp phân phối khóa dựa trên chứng chỉ khóa công khai (Public key\n\ncertificate) được sử dụng rất rộng rãi trong bảo mật thông tin truyền trên mạng Internet.\n\n## Các bước thực hiện của phương pháp này gồm:\n\n- Bên A liên hệ với một bên tin cậy (được gọi là Cơ quan cấp chứng chỉ -\n\n## Certification Authority (CA)) để đăng ký khóa công khai của mình và nhận được\n\nchữ ký xác nhận khóa công khai của CA;\n\n- CA cấp một chứng chỉ (Certificate) cho khóa công khai của A, trong đó kết hợp\n\nkhóa công khai của A với thông tin định danh của A sử dụng chữ ký số của CA;\n\n- Khi A đã có chứng chỉ khóa công khai (Public key certificate), A có thể gửi khóa\n\ncông khai cho các bên có liên quan bằng cách gửi chứng chỉ khóa công khai.\n\n- Chứng chỉ khóa công khai cũng có thể được đưa vào danh mục công cộng và\n\nngười dùng khác có thể truy nhập.\n\nChi tiết về chứng chỉ khóa công khai và quá trình cấp phát – sử dụng chứng chỉ đã\n\nđược đề cập ở các mục 3.4.2 và 3.4.3.\n\n---\n\n105\n\n3.6. Một số giao thức đảm bảo ATTT dựa trên mã hóa\n\n# 3.6.1. SSL/TLS\n\n3.6.1.1. Giới thiệu\n\nSSL (Secure Socket Layer) là giao thức bảo mật do công ty Netscape phát minh năm\n\n1993. Các phiên bản SSL được phát triển bao gồm: phiên bản 1.0 phát hành năm 1993,\n\nphiên bản 2.0 phát hành năm 1995 và phiên bản 3.0 phát hành năm 1996. Sau phiên bản\n\n3.0, SSL chính thức dừng phát triển. SSL hiện ít được sử dụng do có nhiều lỗi và không\n\nđược cập nhật.\n\nTLS (Transport Layer Security) được phát triển vào năm 1999 dựa trên SSL 3.0 do tổ\n\nchức IETF phê chuẩn. Các phiên bản của TLS gồm: phiên bản 1.0 phát hành năm 1999,\n\nphiên bản 1.1 phát hành năm 2005, phiên bản 1.2 phát hành năm 2008, phiên bản 1.3\n\nđược phát hành chính thức cho vào tháng 10 năm 2017. Hiện nay phiên bản TLS 1.3\n\nđược sử dụng rộng rãi nhất, còn SSL chỉ được giữ lại tên với lý do lịch sử.\n\nHình 3.39 biểu diễn vị trí của giao thức SSL/TLS trong chồng giao thức TCP/IP. Có\n\nthể thấy SSL/TLS hoàn toàn độc lập với các giao thức tầng ứng dụng nên nó có thể được\n\nsử dụng để bảo mật thông tin truyền cho nhiều giao thức ứng dụng khác nhau, như\n\nHTTP, SMTP và FTP. Chẳng hạn, giao thức bảo mật web HTTPS = HTTP + SSL/TLS,\n\ncó nghĩa là HTTPS tạo ra bởi HTTP chạy trên nền SSL/TLS. Một trong các điều kiện để\n\nSSL/TLS có thể hoạt động là ít nhất một thực thể (thường là máy chủ) tham gia phiên\n\ntruyền thông phải có chứng chỉ số cho khoá công khai (Public key certificate).\n\n## Hình 3.39. SSL/TLS trong bộ giao thức TCP/IP\n\n## Hình 3.40. Các giao thức con của SSL/TLS\n\n## SSL/TLS là một bộ gồm có 4 giao thức con, như minh họa trên Hình 3.40. Các giao\n\nthức con của SSL/TLS gồm:\n\n---\n\n106\n\n- SSL Handshake Protocol: Giao thức bắt tay của SSL có nhiệm vụ trao đổi các\n\nthông điệp xác thực thực thể và thiết lập các thông số cho phiên làm việc;\n\n- SSL Change Cipher Spec Protocol: Giao thức thiết lập việc sử dụng các bộ mã hóa\n\nđược hỗ trợ bởi cả 2 bên tham gia phiên truyền thông;\n\n- SSL Alert Protocol: Giao thức cảnh bảo của SSL;\n\n- SSL Record Protocol: Giao thức bản ghi của SSL có nhiệm vụ tạo đường hầm an\n\ntoàn để chuyển thông tin đảm bảo tín bí mật, toàn vẹn và xác thực.\n\n3.6.1.2. Hoạt động của SSL/TS\n\nHình 3.41 biểu diễn mô hình một phiên truyền thông giữa máy chủ web (Web Server)\n\nvà máy khách web (Browser) dựa trên SSL/TLS. Theo đó, giao thức Bắt tay (Handshake)\n\nkhởi tạo phiên làm việc (có sự hỗ trợ của giao thức Change Cipher Spec), giao thức Bản\n\nghi (Record) vận chuyển dữ liệu an toàn và giao thức Cảnh báo (Alert) gửi các cảnh báo\n\nkhi xảy ra lỗi, hoặc một sự kiện đặc biệt.\n\n## Hình 3.41. Mô hình truyền thông giữa Web Server và Browser dựa trên SSL/TLS\n\na. Khởi tạo phiên làm việc\n\nQuá trình khởi tạo phiên làm việc trong SSL/TLS được thực hiện bởi giao thức SSL\n\nHandshake với sự hỗ trợ của giao thức SSL Change Cipher Spec. Các nhiệm vụ được các\n\nbên tham gia truyền thông thực hiện trong quá trình này bao gồm: (1) xác thực thông tin\n\nnhận dạng, (2) đàm phán thống nhất các bộ mã hóa sử dụng và (3) trao đổi khóa và các\n\nthông số khác cho phiên truyền thông.\n\n## Quá trình khởi tạo phiên làm việc biểu diễn trên Hình 3.42 giữa SSL Client (máy\n\nkhách) và SSL Server (máy chủ) gồm các bước sau:\n\n1. SSL Client gửi thông điệp “client hello” và thông tin mã hóa (Cryptographic\n\ninformation) đến SSL Server;\n\n2. SSL Server gửi thông điệp “server hello”, các bộ mã hóa hỗ trợ (CipherSuite) và\n\nchứng chỉ máy chủ (Server certificate) đến SSL Client. SSL Server cũng có thể\n\ngửi yêu cầu máy khách cung cấp chứng chỉ máy khách (Client certificate) nếu cần\n\nthiết;\n\n3. Nhận được yêu cầu, SSL Client kiểm tra chứng chỉ máy chủ và kiểm tra các tham\n\nsố mã hóa. Hai bên thống nhất sử dụng các bộ mã hóa tốt nhất cùng hỗ trợ cho\n\nphiên làm việc. Nếu chứng chỉ máy chủ không hợp lệ quá trình quá trình khởi tạo\n\n---\n\n107\n\nphiên kết thúc không thành công. Nếu chứng chỉ máy chủ hợp lệ tiếp tục bước tiếp\n\ntheo;\n\n4. Trao đổi khóa máy khách (Client key exchange). SSL Client sinh khóa phiên\n\n(hoặc các tham số mã hóa cho phiên), mã hóa khóa phiên sử dụng khóa công khai\n\ncủa SSL Server lấy từ chứng chỉ máy chủ và gửi cho SSL Server;\n\n5. SSL Client cũng có thể gửi chứng chỉ máy khách cho máy chủ nếu được yêu cầu;\n\n6. SSL Server sử dụng khóa riêng của mình để giải mã khôi phục khóa phiên gửi từ\n\nSSL Client. SSL Server cũng có thể kiểm tra chứng chỉ máy khách nếu cần thiết;\n\n7. Client gửi thông điệp kết thúc khởi tạo phiên “Finished”;\n\n8. Server gửi thông điệp kết thúc khởi tạo phiên “Finished”.\n\n## Hình 3.42. Khởi tạo phiên làm việc trong SSL/TLS\n\nSau khi quá trình khởi tạo thành công, hai bên SSL Client và SSL Server xác thực\n\nđược các thông tin nhận dạng của nhau sử dụng chứng chỉ số, thống nhất các bộ mã hóa\n\ntốt nhất sử dụng và trao đổi được các khóa phiên, hoặc các tham số mã hóa phiên, hai bên\n\nthiết lập thành công kênh bảo mật cho truyền dữ liệu trong phiên.\n\nb. Vận chuyển dữ liệu an toàn\n\n## Quá trình vận chuyển dữ liệu an toàn thực hiện bởi giao thức SSL Record sau khi\n\nkhởi tạo phiên làm việc thành công. Giao thức SSL Record sử dụng các tham số mã hóa\n\nvà các bộ mã hóa thiết lập trong quá trình khởi tạo để tạo đường hầm vận chuyển dữ liệu\n\nan toàn. SSL Record đảm bảo tính bí mật cho khối dữ liệu sử dụng mã hóa đối xứng với\n\nkhóa phiên, và đảm bảo tính toàn vẹn và xác thực cho khối dữ liệu sử dụng hàm băm có\n\nkhóa (MAC). Hình 3.43 biểu diễn quá trình xử lý dữ liệu bởi SSL Record tại bên gửi,\n\ngồm các bước:\n\n---\n\n108\n\n## Hình 3.43. Quá trình xử lý dữ liệu bởi SSL Record tại bên gửi\n\n- Phân mảnh dữ liệu (Fragment): Dữ liệu từ ứng dụng (Application Data) được phân\n\nmảnh thành các khối cho phù hợp với việc đóng gói và truyền của các lớp giao\n\nthức tầng thấp hơn;\n\n- Nén dữ liệu (Compress): Từng khối dữ liệu được được nén để giảm kích thước.\n\nBước nén dữ liệu là không bắt buộc;\n\n- Thêm MAC (Add MAC): Tính toán giá trị MAC (sử dụng hàm băm có khóa) cho\n\nkhối dữ liệu nén và ghép giá trị MAC vào khối dữ liệu. Việc thêm MAC và kiểm\n\ntra MAC ở bên nhận để đảm bảo tính toàn vẹn và xác thực khối dữ liệu;\n\n- Mã hóa (Encrypt): Mã hóa khối dữ liệu (gồm khối dữ liệu nén và MAC) để đảm\n\nbảo tính bí mật sử dụng mã hóa khóa đối xứng với khóa phiên;\n\n- Thêm đề mục của SSL Record (Append SSL Record Header): thêm đề mục của\n\n## SSL Record vào khối dữ liệu đã mã hóa và chuyển xuống tầng giao vận để chuyển\n\nsang bên nhận.\n\nQuá trình xử lý dữ liệu khối dữ liệu nhận được tại bên nhận được thực hiện bởi SSL\n\nRecord theo trình tự ngược lại, gồm các bước: Tách đề mục của SSL Record, Giải mã,\n\n## Tách và kiểm tra MAC, Giải nén và Ghép các mảnh dữ liệu thành chuỗi dữ liệu để\n\nchuyển cho lớp ứng dụng.\n\n# 3.6.2. SET\n\nSET (Secure Electronic Transaction) là giao thức cho phép thanh toán điện tử an toàn\n\nsử dụng thẻ tín dụng do 2 công ty Visa International và MasterCard (Hoa Kỳ) phát triển.\n\nSET có khả năng đảm bảo các thuộc tính bí mật, toàn vẹn thông tin truyền, xác thực tài\n\nkhoản chủ thẻ và xác thực nhà cung cấp.\n\nHình 3.44 biểu diễn một mô hình tương tác giữa các thực thể tham gia thực hiện SET.\n\nCác thực thể tham gia mô hình này gồm: Chủ thẻ/Khách hàng (Cardholder), Nhà cung\n\ncấp dịch vụ/Người bán hàng (Merchant), Cổng thanh toán (Payment Gateway), Ngân\n\nhàng của nhà cung cấp/Ngân hàng của người bán (Acquirer), Ngân hàng của chủ\n\n---\n\n109\n\nthẻ/Ngân hàng của người mua (Issuer) và Nhà cung cấp chứng chỉ (Certificate\n\nAuthority). Tất cả các bên tham gia quá trình xử lý giao dịch thanh toán (Cardholder,\n\n## Merchant, Payment Gateway, Acquirer, Issuer) đều phải đăng ký với Nhà cung cấp\n\nchứng chỉ và được cấp chứng chỉ khóa công khai. Các chứng chỉ khóa công khai được\n\ncác bên sử dụng để xác thực thông tin nhận dạng của nhau và hỗ trợ trao đổi khóa. Quá\n\ntrình thực hiện một giao dịch dựa trên SET gồm các bước sau:\n\n## Hình 3.44. Một mô hình tương tác giữa các thực thể tham gia SET\n\n1. Khách hàng xem các sản phẩm trên website của Người bán hàng và quyết định các\n\nmặt hàng sẽ mua;\n\n2. Khách hàng gửi thông điệp gồm thông tin đơn hàng và thanh toán gồm 2 phần: (i)\n\n## Đơn hàng – dành cho Người bán hàng  và (ii) Thông tin thẻ - dành cho hệ thống\n\nthanh toán;\n\n3. Người bán hàng chuyển thông tin thẻ cho Cổng thanh toán. Cổng thanh toán\n\nchuyển tiếp cho Ngân hàng của người bán;\n\n4. Ngân hàng của người bán gửi yêu cầu xác thực giao dịch thanh toán đến Ngân\n\nhàng của người mua;\n\n5. Ngân hàng của người mua gửi xác nhận giao dịch đến Ngân hàng của người bán;\n\n6. Ngân hàng của người bán gửi xác nhận giao dịch đến Người bán hàng;\n\n7. Người bán hàng hoàn tất đơn hàng và gửi xác nhận đơn hàng đến Khách hàng;\n\n8. Người bán hàng ghi nhận giao dịch theo thông tin từ Ngân hàng người bán cung\n\ncấp;\n\n9. Ngân hàng của người mua in hóa đơn giao dịch cho thẻ tín dụng của Khách hàng.\n\n# 3.6.3. PGP\n\na. Giới thiệu\n\nPGP (Pretty Good Privacy) là phương pháp bảo mật do Philip Zimmermann phát triển\n\nnăm 1991 có khả năng cung cấp tính riêng tư và tính xác thực các thông điệp truyền. PGP\n\n---\n\n110\n\nđược sử dụng rộng rãi và đã được thừa nhận thành chuẩn thực tế (RFC 3156). PGP hỗ trợ\n\nmã hoá dữ liệu sử dụng mã hoá khoá bí mật và mã hóa khoá công khai, đồng thời cho\n\nphép tạo và kiểm tra chữ ký số.\n\nPGP được sử dụng rộng rãi để truyền email và file an toàn. PGP hỗ trợ hầu hết các\n\ngiải thuật mã hóa hiện đại như 3DES, AES, IDEA, RSA, ElGamal. Có nhiều bản cài đặt\n\n## PGP trên thực tế như OpenPGP, GnuPG, Gpg4win,….\n\nb. Hoạt động của PGP\n\n## PGP hỗ trợ 3 mô hình hoạt động, bao gồm (1) Mô hình PGP chỉ đảm bảo tính xác\n\nthực thông điệp, (2) Mô hình PGP chỉ đảm bảo tính bí mật thông điệp và (3) Mô hình\n\nPGP đảm bảo tính bí mật và xác thực thông điệp. Để thuận tiện cho mô tả hoạt động của\n\ncác mô hình PGP, gọi H là hàm băm một chiều, EC là hàm mã hóa khóa đối xứng, DC là\n\nhàm giải mã khóa đối xứng, EP là hàm mã hóa khóa bất đối xứng, DP là hàm giải mã\n\nkhóa bất đối xứng, Z là hàm nén, Z-1 là hàm giải nén, PUa là khóa công khai của bên A,\n\nPRa là khóa riêng của bên A, PUb là khóa công khai của bên B, PRb là khóa riêng của\n\nbên B và Ks là khóa phiên. Phần tiếp theo trình bày chi tiết về hoạt động của các mô hình\n\nnày.\n\n## Bên gửi\n\n====>\n\n## Bên nhận\n\n## Hình 3.45. Mô hình PGP chỉ đảm bảo tính xác thực thông điệp\n\nHình 3.45 biểu diễn mô hình PGP chỉ đảm bảo tính xác thực thông điệp truyền. Theo\n\nđó, mô hình này sử dụng chữ ký số để xác thực tính toàn vẹn và chủ thể gửi thông điệp.\n\nĐiều kiện thực hiện mô hình này là bên gửi A phải sở hữu cặp khóa (khóa công khai PUa\n\nvà khóa riêng PRa). Quá trình thực hiện gửi/nhận thông điệp M đảm bảo tính xác thực tại\n\nmỗi bên như sau:\n\n- Bên gửi A:\n\n+ Tính toán giá trị băm (giá trị đại diện) của thông điệp M sử dụng hàm băm H;\n\n+ Sử dụng khóa riêng PRa để mã hóa (ký) giá trị băm của M tạo thành chữ ký số;\n\n+ Ghép chữ ký số vào thông điệp M;\n\n+ Nén thông điệp và chữ ký số sử dụng hàm nén Z;\n\n+ Gửi bản dữ liệu đã nén cho người nhận.\n\n- Bên nhận B:\n\n+ Giải nén dữ liệu nhận được sử dụng hàm Z-1;\n\n---\n\n111\n\n+ Tách chữ ký số khỏi thông điệp M và sử dụng khóa công khai của bên gửi PUa\n\nđể kiểm tra (giải mã) chữ ký số để khôi phục giá trị băm h1. Bên gửi A có thể sử\n\ndụng các phương pháp trao đổi khóa công khai đã nêu ở mục 3.5.3 để chuyển\n\nkhóa công khai PUa cho bên nhận;\n\n+ Tính toán giá trị băm h2 của thông điệp M sử dụng hàm băm H;\n\n+ So sánh 2 giá trị băm h1 và h2, nếu h1 = h2 thì thông điệp truyền là toàn vẹn và\n\nthông điệp được gửi bởi bên gửi A. Nếu h1 ≠ h2 thì thông điệp M có thể đã bị\n\nsửa đổi, hoặc không được ký và gửi bởi bên gửi A.\n\n## Bên gửi\n\n====>\n\n## Bên nhận\n\n## Hình 3.46. Mô hình PGP chỉ đảm bảo tính bí mật thông điệp\n\n## Hình 3.46 biểu diễn mô hình PGP chỉ đảm bảo tính bí mật thông điệp truyền. Theo\n\nđó, mô hình này sử dụng kết hợp giữa mã hóa khóa đối xứng và mã hóa khóa bất đối\n\nxứng để đảm bảo tính bí mật của thông điệp. Điều kiện thực hiện mô hình này là bên\n\nnhận B phải sở hữu cặp khóa (khóa công khai PUb và khóa riêng PRb). Quá trình thực\n\nhiện gửi/nhận thông điệp M đảm bảo tính bí mật tại mỗi bên như sau:\n\n- Bên gửi A:\n\n+ Nén thông điệp M sử dụng hàm nén Z;\n\n+ Sinh khóa phiên Ks và sử dụng khóa Ks để mã hóa thông điệp M sử dụng hàm\n\nmã hóa đối xứng EC;\n\n+ Sử dụng khóa công khai PUb của bên nhận B để mã hóa khóa phiên Ks sử dụng\n\nhàm mã hóa bất đối xứng EP. Bên nhận B có thể sử dụng các phương pháp trao\n\nđổi khóa công khai đã nêu ở mục 3.5.3 để chuyển khóa công khai PUb cho bên\n\ngửi;\n\n+ Ghép chữ bản mã của Ks vào bản mã của thông điệp M;\n\n+ Gửi bản mã dữ liệu cho người nhận.\n\n- Bên nhận B:\n\n+ Tách bản mã của Ks vào bản mã của thông điệp M;\n\n+ Giải mã bản mã Ks sử dụng hàm giải mã khóa bất đối xứng DP và khóa riêng\n\nPRb để khôi phục Ks;\n\n+ Sử dụng khóa phiên Ks và hàm giải mã khóa đối xứng DC để giải mã khôi phục\n\nthông điệp đã nén M;\n\n+ Giải nén khôi phục thông điệp M sử dụng hàm Z-1;\n\n---\n\n112\n\n## Bên gửi\n\n===>\n\n## Bên nhận\n\n## Hình 3.47. Mô hình PGP đảm bảo tính bí mật và xác thực thông điệp\n\nHình 3.47 biểu diễn mô hình PGP đảm bảo tính xác thực và bí mật thông điệp truyền.\n\nTheo đó, mô hình này sử dụng chữ ký số để xác thực tính toàn vẹn và chủ thể gửi thông\n\nđiệp. Đồng thời mô hình sử dụng kết hợp giữa mã hóa khóa đối xứng và mã hóa khóa bất\n\nđối xứng để đảm bảo tính bí mật của thông điệp. Điều kiện thực hiện mô hình này là bên\n\ngửi A phải sở hữu cặp khóa (khóa công khai PUa và khóa riêng PRa) và bên nhận B phải\n\nsở hữu cặp khóa (khóa công khai PUb và khóa riêng PRb). Mô hình này là sự kết hợp của\n\nmô hình PGP chỉ đảm bảo tính xác thực và mô hình PGP chỉ đảm bảo tính bí mật. Theo\n\nđó, bên gửi A thực hiện ký và mã hóa thông điệp, còn bên nhận B thực hiện giải mã và\n\nkiểm tra chữ ký của thông điệp.\n\n3.7. Câu hỏi ôn tập\n\n1) Mã hóa thông tin là gì? Nêu vai trò của mã hóa.\n\n2) Mô tả các thành phần của một hệ mã hóa.\n\n3) Mô tả các phương pháp mã hóa dòng và mã hóa khối.\n\n4) Nêu các ứng dụng của mã hóa.\n\n5) Mô tả phương pháp mã hóa thay thế (substitution).\n\n6) Mô tả phương pháp mã hóa hoán vị (permutation).\n\n7) Mô tả phương pháp mã hóa XOR.\n\n8) Vẽ sơ đồ hoạt động và nêu các đặc điểm hệ mã hóa khóa đối xứng.\n\n9) Vẽ sơ đồ hoạt động và nêu các đặc điểm hệ mã hóa khóa bất đối xứng.\n\n10) Nêu các đặc điểm và mô tả các bước xử lý dữ liệu của giải thuật mã hóa DES.\n\n11) Nêu các đặc điểm và mô tả các bước xử lý dữ liệu của giải thuật mã hóa AES.\n\n12) Nêu các đặc điểm, thủ tục sinh khóa, mã hóa và giải mã của giải thuật mã hóa RSA.\n\n13) Nêu các yêu cầu đảm bảo an toàn của quá trình sinh khóa RSA.\n\n14) Nêu các đặc điểm và mô tả các bước xử lý dữ liệu của giải thuật băm MD5.\n\n15) Nêu các đặc điểm và mô tả các bước xử lý dữ liệu của giải thuật băm SHA1.\n\n16) Chữ ký số là gì? Mô tả quá trình tạo chữ ký và kiểm tra chữ ký của một thông điệp.\n\n17) Chứng chỉ số khóa công khai là gì? Nêu 3 thành phần quan trọng nhất của 1 chứng chỉ\n\nsố khóa công khai. Nêu các ứng dụng của chứng chỉ số khóa công khai.\n\n18) PKI là gì? Nêu các thành phần và mô tả lưu đồ cấp và sử dụng chứng chỉ trong PKI.\n\n---\n\n113\n\n19) Mô tả cơ chế hoạt động của phương pháp phân phối khóa dựa trên KDC, KTC.\n\n20) Mô tả quá trình khởi tạo phiên làm việc trong SSL/TLS.\n\n21) Mô tả quá trình xử lý dữ liệu bởi SSL Record tại bên gửi và bên nhận.\n\n22) Mô tả hoạt động của mô hình PGP chỉ đảm bảo tính xác thực và mô hình PGP chỉ\n\nđảm bảo tính bí mật.\n\n---\n\n114\n\n# CHƯƠNG 4. CÁC KỸ THUẬT VÀ CÔNG NGHỆ ĐẢM BẢO\n\n# AN TOÀN THÔNG TIN\n\nChương 4 giới thiệu khái quát về các kỹ thuật và công nghệ đảm bảo an toàn thông\n\ntin, vấn đề kiểm soát truy cập, các biện pháp kiểm soát truy cập và một số công nghệ\n\nkiểm soát truy cập được sử dụng trên thực tế. Phần tiếp theo của chương giới thiệu về\n\ntường lửa – một trong những kỹ thuật được sử dụng rất phổ biến trong đảm bảo an toàn\n\ncho hệ thống máy tính và mạng. Phần cuối của chương giới thiệu về các hệ thống phát\n\nhiện và ngăn chặn xâm nhập.\n\n4.1. Khái quát về các kỹ thuật và công nghệ đảm bảo ATTT\n\nTrong an toàn thông tin, có nhiều kỹ thuật và công nghệ đảm bảo an toàn cho thông\n\ntin, hệ thống và mạng trong các lĩnh vực khác nhau của an toàn thông tin, như minh họa\n\ntrên Hình 4.1.\n\n## Hình 4.1. Các kỹ thuật và công nghệ bảo mật trong các lĩnh vực của ATTT\n\nTheo đó, các kỹ thuật, công nghệ và giải pháp đảm bảo an toàn thông tin bao gồm:\n\n- Trong lĩnh vực an ninh mạng (Network Security):\n\n+ An toàn ứng dụng (Application Security)\n\n+ Kỹ nghệ an toàn (Security Engineering)\n\n+ Kiểm thử lỗ hổng (Vulnerability Testing)\n\n+ Kiểm thử xâm nhập (Penentration Testing)\n\n+ Các hệ thống phát hiện xâm nhập (Intrusion Detection Systems)\n\n+ Tường lửa (Firewalls).\n\n- Trong lĩnh vực an ninh thiết bị đầu cuối (End Point Security):\n\n---\n\n115\n\n+ Kiểm soát truy cập\n\n+ Bảo mật email (Email Security)\n\n+ Mạng VPNs\n\n+ Mã hóa (Encryption)\n\n+ Quét và ngăn chặn phần mềm độc hại (Anti-Malware).\n\n- Trong lĩnh vực an ninh Internet (Internet Security):\n\n+ Secure HTTP (HTTPS)\n\n+ Chứng chỉ SSL (SSL Certificate)\n\n+ Chuẩn xác thực mở (OAuth 2.0).\n\n- Trong lĩnh vực an ninh đám mây (Cloud Security):\n\n+ Chuẩn xác thực mở (OAuth 2.0)\n\n+ Web Sockets.\n\n- Trong lĩnh vực an ninh mạng không dây (Wireless Security):\n\n+ Mã hóa (Encryption)\n\n+ Kiểm soát truy cập.\n\nChương 2 của tài liệu này đã đề cập đến một số kỹ thuật và giải pháp phân tích, kiểm\n\nthử lỗ hổng bảo mật, kiểm thử xâm nhập và vấn đề rà quét và ngăn chặn phần mềm độc\n\nhại. Chương 3 đã trình bày các kỹ thuật và giải pháp dựa trên mã hóa cho đảm bảo an\n\ntoàn thông tin, bao gồm chứng chỉ SSL, PGP cho bảo mật file và email, giao thức bảo\n\nmật SSL/TLS nền tảng cho HTTPS. Trong phạm vi của môn học này, chương này tiếp\n\ntục trình bày một số kỹ thuật, công nghệ và giải pháp quan trọng khác cho đảm bảo an\n\ntoàn thông tin bao gồm, Kiểm soát truy cập, Tường lửa và Các hệ thống phát hiện tấn\n\ncông, xâm nhập.\n\n4.2. Kiểm soát truy cập\n\n4.2.1. Khái niệm kiểm soát truy cập\n\nKiểm soát truy cập (Access control) là quá trình mà trong đó người dùng được nhận\n\ndạng và trao quyền truy nhập đến các thông tin, các hệ thống và tài nguyên. Một hệ\n\nthống kiểm soát truy cập có thể được cấu thành từ 3 dịch vụ: Xác thực (Authentication),\n\n## Trao quyền, hoặc cấp quyền (Authorization) và Quản trị (Administration).\n\nXác thực là quá trình xác minh tính chân thực của các thông tin nhận dạng mà người\n\ndùng cung cấp. Đây là khâu đầu tiên cần thực hiện trong một hệ thống kiểm soát truy cập.\n\nCần nhớ rằng, xác thực chỉ có khả năng khẳng định các thông tin nhận dạng mà người\n\ndùng cung cấp tồn tại trong hệ thống mà thường không thể xác minh chủ thể thực sự của\n\nthông tin đó. Sau khi người dùng đã được xác thực, trao quyền xác định các tài nguyên\n\nmà người dùng được phép truy cập dựa trên chính sách quản trị tài nguyên của cơ quan,\n\ntổ chức và vai trò của người dùng trong hệ thống.\n\nQuản trị là dịch vụ cung cấp khả năng thêm, bớt và sửa đổi các thông tin tài khoản\n\nngười dùng, cũng như quyền truy cập của người dùng trong hệ thống. Mặc dù quản trị\n\n---\n\n116\n\nkhông trực tiếp tham gia vào quá trình xác thực và trao quyền cho người dùng, quản trị là\n\ndịch vụ không thể thiếu trong một hệ thống kiểm soát truy cập.\n\nMục đích chính của kiểm soát truy cập là để đảm bảo tính bí mật, toàn vẹn và sẵn\n\ndùng hoặc khả dụng của thông tin, hệ thống và các tài nguyên. Đây cũng là các yêu cầu\n\nđảm bảo an toàn thông tin và hệ thống thông tin đã đề cập trong CHƯƠNG 1.\n\n4.2.2. Các biện pháp kiểm soát truy cập\n\n## Các biện pháp hay cơ chế (mechanism) kiểm soát truy cập là các phương pháp thực\n\nhiện kiểm soát truy cập, gồm 4 loại chính:\n\n- Kiểm soát truy cập tuỳ chọn – Discretionary Access Control (DAC)\n\n- Kiểm soát truy cập bắt buộc – Mandatory Access Control (MAC)\n\n- Kiểm soát truy cập dựa trên vai trò – Role-Based Access Control (RBAC) và\n\n- Kiểm soát truy cập dựa trên luật – Rule-Based Access Control.\n\n4.2.2.1. Kiểm soát truy cập tuỳ chọn\n\nKiểm soát truy cập tuỳ chọn (còn gọi là tùy quyền) được định nghĩa là các cơ chế hạn\n\nchế truy cập đến các đối tượng dựa trên thông tin nhận dạng của các chủ thể, hoặc nhóm\n\ncủa các chủ thể. Các thông tin nhận dạng chủ thể (còn gọi là các nhân tố - factor) có thể\n\ngồm:\n\n- Bạn là ai? (CMND, bằng lái xe, vân tay,...)\n\n- Những cái bạn biết (tên truy nhập, mật khẩu, số PIN...)\n\n- Bạn có gì? (Thẻ ATM, thẻ tín dụng, ...)\n\nĐặc điểm nổi bật của kiểm soát truy cập tuỳ chọn là cơ chế này cho phép người dùng\n\ncó thể cấp hoặc huỷ quyền truy cập cho các người dùng khác đến các đối tượng thuộc\n\nquyền điều khiển của họ. Điều này cũng có nghĩa là chủ sở hữu của các đối tượng (owner\n\nof objects) là người có toàn quyền điều khiển các đối tượng này. Chẳng hạn, trong một hệ\n\nthống nhiều người dùng, mỗi người dùng được cấp 1 thư mục riêng (home directory) và\n\nlà chủ sở hữu của thư mục này. Người dùng có quyền tạo, sửa đổi và xoá các file trong\n\nthư mục của riêng mình. Người dùng cũng có khả năng cấp hoặc huỷ quyền truy cập vào\n\ncác file của mình cho các người dùng khác.\n\nCó nhiều kỹ thuật thực hiện cơ chế kiểm soát truy cập tuỳ chọn trên thực tế, trong đó\n\n2 kỹ thuật được sử dụng rộng rãi nhất là Ma trận kiểm soát truy cập (Access Control\n\nMatrix - ACM) và Danh sách kiểm soát truy cập (Access Control List - ACL). Ma trận\n\nkiểm soát truy cập là một phương pháp thực hiện kiểm soát truy cập thông qua 1 ma trận\n\n2 chiều gồm chủ thể (subject), đối tượng (object) và các quyền truy cập, như biểu diễn\n\ntrên Hình 4.2. Các đối tượng, hay khách thể (Objects) là các thực thể cần bảo vệ, được ký\n\nhiệu là O1, O2, O3,.... Các đối tượng có thể là các file, các thư mục hay các tiến trình\n\n(process). Các chủ thể (Subjects) là người dùng (users), hoặc các tiến trình tác động lên\n\ncác đối tượng, được ký hiệu là S1, S2, S3,... Quyền truy cập là hành động mà chủ thể thực\n\nhiện trên đối tượng. Các quyền bao gồm r (read – đọc), w (write - ghi), x (execute – thực\n\nhiện) và o (own – chủ sở hữu).\n\n---\n\n117\n\n## Hình 4.2. Mô hình ma trận kiểm soát truy cập\n\nƯu điểm của ma trận kiểm soát truy cập là đơn giản, trực quan và dễ sử dụng. Tuy\n\nnhiên, khi số lượng các đối tượng và số lượng các chủ thể lớn, kích thước của ma trận sẽ\n\nrất lớn. Hơn nữa, quyền truy cập của các chủ thể vào các đối tượng là khác nhau, trong\n\nđó một số chủ thể không có quyền truy cập vào một số đối tượng, và như vậy ô nhớ chứa\n\nquyền truy cập của chủ thể vào đối tượng là rỗng. Trong ma trận kiểm soát truy cập có\n\nthể tồn tại rất nhiều ô rỗng và điều này làm giảm hiệu quả sử dụng bộ nhớ của phương\n\npháp này. Do vậy, ma trận kiểm soát truy cập ít được sử dụng hiện nay trên thực tế.\n\n## Danh sách kiểm soát truy cập (ACL) là một danh sách các quyền truy cập của một\n\nchủ thể đối với một đối tượng. Một danh sách kiểm soát truy cập chỉ ra các người dùng\n\nhoặc tiến trình được truy cập vào đối tượng nào và các thao tác cụ thể (hay quyền) được\n\nthực hiện trên đối tượng đó. Một bản ghi điển hình của ACL có dạng (subject, operation).\n\nVí dụ bản ghi (Alice, write) của 1 file có nghĩa là Alice có quyền ghi vào file đó. Khi chủ\n\nthể yêu cầu truy cập, hệ điều hành sẽ kiểm tra ACL xem yêu cầu đó có được phép hay\n\nkhông. ACL có thể được áp dụng cho một hoặc 1 nhóm đối tượng.\n\n# F2\n\n# F1\n\n# F3\n\n# A\n\n# A: RW; B: R\n\n# A: R; B: RW; C:R\n\n# B: RWX; C: RX\n\n## User\n\nspace\n\n## Kernel\n\nspace\n\n# ACL\n\n## Files\n\n# B\n\n# C\n\n# ACL\n\n## Profiles\n\n## Hình 4.3. Mô hình danh sách kiểm soát truy cập\n\n## Hình 4.3 biểu diễn mô hình danh sách kiểm soát truy cập trong không gian người\n\ndùng (user space) và không gian nhân (kernel space) tổ chức bởi hệ điều hành. Mỗi file\n\n(F1, F2, F3,...) có một danh sách kiểm soát truy cập (ACL) của riêng mình lưu trong hồ\n\n---\n\n118\n\nsơ (profile) của file. Quyền truy cập vào file được tổ chức thành một chuỗi gồm nhiều\n\ncặp (subject, operation), với A, B, C là ký hiệu biểu diễn chủ thể (subject) và các thao tác\n\n(operation) hay quyền gồm R (Read - đọc), W (Write - ghi), và X (eXecute - thực hiện).\n\nChẳng hạn, trong danh sách kiểm soát truy cập F1(A: RW; B: R) thì chủ thể A được\n\nquyền đọc (R) và ghi (W) đối với F1, còn chủ thể B chỉ có quyền đọc (R).\n\n4.2.2.2. Kiểm soát truy cập bắt buộc\n\nĐiều khiển truy bắt buộc (MAC) được định nghĩa là các cơ chế hạn chế truy cập đến\n\ncác đối tượng dựa trên hai yếu tố chính:\n\n- Tính nhạy cảm (sensitivity) của thông tin chứa trong các đối tượng, và\n\n- Sự trao quyền chính thức (formal authorization) cho các chủ thể truy cập các thông\n\ntin nhạy cảm này.\n\n## Các thông tin nhạy cảm thường được gán nhãn với các mức nhạy cảm (Sensitivity\n\nlevel). Có nhiều phương pháp phân chia các mức nhạy cảm của các thông tin tùy thuộc\n\nvào chính sách an toàn thông tin của các cơ quan, tổ chức. Các mức nhạy cảm thường\n\nđược sử dụng gồm:\n\n- Tối mật (Top Secret - T): Được áp dụng với thông tin mà nếu bị lộ có thể dẫn đến\n\nnhững thiệt hại trầm trọng đối với an ninh quốc gia.\n\n- Tuyệt mật (Secret - S): Được áp dụng với thông tin mà nếu bị lộ có thể dẫn đến\n\nmột loạt thiệt hại đối với an ninh quốc gia.\n\n- Mật (Confidential - C): Được áp dụng với thông tin mà nếu bị lộ có thể dẫn đến\n\nthiệt hại đối với an ninh quốc gia.\n\n- Không phân loại (Unclassified - U): Những thông tin không gây thiệt hại đối với\n\nan ninh quốc gia nếu bị tiết lộ.\n\nĐặc điểm nổi bật của cơ chế kiểm soát truy cập bắt buộc là nó không cho phép người\n\ntạo ra các đối tượng (thông tin, hoặc tài nguyên) có toàn quyền truy cập các đối tượng\n\nnày. Quyền truy cập đến các đối tượng do người quản trị hệ thống định ra trước trên cơ\n\nsở chính sách an toàn thông tin của tổ chức đó. Đây cũng là điểm khác biệt hoàn toàn với\n\ncơ chế kiểm soát truy cập tùy chọn, trong đó người tạo ra các đối tượng là chủ sở hữu và\n\ncó toàn quyền đối với các đối tượng họ tạo ra. Ví dụ như, một tài liệu được tạo ra và được\n\nđóng dấu “Mật” thì chỉ những người có trách nhiệm trong cơ quan, tổ chức mới được\n\nquyền xem và phổ biến cho người khác, còn bản thân tác giả của tài liệu không được\n\nquyền phổ biến đến người khác. Cơ chế kiểm soát truy cập bắt buộc thường được sử\n\ndụng phổ biến trong các cơ quan an ninh, quân đội và ngân hàng.\n\nCó nhiều kỹ thuật thực hiện cơ chế kiểm soát truy cập bắt buộc, trong đó mô hình\n\nkiểm soát truy cập Bell-LaPadula là một trong các kỹ thuật được sử dụng rộng rãi nhất.\n\nMô hình Bell-LaPadula là mô hình bảo mật đa cấp thường được sử dụng trong quân sự,\n\nnhưng nó cũng có thể áp dụng cho các lĩnh vực khác. Theo mô hình này trong quân sự,\n\ncác tài liệu được gán một mức độ bảo mật, chẳng hạn như không phân loại, mật, bí mật\n\nvà tối mật. Người dùng cũng được ấn định các cấp độ bảo mật, tùy thuộc vào những tài\n\nliệu mà họ được phép xem. Chẳng hạn, một vị tướng quân đội có thể được phép xem tất\n\n---\n\n119\n\ncả các tài liệu, trong khi một trung úy có thể bị hạn chế chỉ được xem các tài liệu mật và\n\nthấp hơn. Đồng thời, một tiến trình chạy nhân danh một người sử dụng có được mức độ\n\nbảo mật của người dùng đó.\n\n## Mô hình Bell-LaPadula sử dụng nguyên tắc “đọc xuống” (read down) và nguyên tắc\n\n“ghi lên” (write up) để đảm bảo an toàn trong việc cấp quyền truy cập cho người dùng\n\nđến các đối tượng. Với nguyên tắc “đọc xuống”, một người dùng ở mức độ bảo mật k chỉ\n\ncó thể đọc các đối tượng ở cùng mức bảo mật hoặc thấp hơn. Ví dụ, một vị tướng có thể\n\nđọc các tài liệu của một trung úy, nhưng một trung úy không thể đọc các tài liệu của vị\n\ntướng đó. Ngược lại, nguyên tắc “ghi lên” quy định, một người dùng ở mức độ bảo mật k\n\nchỉ có thể ghi các đối tượng ở cùng mức bảo mật hoặc cao hơn. Ví dụ, một trung úy có\n\nthể nối thêm một tin nhắn vào hộp thư của chung của đơn vị về tất cả mọi thứ ông biết,\n\nnhưng một vị tướng không thể ghi thêm một tin nhắn vào hộp thư của trung úy với tất cả\n\nmọi thứ ông ấy biết vì vị tướng có thể đã nhìn thấy các tài liệu có mức bảo mật cao mà\n\nkhông thể được tiết lộ cho một trung úy.\n\n## Hình 4.4. Mô hình kiểm soát truy cập Bell-LaPadula\n\nHình 4.4 minh họa việc thực hiện các nguyên tắc “đọc xuống” và nguyên tắc “ghi lên”\n\ntrong mô hình Bell-LaPadula. Trong đó, các tiến trình chạy bởi người dùng được ký hiệu\n\nA, B, C, D, E được biểu diễn bởi các hình tròn và các đối tượng được đánh số 1, 2, 3, 4,\n\n5. Mũi tên liền nét biểu diễn quyền đọc, mũi tên đứt nét biểu diễn quyền ghi và các mức\n\nbảo mật cho cả tiến trình và đối tượng được đánh số 1, 2, 3, 4. Theo mô hình này, tiến\n\ntrình B có mức bảo mật là 2 chỉ được phép đọc các đối tượng số 1 và 2 – là các đối tượng\n\ncó cùng mức bảo mật và thấp hơn 2. B không được phép đọc đối tượng số 3 do đối tượng\n\nnày có mức bảo mật cao hơn. Ngược lại, B có quyền ghi các đối tượng số 2 và 3 – là các\n\nđối tượng có cùng mức bảo mật và cao hơn 2. Tuy nhiên, B không được phép ghi đối\n\ntượng số 1 do đối tượng này có mức bảo mật thấp hơn.\n\n---\n\n120\n\n4.2.2.3. Kiểm soát truy cập dựa trên vai trò\n\n## Kiểm soát truy cập dựa trên vai trò (RBAC) cho phép người dùng truy cập vào hệ\n\nthống và thông tin dựa trên vai trò (role) của họ trong cơ quan, tổ chức đó. Kiểm soát truy\n\ncập dựa trên vai trò có thể được áp dụng cho một nhóm người dùng hoặc từng người\n\ndùng riêng lẻ. Quyền truy cập vào các đối tượng trong hệ thống được tập hợp thành các\n\nnhóm “vai trò” với các mức quyền truy cập khác nhau. Các vai trò được tổ chức thành\n\nmột cây theo mô hình phân cấp tự nhiên của các cơ quan, tổ chức. Ví dụ như, hệ thống\n\nthông tin trong một trường học chia người dùng thành các nhóm gán sẵn quyền truy cập\n\nvào các phần trong hệ thống như sau:\n\n- Nhóm Quản lý được quyền truy cập vào tất cả các thông tin trong hệ thống;\n\n- Nhóm Giáo viên được truy cập vào cơ sở dữ liệu các môn học, bài báo khoa học,\n\ncập nhật điểm các lớp do mỗi giáo viên phụ trách;\n\n- Nhóm Sinh viên chỉ được quyền xem nội dung các môn học, tải tài liệu học tập và\n\nxem điểm của mình.\n\nViệc liên kết giữa người dùng và nhóm vai trò có thể được tạo lập và huỷ bỏ dễ dàng\n\nvà được thực hiện theo nguyên tắc: Người dùng được cấp “thẻ thành viên” của các nhóm\n\n“vai trò” trên cơ sở năng lực và vai trò, cũng như trách nhiệm của họ trong một tổ chức.\n\nTrong nhóm “vai trò”, người dùng được cấp vừa đủ quyền để thực hiện các thao tác cần\n\nthiết cho công việc được giao. Hình 4.5 minh họa một mô hình RBAC đơn giản, trong đó\n\nquyền truy cập vào các đối tượng (PRMS) được tập hợp thành các nhóm vai trò (Roles)\n\nvà việc cấp quyền truy cập các đối tượng cho người dùng (Users) được thực hiện thông\n\nqua thao tác gán quyền (UA – User Assignment). Việc cấp quyền truy cập các đối tượng\n\ncho người dùng có thể có hiệu lực trong dài hạn, hoặc cũng có thể có hiệu lực trong ngắn\n\nhạn, như theo phiên làm việc (Session).\n\n## Hình 4.5. Một mô hình RBAC đơn giản\n\n4.2.2.4. Kiểm soát truy cập dựa trên luật\n\n## Kiểm soát truy cập dựa trên luật (Rule-based Access Control) là cơ chế cho phép\n\nngười dùng truy cập vào hệ thống và thông tin dựa trên các luật (rules) đã được định\n\nnghĩa trước. Các luật có thể được thiết lập để hệ thống cho phép truy cập đến các tài\n\n---\n\n121\n\nnguyên của mình cho người dùng thuộc một tên miền, một mạng hay một dải địa chỉ IP.\n\nCác tường lửa (firewalls), hoặc proxies là ví dụ điển hình về việc thực hiện cơ chế kiểm\n\nsoát truy cập dựa trên luật. Các luật thực hiện kiểm soát truy cập sử dụng các thông tin\n\ntrích xuất từ các gói tin, thông tin về nội dung truy cập, có thể bao gồm:\n\n- Địa chỉ IP nguồn và đích của các gói tin;\n\n- Phần mở rộng các file để lọc các mã độc hại;\n\n- Địa chỉ IP hoặc các tên miền để lọc, hoặc chặn các website bị cấm;\n\n- Tập các từ khoá để lọc các nội dung bị cấm.\n\nHình 4.6 minh họa một số luật của tường lửa lọc gói tin. Theo đó, các thông tin của\n\ngói tin được sử dụng để lọc bao gồm: giao thức (Protocol), địa chỉ IP nguồn (Source IP),\n\nđịa chỉ IP đích (Destination IP) và cổng đích (Dest.Port). Khi luật thỏa mãn, một hành\n\nđộng (Action) được thực thi. Các hành động hỗ trợ bao gồm chấp nhận (Accept) và từ\n\nchối (Deny).\n\n## Hình 4.6. Một số luật của tường lửa lọc gói tin\n\n4.2.3. Một số công nghệ kiểm soát truy cập\n\nTrên cơ sở các biện pháp, cơ chế kiểm soát truy cập đã trình bày, mục này mô tả một\n\nsố công nghệ kiểm soát truy cập đã và đang được ứng dụng rộng rãi trên thực tế, trong đó\n\nnhấn mạnh đến các thông tin, hoặc các phương tiện mang thông tin xác thực người dùng\n\nđược sử dụng. Các công nghệ kiểm soát truy cập được đề cập bao gồm:\n\n- Kiểm soát truy cập dựa trên mật khẩu (password)\n\n- Kiểm soát truy cập dựa trên các khoá mã (encrypted key)\n\n- Kiểm soát truy cập dựa trên thẻ thông minh (smartcard)\n\n- Kiểm soát truy cập dựa trên thẻ bài (token)\n\n- Kiểm soát truy cập dựa trên các đặc điểm sinh trắc (biometric).\n\n4.2.3.1. Kiểm soát truy cập dựa trên mật khẩu\n\nKiểm soát truy cập dựa trên mật khẩu là công nghệ kiểm soát truy cập được sử dụng\n\ntừ lâu và vẫn đang được sử dụng rộng rãi do tính dễ dùng và rẻ tiền. Thông thường, mỗi\n\nngười dùng được cấp 1 tài khoản (account) để truy cập vào hệ thống. Mỗi tài khoản\n\nngười dùng thường gồm 2 thành tố: tên người dùng (username) và mật khẩu (password),\n\ntrong đó mật khẩu cần được giữ bí mật. Trong một số hệ thống, tên người dùng có thể\n\n---\n\n122\n\nđược thay thế bằng địa chỉ email, số điện thoại,... Mật khẩu có thể lưu trong hệ thống ở\n\ndạng rõ (plaintext) hoặc dạng mã hóa (encrypted text - thường dưới dạng giá trị băm).\n\nTính bảo mật của kiểm soát truy cập sử dụng mật khẩu dựa trên 2 yếu tố: (1) độ khó\n\nđoán của mật khẩu và (2) tuổi thọ của mật khẩu. Độ khó đoán của mật khẩu lại phụ thuộc\n\nvào số bộ ký tự sử dụng trong mật khẩu và độ dài của mật khẩu. Nhìn chung, mật khẩu\n\ncàng an toàn nếu càng nhiều bộ ký tự được sử dụng và có kích thước đủ lớn. Với các tài\n\nkhoản của ứng dụng thông thường, khuyến nghị nên sử dụng cả ký tự in thường, ký tự in\n\nhoa, chữ số và ký tự đặc biệt trong mật khẩu với độ dài từ 8 ký tự trở lên. Theo tuổi thọ,\n\nmật khẩu gồm 3 loại: không hết hạn, có thời hạn sống và mật khẩu sử dụng 1 lần. Để đảm\n\nbảo an toàn, khuyến nghị định kỳ đổi mật khẩu. Khoảng thời gian sống của mật khẩu có\n\nthể được thiết lập từ 3 tháng đến 6 tháng phụ thuộc chính sách an toàn thông tin của cơ\n\nquan, tổ chức.\n\nNhìn chung, kiểm soát truy cập dựa trên mật khẩu có độ an toàn thấp do người dùng\n\ncó xu hướng chọn các từ đơn giản, dễ nhớ làm mật khẩu. Ngoài ra, mật khẩu có thể bị\n\nnghe lén khi được truyền trên môi trường mạng mở như Internet. Do vậy, để đảm bảo an\n\ntoàn, cần có chính sách quản lý tài khoản và sử dụng mật khẩu phù hợp với từng hệ thống\n\ncụ thể.\n\n4.2.3.2. Kiểm soát truy cập dựa trên các khoá mã\n\nKiểm soát truy cập dựa trên các khoá mã cho phép đảm bảo tính bí mật của thông tin\n\nvà đồng thời cho phép kiểm tra thông tin nhận dạng của các bên tham gia giao dịch. Một\n\ntrong các ứng dụng rộng rãi nhất của khóa mã là chứng chỉ số khóa công khai (Public\n\nKey Digital Certificate). Một chứng chỉ số khóa công khai thường gồm 3 thông tin quan\n\ntrọng nhất:\n\n- Thông tin nhận dạng của chủ thể (Subject);\n\n- Khoá công khai của chủ thể (Public key);\n\n- Chữ ký số của nhà cung cấp chứng chỉ số (Certificate Authority – CA).\n\nHình 4.7 là giao diện kiểm tra thông tin của của một chứng chỉ số khóa công khai cấp\n\ncho tên miền www.vietcombank.com.vn. Chứng chỉ số khóa công khai có thể được sử\n\ndụng để xác thực các thực thể tham gia phiên truyền thông, đồng thời hỗ trợ trao đổi khóa\n\ncho các khâu mã hóa – giải mã thông điệp, nhằm đảm bảo tính bí mật thông điệp truyền.\n\n4.2.3.3. Kiểm soát truy cập dựa trên thẻ thông minh\n\nThẻ thông minh (Smartcard) là các thẻ nhựa có gắn các chip điện tử với khả năng tính\n\ntoán và các thông tin lưu trong thẻ được mã hoá. Kiểm soát truy cập dựa trên thẻ thông\n\nminh là phương pháp có độ an toàn cao do smartcard sử dụng hai nhân tố (two-factors)\n\nđể xác thực và nhận dạng chủ thể: (1) cái bạn có (what you have) - thẻ smartcard và (2)\n\ncái bạn biết (what you know) - số PIN. Hình 4.8 là hình ảnh thẻ thông minh tiếp xúc (a)\n\nvà thẻ thông minh không tiếp xúc (b).\n\n---\n\n123\n\n## Hình 4.7. Giao diện kiểm tra thông tin của một chứng chỉ số khóa công khai\n\n(a)\n\n(b)\n\n## Hình 4.8. Thẻ thông minh tiếp xúc (a) và thẻ không tiếp xúc (b)\n\n4.2.3.4. Kiểm soát truy cập dựa trên thẻ bài\n\nCác thẻ bài thường là các thiết bị cầm tay được thiết kế nhỏ gọn để có thể dễ dàng\n\nmang theo. Khác với thẻ thông minh, thẻ bài được tích hợp pin cung cấp nguồn nuôi. Thẻ\n\nbài có thể được sử dụng để lưu mật khẩu, các thông tin cá nhân và các thông tin quan\n\ntrọng khác. Tương tự thẻ thông minh, thẻ bài thường được trang bị cơ chế xác thực 2\n\nnhân tố, gồm thẻ bài và mật khẩu, hoặc PIN (thường dùng 1 lần). Ưu điểm của thẻ bài là\n\ncó cơ chế xác thực mạnh hơn thẻ thông minh do thẻ bài có CPU với năng lực xử lý cao\n\n---\n\n124\n\nhơn và bộ nhớ lưu trữ lớn hơn. Hình 4.9, Hình 4.10 và Hình 4.11 minh họa một số thẻ bài\n\ncủa hãng RSA Security, ví điện tử của cổng thanh toán trực tuyến Paypal và hệ thống\n\n## ApplePay tích hợp vào điện thoại di động.\n\n## Hình 4.9. Một số thẻ bài (Token) của hãng RSA Security\n\n## Hình 4.10. Ví điện tử (một dạng thẻ bài) của cổng thanh toán trực tuyến Paypal\n\n## Hình 4.11. Hệ thống ApplePay tích hợp vào điện thoại di động\n\n---\n\n125\n\n4.2.3.5. Kiểm soát truy cập dựa trên các đặc điểm sinh trắc\n\nCác đặc điểm sinh trắc là các đặc điểm riêng có để nhận dạng người dùng, bao gồm\n\ndấu vân tay, tròng mắt, khuôn mặt, tiếng nói, chữ ký tay,... Kiểm soát truy cập sử dụng\n\ncác đặc điểm sinh trắc để nhận dạng chủ thể là phương pháp có khả năng cung cấp độ an\n\ntoàn cao nhất và cho phép xác thực chủ thể do các đặc điểm sinh trắc luôn đi cùng chủ\n\nthể và khó bị đánh cắp hoặc làm giả. Hình 4.12 minh họa (a) Khóa vân tay, (b) Khe xác\n\nthực vân tay trên laptop và (c) Xác thực vân tay trên điện thoại thông minh Samsung.\n\n## Hình 4.13 minh họa việc quét võng mạc để nhận dạng tròng mắt.\n\n## Hình 4.12. (a) Khóa vân tay, (b) Khe xác thực vân tay trên laptop và\n\n(c) Xác thực vân tay trên điện thoại thông minh Samsung\n\n## Hình 4.13. Quét võng mạc nhận dạng tròng mắt\n\n(a)\n\n(c)\n\n(b)\n\n---\n\n126\n\nNhược điểm chính của kiểm soát truy cập sử dụng các đặc điểm sinh trắc là phương\n\npháp này yêu cầu chi phí đầu tư lớn cho các thiết bị quét, đọc và xử lý các đặc điểm sinh\n\ntrắc. Ngoài ra, phương pháp này tương đối chậm do thường liên quan đến xử lý ảnh –\n\ncông việc đòi hỏi khối lượng tính toán rất lớn. Một vấn đề khác cần quan tâm là tỷ lệ\n\nnhận dạng sai cao do có nhiều yếu tố nhiễu ảnh hưởng. Ngoài ra, cũng có một số lo ngại\n\nvề tính riêng tư của người dùng khi một lượng lớn dữ liệu sinh trắc được thu thập có khả\n\nnăng bị rò rỉ và lạm dụng.\n\n4.3. Tường lửa\n\n4.3.1. Giới thiệu tường lửa\n\nTường lửa (Firewall) là một trong các kỹ thuật được sử dụng phổ biến nhất để bảo hệ\n\nthống và mạng cục bộ tránh các mối đe dọa từ bên ngoài. Tường lửa có thể là một thiết bị\n\nphần cứng chuyên dụng, hoặc mô đun phần mềm chạy trên máy tính. Hình 4.14 là hình\n\nảnh một tường lửa phần cứng chuyên dụng của hãng Cisco.\n\n## Hình 4.14. Một tường lửa phần cứng chuyên dụng của Cisco\n\n## Để đảm bảo hiệu quả bảo vệ, tường lửa phải miễn dịch với các loại tấn công, xâm\n\nnhập và thường được đặt ở vị trí cổng vào của mạng nội bộ cơ quan hoặc tổ chức, như\n\nminh họa trên Hình 4.15. Nhờ vị trí đặt ở cổng mạng, tất cả các gói tin từ trong ra và từ\n\nngoài vào đều phải đi qua tường lửa và chỉ các gói tin hợp pháp được phép đi qua tường\n\nlửa. Việc xác định một gói tin là hợp pháp hay không được thực hiện bởi thao tác lọc\n\n(filtering) dựa trên các luật (rules). Tập các luật sử dụng cho việc lọc các gói tin được tạo\n\nra dựa trên chính sách an ninh của cơ quan, tổ chức.\n\nHình 4.16 biểu diễn sơ đồ mạng trong đó tường lửa được sử dụng để bảo vệ các máy\n\nchủ dịch vụ email Microsoft Exchange. Tất cả các kết nối đến hệ thống máy chủ email\n\nđều phải đi qua tường lửa. Hình 4.17 sơ đồ mạng sử dụng 2 tưởng lửa để bảo vệ, trong đó\n\nmột tường lửa phần cứng (Hardware Firewall) được sử dụng tại cổng kết nối Internet để\n\nbảo vệ các máy chủ dịch vụ (dịch vụ web, dịch vụ FTP và dịch vụ DNS) và một tường\n\nlửa phần mềm (ISA Firewall) được sử dụng để bảo vệ các máy chủ nội bộ và các máy\n\ntrạm trong mạng LAN của cơ quan, tổ chức. Hai tường lửa có chính sách kiểm soát truy\n\ncập và tập luật khác nhau phù hợp với đối tượng bảo vệ khác nhau.\n\n---\n\n127\n\n## Hình 4.15. Tường lửa bảo vệ mạng gia đình hoặc văn phòng nhỏ\n\n## Hình 4.16. Tường lửa bảo vệ các máy chủ dịch vụ\n\n## Hình 4.17. Hệ thống tường lửa bảo vệ các máy chủ dịch vụ và máy trạm\n\n---\n\n128\n\n4.3.2. Các loại tường lửa\n\nCó nhiều phương pháp phân loại các tường lửa, chẳng hạn như dựa trên vị trí các lớp\n\ngiao thức mạng và khả năng lưu trạng thái của các kết nối mạng. Dựa trên vị trí các lớp\n\ngiao thức mạng, có thể chia tường lửa thành 3 loại: tường lửa lọc gói (Packet-filtering),\n\ncổng ứng dụng (Application-level gateway) và cổng chuyển mạch (Circuit-level\n\ngateway). Tường lửa lọc gói thường thực hiện việc lọc các gói tin IP, theo đó một tập,\n\nhoặc một nhóm các luật được áp dụng cho mỗi gói tin gửi đi, hoặc chuyển đến để quyết\n\nđịnh chuyển tiếp các gói tin hợp pháp, hay loại bỏ gói tin bất hợp pháp. Cổng ứng dụng,\n\ncòn gọi là máy chủ proxy thường được sử dụng để phát lại lưu lượng mạng ở mức ứng\n\ndụng. Cổng ứng dụng thực hiện việc lọc các yêu cầu, hoặc hồi đáp (request/response) ở\n\ncác giao thức ứng dụng phổ biến như HTTP, SMTP, FTP,... Cổng chuyển mạch hoạt\n\nđộng ở mức thấp nhất, với cơ chế tương tự như các bộ chuyển mạch (switch). Hình 4.18\n\nminh họa mô hình tường lửa lọc gói (a), cổng ứng dụng (b) và cổng chuyển mạch (c).\n\n## Hình 4.18. Mô hình tường lửa lọc gói (a), Cổng ứng dụng (b) và\n\n## Cổng chuyển mạch (c)\n\n---\n\n129\n\nDựa trên khả năng lưu trạng thái của các kết nối mạng, tường lửa được chia thành 2\n\nloại: tường lửa có trạng thái (Stateful firewall) và tường lửa không trạng thái (Stateless\n\nfirewall). Tường lửa có trạng thái có khả năng lưu trạng thái của các kết nối mạng đi qua\n\nvà được lập trình để phân biệt các gói tin thuộc về các kết nối mạng khác nhau. Theo đó,\n\nchỉ những gói tin thuộc một kết nối mạng đang hoạt động mới được đi qua tường lửa, còn\n\ncác gói tin khác không thuộc kết nối đang hoạt động sẽ bị chặn lại. Hình 4.19 minh hoạt\n\nmột tường lửa có trạng thái chặn các gói tin IP gửi từ người dùng ngoài (Outside User)\n\nđến địa chỉ IP 200.1.1.10 do chúng không thuộc kết nối đang hoạt động. Ngược lại, tường\n\nlửa không trạng thái thực hiện việc lọc các gói tin riêng rẽ mà không quan tâm mỗi gói\n\ntin thuộc về kết nối mạng nào. Tường lửa dạng này dễ bị tấn công bởi kỹ thuật giả mạo\n\nđịa chỉ, giả mạo nội dung gói tin do tường lửa không có khả năng nhớ các gói tin đi trước\n\nthuộc cùng một kết nối mạng.\n\nHình 4.19. Tường lửa có trạng thái chặn gói tin không thuộc kết nối đang hoạt động\n\n4.3.3. Các kỹ thuật kiểm soát truy cập\n\nHầu hết các tường lửa hỗ trợ nhiều kỹ thuật kiểm soát truy cập, gồm kiểm soát dịch\n\nvụ, kiểm soát hướng, kiểm soát người dùng và kiểm soát hành vi. Cụ thể:\n\n- Kiểm soát dịch vụ xác định dịch vụ nào có thể được truy cập và thường được thực\n\nhiện thông qua việc mở hoặc đóng một cổng dịch vụ nào đó. Chẳng hạn, để cung\n\ncấp dịch vụ web và cấm tất cả các dịch vụ khác, tường lửa mở cổng HTTP 80 và\n\n## HTTPS 443, còn đóng tất cả các cổng dịch vụ khác.\n\n- Kiểm soát hướng điều khiển hướng được phép đi của các gói tin của mỗi dịch vụ.\n\n## Hướng có thể gồm luồng từ mạng nội bộ đi ra (outgoing) và luồng từ ngoài đi vào\n\nmạng nội bộ (incoming).\n\n- Kiểm soát người dùng xác định người dùng nào được quyền truy cập và thường áp\n\ndụng cho người dùng mạng nội bộ.\n\n---\n\n130\n\n- Kiểm soát hành vi thực hiện kiểm soát việc sử dụng các dịch vụ cụ thể. Ví dụ như,\n\ntường lửa có thể được cấu hình để lọc loại bỏ các thư rác, hoặc hạn chế truy cập\n\nđến một bộ phận thông tin của máy chủ web.\n\n4.3.4. Các hạn chế của tường lửa\n\n## Mặc dù tường lửa được sử dụng rộng rãi để bảo vệ mạng nội bộ khỏi các cuộc tấn\n\ncông, xâm nhập, nhưng cũng như hầu hết các kỹ thuật và công cụ đảm bảo an toàn khác,\n\ntường lửa cũng có những hạn chế. Các hạn chế của tường lửa gồm:\n\n- Không thể chống lại các tấn công không đi qua tường lửa. Đó có thể là các dạng\n\ntấn công khai thác yếu tố con người, hoặc kẻ tấn công có thể xâm nhập trực tiếp\n\nvào hệ thống mạng nội bộ mà không đi qua tường lửa.\n\n- Không thể chống lại các tấn công hướng dữ liệu, hoặc tấn công vào các lỗ hổng\n\nbảo mật của các phần mềm.\n\n- Không thể chống lại các hiểm hoạ từ bên trong, như từ người dùng trong mạng nội\n\nbộ.\n\n- Không thể ngăn chặn việc vận chuyển các chương trình hoặc các file bị nhiễm vi\n\nrút hoặc các phần mềm độc hại (thường ở dạng nén hoặc mã hóa).\n\n4.4. Các hệ thống phát hiện và ngăn chặn xâm nhập\n\n4.4.1. Giới thiệu\n\nCác hệ thống phát hiện, ngăn chặn tấn công, xâm nhập (IDS/IPS) là một lớp phòng vệ\n\nquan trọng trong các lớp giải pháp đảm bảo an toàn cho hệ thống thông tin và mạng theo\n\nmô hình phòng thủ theo chiều sâu. IDS (Intrusion Detection System) là hệ thống phát\n\nhiện tấn công, xâm nhập và IPS (Intrusion Prevention System) là hệ thống ngăn chặn tấn\n\ncông, xâm nhập. Các hệ thống IDS/IPS có thể được đặt trước hoặc sau tường lửa trong\n\nmô hình mạng, tùy theo mục đích sử dụng. Hình 4.20 cung cấp vị trí các hệ thống IDS và\n\nIPS trong sơ đồ mạng, trong đó IDS thường được kết nối vào bộ switch phía sau tường\n\nlửa, còn IPS được ghép vào giữa đường truyền từ cổng mạng, phía sau tường lửa.\n\n## Hình 4.20. Vị trí các hệ thống IDS và IPS trong sơ đồ mạng\n\n---\n\n131\n\n## Nhiệm vụ chính của các hệ thống IDS/IPS bao gồm:\n\n- Giám sát lưu lượng mạng hoặc các hành vi trên một hệ thống để nhận dạng các dấu\n\nhiệu của tấn công, xâm nhập;\n\n- Khi phát hiện các hành vi tấn công, xâm nhập, thì ghi logs các hành vi này cho\n\nphân tích bổ sung sau này;\n\n- Ngăn chặn hoặc dừng các hành vi tấn công, xâm nhập;\n\n- Gửi thông báo cho người quản trị về các các hành vi tấn công, xâm nhập đã phát\n\nhiện được.\n\nVề cơ bản IPS và IDS giống nhau về chức năng giám sát lưu lượng mạng hoặc các sự\n\nkiện trong hệ thống. Tuy nhiên, IPS thường được đặt giữa đường truyền thông và có thể\n\nchủ động ngăn chặn các tấn công, xâm nhập bị phát hiện. Trong khi đó, IDS thường được\n\nkết nối vào các bộ định tuyến, switch, card mạng và chủ yếu làm nhiệm vụ giám sát và\n\ncảnh bảo, không có khả năng chủ động ngăn chặn tấn công, xâm nhập.\n\n4.4.2. Phân loại\n\nCó 2 phương pháp phân loại chính các hệ thống IDS và IPS, gồm (1) phân loại theo\n\nnguồn dữ liệu và (2) phân loại theo phương pháp phân tích dữ liệu. Theo nguồn dữ liệu,\n\ncó 2 loại hệ thống phát hiện xâm nhập:\n\n- Hệ thống phát hiện xâm nhập mạng (NIDS – Network-based IDS): NIDS phân tích\n\nlưu lượng mạng để phát hiện tấn công, xâm nhập cho cả mạng hoặc một phần\n\nmạng. Hình 4.21 biểu diễn một sơ đồ mạng, trong đó các NIDS được bố trí để\n\ngiám sát phát hiện xâm nhập tại cổng vào và cho từng phân đoạn mạng. Một số\n\n## NIDS điển hình như Snort, Suricata...\n\n## Hình 4.21. Các NIDS được bố trí để giám sát phát hiện xâm nhập tại cổng vào\n\nvà cho từng phân đoạn mạng\n\n---\n\n132\n\n- Hệ thống phát hiện xâm nhập cho host (HIDS – Host-based IDS): HIDS phân tích\n\ncác sự kiện xảy ra trong hệ thống/dịch vụ để phát hiện tấn công, xâm nhập cho hệ\n\nthống đó. Hình 4.22 minh họa một sơ đồ mạng, trong đó sử dụng NIDS để giám\n\nsát lưu lượng tại cổng mạng và HIDS để giám sát các host thông qua các IDS\n\nagent. Một trạm quản lý (Management station) được thiết lập để thu nhập các\n\nthông tin từ các NIDS và HIDS để xử lý và đưa ra quyết định cuối cùng. Một trong\n\ncác HIDS tiêu biểu có thể kể đến là OSSEC.\n\n## Hình 4.22. Sử dụng kết hợp NIDS và HIDS để giám sát lưu lượng mạng và các host\n\nTheo phương pháp phân tích dữ liệu, có 2 kỹ thuật phân tích chính, gồm (1) phát hiện\n\nxâm nhập dựa trên chữ ký/dấu hiệu, hoặc phát hiện sự lạm dụng (Signature-based /\n\nmisuse intrusion detection) và (2) phát hiện xâm nhập dựa trên các bất thường (Anomaly\n\nintrusion detection). Mục tiếp theo trình bày chi tiết hơn về hai kỹ thuật phát hiện này.\n\n4.4.3. Các kỹ thuật phát hiện xâm nhập\n\n4.4.3.1. Phát hiện xâm nhập dựa trên chữ ký\n\nPhát hiện xâm nhập dựa trên chữ ký trước hết cần xây dựng cơ sở dữ liệu các chữ ký,\n\nhoặc các dấu hiệu của các loại tấn công, xâm nhập đã biết. Hầu hết các chữ ký, dấu hiệu\n\nđược nhận dạng và mã hóa thủ công và dạng biểu diễn thường gặp là các luật phát hiện\n\n(Detection rule). Bước tiếp theo là sử dụng cơ sở dữ liệu các chữ ký để giám sát các hành\n\nvi của hệ thống, hoặc mạng, và cảnh báo nếu phát hiện chữ ký của tấn công, xâm nhập.\n\nHình 4.23 biểu diễn lưu đồ giám sát phát hiện tấn công, xâm nhập dựa trên chữ ký điển\n\nhình.\n\nƯu điểm lớn nhất của phát hiện xâm nhập dựa trên chữ ký là có khả năng phát hiện\n\ncác tấn công, xâm nhập đã biết một cách hiệu quả. Ngoài ra, phương pháp này cho tốc độ\n\nxử lý cao, đồng thời yêu cầu tài nguyên tính toán tương đối thấp. Nhờ vậy, các hệ thống\n\nphát hiện xâm nhập dựa trên chữ ký được ứng dụng rộng rãi trong thực tế. Tuy nhiên,\n\nnhược điểm chính của phương pháp này là không có khả năng phát hiện các tấn công,\n\nxâm nhập mới, do chữ ký của chúng chưa tồn tại trong cơ sở dữ liệu các chữ ký. Hơn\n\n---\n\n133\n\nnữa, nó cũng đòi hỏi nhiều công sức xây dựng và cập nhật cơ sở dữ liệu chữ ký, dấu hiệu\n\ncủa các tấn công, xâm nhập.\n\n## Hình 4.23. Lưu đồ giám sát phát hiện tấn công, xâm nhập dựa trên chữ ký\n\n4.4.3.2. Phát hiện xâm nhập dựa trên bất thường\n\nPhát hiện xâm nhập dựa trên bất thường dựa trên giả thiết: các hành vi tấn công, xâm\n\nnhập thường có quan hệ chặt chẽ với các hành vi bất thường. Quá trình xây dựng và triển\n\nkhai một hệ thống phát hiện xâm nhập dựa trên bất thường gồm 2 giai đoạn: (1) huấn\n\nluyện và (2) phát hiện. Trong giai đoạn huấn luyện, hồ sơ (profile) của đối tượng trong\n\nchế độ làm việc bình thường được xây dựng. Để thực hiện giai đoạn huấn luyện này, cần\n\ngiám sát đối tượng trong một khoảng thời gian đủ dài để thu thập được đầy đủ dữ liệu mô\n\ntả các hành vi của đối tượng trong điều kiện bình thường làm dữ liệu huấn luyện. Tiếp\n\ntheo, thực hiện huấn luyện dữ liệu để xây dựng mô hình phát hiện, hay hồ sơ của đối\n\ntượng. Trong giai đoạn phát hiện, thực hiện giám sát hành vi hiện tại của hệ thống và\n\ncảnh báo nếu có khác biệt rõ nét giữa hành vi hiện tại và các hành vi lưu trong hồ sơ của\n\nđối tượng.\n\nHình 4.24 biểu diễn giá trị entropy của IP nguồn của các gói tin theo cửa sổ trượt từ\n\nlưu lượng bình thường và entropy của IP nguồn của các gói tin từ lưu lượng tấn công\n\nDDoS. Có thể thấy sự khác biệt rõ nét giữa giá trị entropy của lưu lượng bình thường và\n\nlưu lượng tấn công và như vậy, nếu một ngưỡng entropy được chọn phù hợp ta hoàn toàn\n\ncó thể phát hiện sự xuất hiện của cuộc tấn công DDoS dựa trên sự thay đổi đột biến của\n\ngiá trị entropy.\n\nƯu điểm của phát hiện xâm nhập dựa trên bất thường là có tiềm năng phát hiện các\n\nloại tấn công, xâm nhập mới mà không yêu cầu biết trước thông tin về chúng. Tuy nhiên,\n\nphương pháp này có tỷ lệ cảnh báo sai tương đối cao so với phương pháp phát hiện dựa\n\ntrên chữ ký. Điều này làm giảm khả năng ứng dụng thực tế của phát hiện xâm nhập dựa\n\ntrên bất thường. Ngoài ra, nó cũng tiêu tốn nhiều tài nguyên hệ thống cho việc xây dựng\n\nhồ sơ đối tượng và phân tích hành vi hiện tại. Mặc dù vậy, đây vẫn là một hướng nghiên\n\n---\n\n134\n\ncứu phát hiện xâm nhập đang rất được quan tâm nhằm cải thiện tỷ lệ phát hiện, giảm tỷ lệ\n\ncảnh báo sai và giảm yêu cầu sử dụng tài nguyên tính toán, lưu trữ.\n\n## Hình 4.24. Giá trị entropy của IP nguồn của các gói tin từ lưu lượng hợp pháp\n\n(phần giá trị cao, đều) và entropy của IP nguồn của các gói tin\n\ntừ lưu lượng tấn công DDoS (phần giá trị thấp)\n\n4.5. Câu hỏi ôn tập\n\n1) Nêu khái niệm, các thành phần và mục đích của kiểm soát truy cập.\n\n2) Nêu cơ chế hoạt động của mô hình (biện pháp) kiểm soát truy cập tùy chọn (DAC).\n\n3) Nêu cơ chế hoạt động của mô hình (biện pháp) kiểm soát truy cập bắt buộc (MAC).\n\n4) Nêu cơ chế hoạt động của mô hình (biện pháp) kiểm soát truy cập dựa trên vai trò\n\n# (RBAC).\n\n5) Nêu cơ chế hoạt động của mô hình (biện pháp) kiểm soát truy cập dựa trên luật (Rule-\n\nbased access control).\n\n6) So sánh 2 kỹ thuật thực hiện mô hình kiểm soát truy cập tùy chọn (DAC): ma trận\n\nkiểm soát truy cập và danh sách kiểm soát truy cập.\n\n7) Mô tả cơ chế hoạt động của mô hình bảo mật đa cấp Bell-LaPadula.\n\n8) Mô tả công nghệ kiểm soát truy cập dựa trên mật khẩu.\n\n9) Trong các công nghệ kiểm soát truy cập: dựa trên mật khẩu, khóa mã, thẻ thông minh,\n\nthẻ bài và các đặc điểm sinh trắc, công nghệ nào có khả năng cho độ bảo mật cao\n\nnhất? Tại sao?\n\n10) Tường lửa là gì? Nêu vai trò của tường lửa. Nêu các phương pháp phân loại tường\n\nlửa.\n\n11) Nêu các kỹ thuật kiểm soát truy cập và các hạn chế của tường lửa.\n\n12) Các hệ thống IDS/IPS là gì? Nêu các nhiệm vụ chính của IDS/IPS. IDS và IPS giống\n\nvà khác nhau ở những điểm nào?\n\n13) Nêu các phương pháp phân loại IDS/IPS. Có thể sử dụng kết hợp NIDS và HIDS\n\ntrong cùng một mạng được không?\n\n---\n\n135\n\n14)  Mô tả và nêu ưu nhược điểm của phương pháp phát hiện xâm nhập dựa trên chữ ký.\n\n15) Mô tả phương pháp phát hiện xâm nhập dựa trên bất thường. Nêu ưu nhược điểm của\n\nphương pháp này.\n\n16) Tại sao phát hiện xâm nhập dựa trên bất thường có khả năng phát hiện các tấn công\n\nxâm nhập mới? Tại sao phát hiện xâm nhập dựa trên bất thường thường có tỷ lệ cảnh\n\nbáo sai cao hơn phát hiện xâm nhập dựa trên chữ ký?\n\n---\n\n136\n\n# CHƯƠNG 5. QUẢN LÝ, CHÍNH SÁCH VÀ PHÁP LUẬT\n\n# AN TOÀN THÔNG TIN\n\nChương 6 giới thiệu một số khái niệm cơ bản trong quản lý an toàn thông tin, vấn đề\n\nđánh giá rủi ro an toàn thông tin và thực thi quản lý an toàn thông tin. Nội dung tiếp theo\n\ncủa chương đề cập đến các chuẩn quản lý an toàn thông tin, trong đó giới thiệu một số\n\nchuẩn của bộ chuẩn ISO/IEC 27000. Phần cuối của chương giới thiệu khái quát về các\n\nvấn đề chính sách, pháp luật và đạo đức an toàn thông tin.\n\n5.1. Quản lý an toàn thông tin\n\n5.1.1. Khái quát về quản lý an toàn thông tin\n\nChúng ta bắt đầu mục này với khái niệm Tài sản (Asset) trong lĩnh vực an toàn thông\n\ntin, gọi tắt là Tài sản an toàn thông tin. Tài sản an toàn thông tin là thông tin, thiết bị,\n\nhoặc các thành phần khác hỗ trợ các hoạt động có liên quan đến thông tin. Tài sản an toàn\n\nthông tin có thể gồm:\n\n- Phần cứng (máy chủ, các thiết bị mạng,…);\n\n- Phần mềm (hệ điều hành, các phần mềm máy chủ dịch vụ,…); và\n\n- Thông tin (thông tin khách hàng, nhà cung cấp, hoạt động kinh doanh,…).\n\nKhái niệm tiếp theo là Quản lý an toàn thông tin (Information security management).\n\nQuản lý an toàn thông tin là một tiến trình nhằm đảm bảo các tài sản an toàn thông tin\n\nquan trọng của cơ quan, tổ chức, doanh nghiệp được bảo vệ đầy đủ với chi phí phù hợp.\n\nQuản lý an toàn thông tin là một thành phần rất quan trọng trong an toàn thông tin và\n\nnó phải trả lời được 3 câu hỏi:\n\n1. Những tài sản nào cần được bảo vệ?\n\n2. Những mối đe dọa nào có thể có đối với các tài sản này?\n\n3. Những biện pháp có thể thực hiện để ứng phó với các mối đe dọa đó?\n\n## Quản lý an toàn thông tin có thể được thực hiện theo 3 khâu chính sau:\n\n- Khâu 1: Xác định rõ mục đích đảm bảo an toàn thông tin và hồ sơ tổng hợp về các\n\nrủi ro;\n\n- Khâu 2: Đánh giá rủi ro với từng tài sản an toàn thông tin cần bảo vệ; và\n\n- Khâu 3: Xác định và triển khai các biện pháp quản lý, kỹ thuật kiểm soát, giảm rủi\n\nro về mức chấp nhận được.\n\nMột điểm quan trọng cần lưu ý là, quá trình quản lý an toàn thông tin cần được thực\n\nhiện liên tục theo chu trình do sự thay đổi nhanh chóng của công nghệ và môi trường\n\nxuất hiện rủi ro. Hình 5.1 mô tả mô hình hệ thống quản lý an toàn thông tin theo chuẩn\n\nISO 27001. Theo đó, phần việc Phân tích rủi ro được thực hiện trong các khâu 1 và khâu\n\n2, và các phần việc Lựa chọn các kiểm soát và Thực thi các kiểm soát được thực hiện\n\ntrong khâu 3. Khi các kiểm soát được triển khai sẽ có khả năng thay đổi mức rủi ro đối\n\nvới các tài sản an toàn thông tin.\n\n---\n\n137\n\n## Hình 5.1. Quan hệ giữa các khâu trong quản lý an toàn thông tin\n\n5.1.2. Đánh giá rủi ro an toàn thông tin\n\n5.1.2.1. Giới thiệu\n\nĐánh giá rủi ro an toàn thông tin (Security risk assessment) là một bộ phận quan trọng\n\ncủa vấn đề quản lý rủi ro an toàn thông tin. Theo đó, mỗi tài sản của tổ chức cần được\n\nxem xét, nhận dạng các rủi ro có thể có và đánh giá mức rủi ro. Đánh giá rủi ro là một\n\ntrong các cơ sở để xác định mức rủi ro chấp nhận được với từng loại tài sản. Trên cơ sở\n\nxác định mức rủi ro, có thể đề ra các biện pháp xử lý, kiểm soát rủi ro trong mức chấp\n\nnhận được, với mức chi phí phù hợp.\n\nHình 5.2 minh hoạ mô hình đánh giá rủi ro an toàn thông tin, trong đó 3 nhân tố chính\n\nliên quan trực tiếp cần được xem xét gồm: (1) Tài sản an toàn thông tin cần được bảo vệ,\n\n(2) Các mối đe doạ đối với các tài sản an toàn thông tin và (3) Các lỗ hổng bảo mật tồn\n\ntại trong các tài sản an toàn thông tin. Như vậy, việc đánh giá rủi ro an toàn thông tin cần\n\nphải xem xét toàn diện cả vấn đề bên trong của tài sản an toàn thông tin (lỗ hổng bảo\n\nmật) và vấn đề bên ngoài (mối đe doạ).\n\n## Hình 5.2. Mô hình đánh giá rủi ro an toàn thông tin\n\n## Có 4 phương pháp tiếp cận đánh giá rủi ro: phương pháp đường cơ sở (Baseline\n\napproach), phương pháp không chính thức (Informal approach), phương pháp phân tích\n\nchi tiết rủi ro (Detailed risk analysis) và phương pháp kết hợp (Combined approach). Tùy\n\ntheo quy mô của hệ thống thông tin của đơn vị và tài sản an toàn thông tin cần được bảo\n\nvệ, đơn vị có thể xem xét lựa chọn phương pháp đánh giá rủi ro cho phù hợp. Mục tiếp\n\ntheo mô tả chi tiết về các phương pháp đánh giá rủi ro kể trên.\n\n---\n\n138\n\n5.1.2.2. Các phương pháp đánh giá rủi ro\n\na. Phương pháp đánh giá rủi ro đường cơ sở\n\n## Phương pháp đánh giá rủi ro đường cơ sở là phương pháp đơn giản nhất. Mục đích\n\ncủa phương pháp này là thực thi các kiểm soát an ninh ở mức cơ bản dựa trên các tài liệu\n\ncơ bản, các quy tắc thực hành và các thực tế tốt nhất của ngành đã được áp dụng. Phương\n\npháp đường cơ sở có ưu điểm là không đòi hỏi các chi phí cho các tài nguyên bổ sung sử\n\ndụng trong đánh giá rủi ro chính thức và cùng nhóm các biện pháp có thể triển khai trên\n\nnhiều hệ thống. Tuy nhiên, nhược điểm của nó là không xem xét kỹ đến các điều kiện\n\nnảy sinh các rủi ro ở các hệ thống của các tổ chức khác nhau. Một vấn đề khác của\n\nphương pháp này là mức đường cơ sở được xác định chung nên có thể không phù hợp với\n\ntừng tổ chức cụ thể. Nếu chọn mức quá cao có thể gây tốn kém, nhưng nếu chọn mức quá\n\nthấp có thể gây mất an toàn. Nhìn chung, phương pháp đường cơ sở phù hợp với các tổ\n\nchức với hệ thống công nghệ thông tin có quy mô nhỏ, có nguồn lực hạn chế.\n\nb. Phương pháp không chính thức\n\n## Phương pháp không chính thức là phương pháp tiếp cận đánh giá rủi ro tiếp theo.\n\n## Phương pháp không chính thức liên quan đến việc thực hiện các nội dung sau:\n\n- Thực hiện một số dạng phân tích rủi ro hệ thống công nghệ thông tin của tổ chức\n\nmột cách không chính thức,\n\n- Sử dụng kiến thức chuyên gia của các nhân viên bên trong tổ chức, hoặc các nhà tư\n\nvấn từ bên ngoài, và\n\n- Không thực hiện đánh giá toàn diện các rủi ro đối với tất cả các tài sản công nghệ\n\nthông tin của tổ chức.\n\nPhương pháp này có ưu điểm là không đòi hỏi các nhân viên phân tích rủi ro có các\n\nkỹ năng bổ sung, nên có thể thực hiện nhanh với chi phí thấp, và việc có phân tích hệ\n\nthống công nghệ thông tin của tổ chức giúp cho việc đánh giá rủi ro, lỗ hổng chính xác\n\nhơn và các biện pháp kiểm soát đưa ra cũng phù hợp hơn phương pháp đường cơ sở.\n\n## Phương pháp không chính thức có các nhược điểm là:\n\n- Do đánh giá rủi ro không được thực hiện toàn diện nên có thể một rủi ro không\n\nđược xem xét kỹ, nên có thể để lại nguy cơ cao cho tổ chức, và\n\n- Kết quả đánh giá dễ phục thuộc vào quan điểm của các cá nhân.\n\n## Trên thực tế phương pháp không chính thức phù hợp với các tổ chức với hệ thống\n\ncông nghệ thông tin có quy mô nhỏ và vừa, có nguồn lực tương đối hạn chế.\n\nc. Phương pháp phân tích chi tiết rủi ro\n\nPhương pháp phân tích chi tiết rủi ro là phương pháp đánh giá toàn diện, được thực\n\nhiện một cách chính thức và được chia thành nhiều giai đoạn, bao gồm:\n\n- Nhận dạng các tài sản,\n\n- Nhận dạng các mối đe dọa và lổ hổng đối với các tài sản này,\n\n- Xác định xác suất xuất hiện các rủi ro và các hậu quả có thể có nếu rủi ro xảy ra\n\nvới cơ quan, tổ chức, và\n\n---\n\n139\n\n- Lựa chọn các biện pháp xử lý rủi ro dựa trên kết quả đánh giá rủi ro của các giai\n\nđoạn trên.\n\nƯu điểm của phương pháp này là cho phép xem xét chi tiết các rủi ro đối với hệ thống\n\ncông nghệ thông tin của tổ chức, và lý giải rõ ràng các chi phí cho các biện pháp kiểm\n\nsoát rủi do đề xuất. Đồng thời, nó cung cấp thông tin tốt nhất cho việc tiếp tục quản lý\n\nvấn đề an ninh của các hệ thống công nghệ thông tin khi chúng được nâng cấp, sửa đổi.\n\n## Tuy nhiên, phương pháp này có 2 nhược điểm là:\n\n- Chi phí lớn về thời gian, các nguồn lực và yêu cầu kiến thức chuyên gia có trình độ\n\ncao, và\n\n- Có thể dẫn đến chậm trễ trong việc đưa ra các biện pháp xử lý, kiểm soát rủi ro\n\nphù hợp.\n\nPhương pháp phân tích chi tiết rủi ro phù hợp với các tổ chức chính phủ cung cấp các\n\ndịch vụ thiết yếu cho người dân và doanh nghiệp, hoặc các tổ chức có hệ thống công\n\nnghệ thông tin quy mô lớn, hoặc các tổ chức cung cấp nền tảng hạ tầng truyền thông cho\n\nquốc gia.\n\nd. Phương pháp kết hợp\n\nPhương pháp kết hợp là phương pháp tiếp cận đánh giá rủi ro cuối cùng. Phương pháp\n\nnày kết hợp các thành phần của 3 phương pháp đường cơ sở, không chính thức và phân\n\ntích chi tiết, với các mục tiêu là cung cấp mức bảo vệ hợp lý càng nhanh càng tốt và sau\n\nđó kiểm tra và điều chỉnh các biện pháp bảo vệ trên các hệ thống chính theo thời gian.\n\n## Phương pháp kết hợp được thực hiện theo 3 bước:\n\n- Thực hiện phương pháp đường cơ sở với tất cả các thành phần của hệ thống công\n\nnghệ thông tin của tổ chức;\n\n- Tiếp theo, các thành phần có mức rủi ro cao, hoặc trọng yếu được xem xét đánh\n\ngiá theo phương pháp không chính thức;\n\n- Cuối cùng hệ thống được xem xét đánh giá toàn diện rủi ro ở mức chi tiết.\n\nCác ưu điểm của phương pháp kết hợp là việc bắt đầu bằng việc đánh giá rủi ro ở mức\n\ncao dễ nhận được sự ủng hộ của cấp quản lý, thuận lợi cho việc lập kế hoạch quản lý an\n\ntoàn thông tin, đồng thời có thể giúp sớm triển khai các biện pháp xử lý và kiểm soát rủi\n\nro ngay từ giai đoạn đầu, cũng như có thể giúp giảm chi phí với đa số các tổ chức. Tuy\n\nnhiên, phương pháp kết hợp có nhược điểm là nếu đánh giá ở mức cao trong giai đoạn\n\nđầu không chính xác có thể dẫn đến áp dụng các biện pháp kiểm soát không phù hợp, hệ\n\nthống có thể gặp rủi ro trong thời gian chờ đánh giá chi tiết. Nói chung, phương pháp kết\n\nhợp phù hợp các tổ chức với hệ thống công nghệ thông tin quy mô vừa và lớn.\n\n5.1.3. Phân tích chi tiết rủi ro an toàn thông tin\n\n5.1.3.1. Giới thiệu\n\nPhân tích chi tiết rủi ro an toàn thông tin là phương pháp xem xét, phân tích toàn diện\n\ncác rủi ro của từng thành phần trong hệ thống công nghệ thông tin của cơ quan, tổ chức.\n\nPhân tích chi tiết rủi ro an toàn thông tin gồm nhiều hoạt động được chia thành 9 bước:\n\n1. Mô tả đặc điểm hệ thống\n\n---\n\n140\n\n2. Nhận dạng các mối đe dọa\n\n3. Nhận dạng các lỗ hổng bảo mật\n\n4. Phân tích các kiểm soát\n\n5. Xác định xác suất rủi ro\n\n6. Phân tích các ảnh hưởng\n\n7. Xác định các rủi ro\n\n8. Đề xuất các kiểm soát\n\n9. Viết tài liệu kết quả phân tích.\n\n5.1.3.2. Nội dung phân tích chi tiết rủi ro\n\nNội dung cụ thể từng bước của phân tích chi tiết rủi ro an toàn thông tin như sau.\n\n## Bước 1: Mô tả đặc điểm hệ thống\n\n- Đầu vào: Các thành phần của hệ thống:\n\n+ Phần cứng, phần mềm, giao diện\n\n+ Dữ liệu và thông tin\n\n+ Con người\n\n+ Sứ mệnh của hệ thống.\n\n- Đầu ra:\n\n+ Ranh giới và chức năng hệ thống;\n\n+ Tính trọng yếu của dữ liệu và hệ thống;\n\n+ Tính nhạy cảm\n\n## Bước 2: Nhận dạng các mối đe dọa\n\n- Đầu vào:\n\n+ Lịch sử tấn công vào hệ thống\n\n+ Dữ liệu từ các tổ chức chuyên về an toàn thông tin\n\n+ Dữ liệu từ các phương tiện thông tin đại chúng.\n\n- Đầu ra:\n\n+ Báo cáo về các mối đe dọa đối với hệ thống\n\n## Bước 3: Nhận dạng các lỗ hổng bảo mật\n\n- Đầu vào:\n\n+ Các báo cáo đánh giá rủi ro đã có\n\n+ Các nhận xét kiểm toán hệ thống\n\n+ Các yêu cầu an ninh, an toàn\n\n+ Các kết quả kiểm tra an ninh, an toàn\n\n- Đầu ra:\n\n+ Danh sách các lỗ hổng bảo mật tiềm tàng.\n\n## Bước 4: Phân tích các kiểm soát (control)\n\n---\n\n141\n\n- Đầu vào:\n\n+ Các kiểm soát hiện có\n\n+ Các kiểm soát được lập kế hoạch\n\n- Đầu ra:\n\n+ Danh sách các kiểm soát hiện có và được lập kế hoạch.\n\n## Bước 5: Xác định xác suất rủi ro\n\n- Đầu vào:\n\n+ Động cơ của các nguồn đe dọa\n\n+ Khả năng của đe dọa\n\n+ Bản chất của lỗ hổng bảo mật\n\n+ Các kiểm soát hiện có\n\n- Đầu ra:\n\n+ Đánh giá xác suất rủi ro.\n\nBước 6: Phân tích các ảnh hưởng (liên quan sự vi phạm tính toàn vẹn, sẵn dùng và bí\n\nmật của các tài sản hệ thống)\n\n- Đầu vào:\n\n+ Phân tích ảnh hưởng sứ mệnh\n\n+ Đánh giá tầm quan trọng của tài sản\n\n+ Tầm quan trọng của dữ liệu\n\n+ Tính nhạy cảm của dữ liệu\n\n- Đầu ra:\n\n+ Đánh giá các ảnh hưởng.\n\n## Bước 7: Xác định các rủi ro\n\n- Đầu vào:\n\n+ Khả năng bị mối đe dọa khai thác\n\n+ Tầm quan trọng của ảnh hưởng\n\n+ Sự phù hợp của các kiểm soát theo kế hoạch, hoặc hiện có\n\n- Đầu ra:\n\n+ Các rủi ro và các mức rủi ro có liên quan.\n\n## Bước 8: Đề xuất các kiểm soát\n\n- Đầu vào: Không\n\n- Đầu ra: Đề xuất các biện pháp xử lý, kiểm soát rủi ro\n\n## Bước 9: Viết tài liệu kết quả phân tích\n\n- Đầu vào: Không\n\n- Đầu ra: Báo cáo đánh giá rủi ro.\n\n---\n\n142\n\n5.1.4. Thực thi quản lý an toàn thông tin\n\n5.1.4.1. Giới thiệu\n\nThực thi quản lý an toàn thông tin là bước tiếp theo của khâu đánh giá rủi ro, nhằm\n\ntriển khai, thực thi các kiểm soát (control) nhằm đảm bảo an toàn thông tin cho hệ thống\n\ncông nghệ thông tin của tổ chức. Các nội dung chính của thực thi quản lý an toàn thông\n\ntin gồm:\n\n- Thực thi (Implementation): Thực thi các kiểm soát, và nâng cao ý thức và đào tạo\n\nan toàn thông tin.\n\n- Thực thi tiếp tục (Implementation follow-up): Bảo trì, kiểm tra hợp chuẩn, quản lý\n\nthay đổi và xử lý sự cố.\n\n## Kiểm soát (control), đảm bảo an toàn (safeguard), hoặc biện pháp đối phó\n\n(countermeasure) là các thuật ngữ có thể được sử dụng tương đương, hoặc tráo đổi cho\n\nnhau trong quản lý an toàn thông tin. Kiểm soát là phương tiện để quản lý rủi ro, bao\n\ngồm các chính sách, thủ tục, các hướng dẫn, các thực tế, hoặc cấu trúc tổ chức. Kiểm soát\n\ncó thể là vấn đề quản lý hành chính hoặc kỹ thuật, hoặc có bản chất luật pháp.\n\n## Các kiểm soát được thực thi trong quản lý an toàn thông tin có thể gồm 6 loại:\n\n- Kiểm soát quản lý (Management controls)\n\n- Kiểm soát vận hành (Operational controls)\n\n- Kiểm soát kỹ thuật (Technical controls)\n\n- Kiểm soát hỗ trợ (Supportive controls)\n\n- Kiểm soát ngăn ngừa (Preventive controls)\n\n- Kiểm soát phát hiện và phục hồi (Detection and recovery controls).\n\n5.1.4.2. Các loại kiểm soát\n\n## Kiểm soát quản lý bao gồm các nội dung:\n\n- Tập trung vào các chính sách, lập kế hoạch, hướng dẫn và chuẩn an toàn thông tin;\n\n- Các kiểm soát có ảnh hưởng đến việc lựa chọn các kiểm soát vận hành và kiểm\n\nsoát kỹ thuật nhằm giảm tổn thất do rủi ro và bảo vệ sứ mệnh của tổ chức;\n\n- Các kiểm soát tham chiếu đến các vấn đề được giải quyết thông qua lĩnh vực quản\n\nlý.\n\n## Kiểm soát vận hành bao gồm các nội dung:\n\n- Giải quyết vấn đề thực thi chính xác và sử dụng các chính sách và chuẩn an toàn\n\nthông tin, đảm bảo tính nhất quán trong vận hành an toàn thông tin và khắc phục\n\ncác khiếm khuyết vận hành đã được nhận dạng;\n\n- Các kiểm soát này liên quan đến các cơ chế và thủ tục được thực thi chủ yếu bởi\n\ncon người, hơn là bởi hệ thống;\n\n- Được sử dụng để tăng cường an ninh cho một hệ thống hoặc một nhóm các hệ\n\nthống.\n\n---\n\n143\n\n## Kiểm soát kỹ thuật bao gồm các nội dung:\n\n- Liên quan đến việc sử dụng đúng đắn các biện pháp đảm bảo an ninh bằng phần\n\ncứng và phần mềm trong hệ thống;\n\n- Bao gồm các biện pháp từ đơn giản đến phức tạp để đảm bảo an toàn cho các\n\nthông tin nhạy cảm và các chức năng trọng yếu của các hệ thống;\n\n- Một số kiểm soát kỹ thuật: xác thực, trao quyền và thực thi kiểm soát truy cập,...\n\nKiểm soát hỗ trợ là các kiểm soát chung ở lớp dưới, có quan hệ với và được sử dụng\n\nbởi nhiều kiểm soát khác.\n\nKiểm soát ngăn ngừa là kiểm soát tập trung vào việc ngăn ngừa việc xảy ra các vi\n\nphạm an ninh, bằng cách khắc chế các nỗ lực vi phạm chính sách an ninh hoặc khai thác\n\ncác lỗ hổng bảo mật.\n\nKiểm soát phát hiện và phục hồi là kiểm soát tập trung vào việc đáp trả vi phạm an\n\nninh bằng cách đưa ra cảnh báo vi phạm, hoặc các nỗ lực vi phạm chính sách an ninh,\n\nhoặc khai thác các lỗ hổng bảo mật, đồng thời cung cấp các biện pháp phục hồi các tài\n\nnguyên tính toán bị ảnh hưởng do vi phạm an ninh.\n\n5.1.4.3. Xây dựng kế hoạch đảm bảo an toàn\n\nKế hoạch đảm bảo an toàn (Security plan) là một tài liệu chỉ rõ các phần việc sẽ được\n\nthực hiện, các tài nguyên cần sử dụng và những người, hoặc nhân viên chịu trách nhiệm\n\nthực hiện. Mục đích của Kế hoạch đảm bảo an toàn là cung cấp chi tiết về các hành động\n\ncần thiết để cải thiện các vấn đề đã được nhận dạng trong hồ sơ đánh giá rủi ro một cách\n\nnhanh chóng. Kế hoạch đảm bảo an toàn nên gồm các thông tin chi tiết sau (theo chuẩn\n\nhướng dẫn quản lý rủi ro năm 2002 của NIST):\n\n- Các rủi ro (sự kế hợp của tài sản/mối đe dọa/lỗ hổng)\n\n- Các kiểm soát được khuyến nghị (từ đánh giá rủi ro)\n\n- Các hành động ưu tiên cho mỗi rủi ro\n\n- Các kiểm soát được chọn (dựa trên phân tích lợi ích – chi phí)\n\n- Các tài nguyên cần có cho thực thi các kiểm soát đã chọn\n\n- Nhân sự chịu trách nhiệm\n\n- Ngày bắt đầu và kết thúc việc thực thi\n\n- Các yêu cầu bảo trì và các nhận xét khác.\n\n5.1.4.4. Nội dung thực thi quản lý an toàn thông tin\n\nNhư đã đề cập trong mục 5.1.4.1, việc thực thi quản lý an toàn thông tin gồm 2 khâu\n\nlà (1) thực thi  (Implementation) và (2) thực thi tiếp tục (Implementation follow-up).\n\nKhâu thực thi gồm 2 phần việc là thực thi các kiểm soát, và nâng cao ý thức và đào tạo an\n\ntoàn thông tin. Thực thi các kiểm soát là phần việc tiếp theo cần thực hiện trong kế hoạch\n\nđảm bảo an toàn của tiến trình quản lý an toàn thông tin. Thực thi các kiểm soát có liên\n\nhệ mật thiết với việc đào tạo nâng cao ý thức an toàn thông tin cho nhân viên nói chung\n\nvà đào tạo chuyên sâu về an toàn thông tin cho nhân viên an toàn thông tin trong tổ chức.\n\n---\n\n144\n\nKhâu thực thi tiếp tục là việc cần lặp lại trong chu trình quản lý an toàn thông tin để\n\nđáp ứng sự thay đổi trong môi trường công nghệ thông tin và môi trường rủi ro. Trong\n\nđó, các kiểm soát đã được thực thi cần được giám sát để đảm bảo tính hiệu quả, và bất kỳ\n\nmột sự thay đổi trên hệ thống cần được xem xét vấn đề an ninh và hồ sơ rủi ro của hệ\n\nthống bị ảnh hưởng cần được xem xét nếu cần thiết. Giai đoạn thực thi tiếp tục bao gồm\n\ncác khía cạnh: bảo trì các kiểm soát an ninh, kiểm tra hợp chuẩn an ninh, quản lý thay đổi\n\nvà cấu hình và xử lý các sự cố.\n\n## Bảo trì các kiểm soát an ninh gồm các phần việc phải đảm bảo các yêu cầu sau:\n\n- Các kiểm soát được xem xét định kỳ để đảm bảo chúng hoạt động như mong\n\nmuốn;\n\n- Các kiểm soát cần được nâng cấp khi các yêu cầu mới được pháp hiện;\n\n- Các thay đổi với hệ thống không được có các ảnh hưởng tiêu cực đến các kiểm\n\nsoát;\n\n- Các mối đe dọa mới hoặc các lỗ hổng đã không trở thành được biết đến.\n\nKiểm tra hợp chuẩn an ninh là quá trình kiểm toán việc quản lý an toàn thông tin của\n\ntổ chức nhằm đảm bảo tính phù hợp với kế hoạch đảm bảo an ninh. Việc kiểm toán có thể\n\nđược thực hiện bởi nhân sự bên trong hoặc bên ngoài tổ chức. Cần sử dụng danh sách\n\nkiểm tra (checklist) các vấn đề: các chính sách và kế hoạch an ninh được tạo ra, các kiểm\n\nsoát phù hợp được lựa chọn và các kiểm soát được sử dụng và bảo trì phù hợp.\n\nQuản lý thay đổi và cấu hình là tiến trình được sử dụng để xem xét các thay đổi được\n\nđề xuất cho hệ thống trong quá trình sử dụng. Các thay đổi với các hệ thống hiện có là\n\ncần thiết do nhiều lý do, như hệ thống có trục trặc, hoặc sự xuất hiện của các mối đe dọa\n\nhoặc lỗ hổng mới, sự xuất hiện của yêu cầu mới, nhiệm vụ mới,… Các thay đổi cần được\n\nxem xét kỹ lưỡng cả vấn đề vận hành, tính năng và vấn đề an toàn,… Quản lý cấu hình\n\nliên quan đến việc lưu vết các cấu hình của mỗi hệ thống khi chúng được nâng cấp, thay\n\nđổi. Việc này bao gồm danh sách các phiên bản của phần cứng, phần mềm cài đặt trong\n\nmỗi hệ thống, và thông tin quản lý cấu hình hữu ích để khôi phục hệ thống khi việc thay\n\nđổi hoặc nâng cấp thất bại.\n\nXử lý các sự cố bao gồm các thủ tục được sử dụng để phản ứng lại các sự cố an ninh.\n\nXử lý sự cố có liên quan đến vấn đề đào tạo nâng cao ý thức an toàn thông tin cho người\n\ndùng và đào tạo chuyên sâu cho chuyên viên an toàn thông tin.\n\n5.2. Các chuẩn quản lý an toàn thông tin\n\n5.2.1. Giới thiệu\n\n## Trong các chuẩn quản lý an toàn thông tin, bộ chuẩn NIST SP 800 của Viện tiêu\n\nchuẩn và công nghệ Mỹ và bộ chuẩn quốc tế ISO/IEC 27000 được tham chiếu và sử dụng\n\nrộng rãi nhất. Nhiều quốc gia, trong đó có Việt Nam đã dịch và chấp thuận nguyên vẹn\n\nmột số chuẩn trong bộ chuẩn quốc tế ISO/IEC 27000 làm chuẩn quản lý an toàn thông tin\n\nquốc gia. Theo đó, bộ chuẩn ISO/IEC 27000:2014 được Việt Nam dịch và chấp thuận\n\nnguyên vẹn thành chuẩn TCVN 11238:2015. Trong phạm vi của môn học, mục này giới\n\nthiệu khái quát về bộ chuẩn quản lý an toàn thông tin ISO/IEC 27000.\n\n---\n\n145\n\nChuẩn ISO/IEC 27000: 2009 giới thiệu khái quát về bộ chuẩn ISO/IEC 27000 và định\n\nnghĩa các thuật ngữ và từ vựng sử dụng cho toàn bộ các chuẩn con trong bộ chuẩn\n\n# ISO/IEC 27000.\n\n## Chuẩn ISO/IEC 17799 được soạn thảo năm 2000 bởi International Organization for\n\nStandardization (ISO) và International Electrotechnical Commission (IEC) là tiền thân\n\ncủa ISO 27000. Năm 2005, ISO 17799 được chỉnh sửa và trở thành ISO 17799:2005.\n\n## Năm 2007, ISO 17799:2005 được đổi tên thành ISO 27002 song hành với ISO 27001.\n\n## Chuẩn ISO/IEC 27001:2005 chuyên về hệ thống quản lý an toàn thông tin\n\n(Information Security Management System - ISMS). Chuẩn này cung cấp các thông tin\n\nđể thực thi các yêu cầu của ISO/IEC 27002 và cài đặt một hệ thống quản lý an toàn thông\n\ntin. Trong việc xây dựng hệ thống ISMS, chuẩn cung cấp các chi tiết cho thực hiện chu\n\nkỳ Lập kế hoạch – Thực hiện – Giám sát – Hành động (Plan-Do-Check-Act). Một điểm\n\ncần lưu ý là ISO/IEC 27001 chỉ tập trung vào các phần việc phải thực hiện mà không chỉ\n\ndẫn cách thức thực hiện.\n\n## Chuẩn ISO/IEC 27002 gồm 127 điều, cung cấp cái nhìn tổng quan về nhiều lĩnh vực\n\ntrong an toàn thông tin. Nó đề ra các khuyến nghị về quản lý an toàn thông tin cho những\n\nngười thực hiện việc khởi tạo, thực hiện và duy trì an ninh an toàn trong tổ chức của họ.\n\nChuẩn này  được thiết kế để cung cấp nền tảng cơ sở giúp đề ra các chuẩn an toàn thông\n\ntin cho tổ chức và các thực tế quản lý an toàn thông tin một cách hiệu quả.\n\n## Chuẩn ISO/IEC 27005: 2009 chuyên về quản lý rủi ro cho hệ thống quản lý an toàn\n\nthông tin. Chuẩn này hỗ trợ ISO/IEC 27001, nhưng nó không đề cập đến phương pháp\n\nkiểm soát rủi ro cụ thể.\n\n5.2.2. Chu trình Plan-Do-Check-Act\n\n## Chuẩn ISO/IEC 27001:2005 chuyên về hệ thống quản lý an toàn thông tin cung cấp\n\ncác chi tiết cho thực hiện chu kỳ Plan-Do-Check-Act gồm 4 pha: Plan - Lập kế hoạch, Do\n\n– Thực hiện kế hoạch, Check – Giám sát việc thực hiện và Act – Thực hiện các cải tiến,\n\nhiệu chỉnh, như biểu diễn trên Hình 5.3. Theo đó, chi tiết 4 pha trong chu trình này\n\nnhư sau:\n\n## Hình 5.3. Chu trình Plan-Do-Check-Act của ISO/IEC 27001:2005\n\n## Pha Plan gồm các nội dung:\n\n- Đề ra phạm vi của ISMS;\n\n- Đề ra chính sách của ISMS;\n\n- Đề ra hướng tiếp cận đánh giá rủi ro;\n\n---\n\n146\n\n- Nhận dạng các rủi ro;\n\n- Đánh giá rủi ro;\n\n- Nhận dạng và đánh giá các lựa chọn phương pháp xử lý rủi ro;\n\n- Lựa chọn các mục tiêu kiểm soát và biện pháp kiểm soát;\n\n- Chuẩn bị tuyến bố, báo cáo áp dụng.\n\n## Pha Do gồm các nội dung:\n\n- Xây dựng kế hoạch xử lý rủi ro;\n\n- Thực thi kế hoạch xử lý rủi ro;\n\n- Thực thi các kiểm soát;\n\n- Thực thi các chương trình đào tạo chuyên môn và giáo dục ý thức;\n\n- Quản lý các hoạt động;\n\n- Quản lý các tài nguyên;\n\n- Thực thi các thủ tục phát hiện và phản ứng lại các sự cố an ninh.\n\n## Pha Check gồm các nội dung:\n\n- Thực thi các thủ tục giám sát;\n\n- Thực thi việc đánh giá thường xuyên tính hiệu quả của ISMS;\n\n- Thực hiện việc kiểm toán (audits) nội bộ với ISMS;\n\n- Thực thi việc đánh giá thường xuyên với ISMS bởi bộ phận quản lý;\n\n- Ghi lại các hành động và sự kiện ảnh hưởng đến ISMS.\n\n## Pha Act gồm các nội dung:\n\n- Thực hiện các cải tiến đã được nhận dạng;\n\n- Thực hiện các hành động sửa chữa và ngăn chặn;\n\n- Áp dụng các bài đã được học;\n\n- Thảo luận kết quả với các bên quan tâm;\n\n- Đảm bảo các cải tiến đạt được các mục tiêu.\n\n5.3. Pháp luật và chính sách an toàn thông tin\n\n5.3.1. Giới thiệu về pháp luật và chính sách an toàn thông tin\n\nCác chính sách và pháp luật an toàn thông tin có vai trò rất quan trọng trong việc đảm\n\nbảo an toàn cho thông tin, hệ thống và mạng. Trong đó, vai trò của nhân viên đảm bảo an\n\ntoàn thông tin là rất quan trọng trong việc giảm thiểu rủi ro, đảm bảo an toàn cho thông\n\ntin, hệ thống và mạng và giảm thiệt hại nếu xảy ra sự cố. Các nhân viên đảm bảo an toàn\n\ncho thông tin phải hiểu rõ những khía cạnh pháp lý và đạo đức an toàn thông tin. Theo\n\nđó, họ phải luôn nắm vững môi trường pháp lý hiện tại (các luật và các quy định luật\n\npháp) và luôn thực hiện công việc nằm trong khuôn khổ cho phép của luật pháp. Ngoài\n\nra, cần thực hiện việc giáo dục ý thức về luật pháp và đạo đức an toàn thông tin cho cán\n\nbộ quản lý và nhân viên trong tổ chức, đảm bảo sử dụng đúng mục đích các công nghệ\n\nđảm bảo an toàn thông tin.\n\n---\n\n147\n\nChính sách (Policy - còn gọi là quy định, nội quy) là các quy định về các hành vi chấp\n\nnhận được của các nhân viên trong tổ chức tại nơi làm việc. Chính sách là các \"luật\" của\n\ntổ chức có giá trị thực thi trong nội bộ, gồm một tập các quy định và các chế tài xử phạt\n\nbắt buộc phải thực hiện. Các chính sách, hoặc nội quy cần được nghiên cứu, soạn thảo kỹ\n\nlưỡng. Đồng thời, chính sách cần đầy đủ, đúng đắn và áp dụng công bằng với mọi nhân\n\nviên. Điểm khác biệt giữa luật và chính sách là Luật luôn bắt buộc, còn với Chính sách,\n\nviệc thiếu hiểu biết chính sách là 1 cách bào chữa chấp nhận được.\n\nCần có phân biệt rõ ràng giữa luật (Law) và đạo đức (Ethic). Luật gồm những điều\n\nkhoản bắt buộc hoặc cấm những hành vi cụ thể. Các điều luật thường được xây dựng từ\n\ncác vấn đề đạo đức. Trong khi đó, đạo đức định nghĩa những hành vi xã hội chấp nhận\n\nđược. Đạo đức thường dựa trên các đặc điểm văn hóa. Do đó, hành vi đạo đức giữa các\n\ndân tộc, các nhóm người khác nhau là khác nhau. Một số hành vi vi phạm đạo đức được\n\nluật hóa trên toàn thế giới, như trộm, cướp, cưỡng dâm, bạo hành trẻ em,... Khác biệt\n\ngiữa luật và đạo đức thể hiện ở chỗ luật được thực thi bởi các cơ quan chính quyền, còn\n\nđạo đức không được thực thi bởi các cơ quan chính quyền.\n\n## Để các chính sách có thể được áp dụng hiệu quả, chúng phải đạt được các yêu cầu\n\nsau:\n\n- Có khả năng phổ biến rộng rãi, bằng tài liệu giấy hoặc điện tử;\n\n- Nhân viên có thể xem, hiểu được – cần thực hiện trên nhiều ngôn ngữ, ví dụ bằng\n\ntiếng Anh và tiếng địa phương;\n\n- Chính sách cần rõ ràng dễ hiểu – tổ chức cần có các điều tra/khảo sát về mức độ\n\nhiểu biết/nắm bắt các chính sách của nhân viên;\n\n- Cần có biện pháp để nhân viên cam kết thực hiện – thông qua ký văn bản cam kết\n\nhoặc tick vào ô xác nhận tuân thủ;\n\n- Chính sách cần được thực hiện đồng đều, bình đẳng, nhất quán, không có ưu tiên\n\nvới bất kỳ nhân viên nào, kể cả người quản lý.\n\n5.3.2. Luật quốc tế về an toàn thông tin\n\nMục này đề cập đến một số luật và văn bản có liên quan đến an toàn thông tin của Mỹ\n\nvà Châu Âu – là những nước và khu vực đã phát triển và có hệ thống luật pháp về an toàn\n\nthông tin tương đối hoàn thiện.\n\nCó thể nói hệ thống luật pháp về an toàn thông tin của nước Mỹ khá đầy đủ và được\n\nchia thành các nhóm: các luật tội phạm máy tính, các luật về sự riêng tư, luật xuất khẩu\n\nvà chống gián điệp, luật bản quyền và luật tự do thông tin. Các luật về tội phạm máy tính\n\nvà tội phạm mạng gồm:\n\n- Computer Fraud and Abuse Act of 1986 (CFA Act): quy định về các tội phạm lừa\n\nđảo và lạm dụng máy tính;\n\n- Computer Security Act, 1987: đề ra các nguyên tắc đảm bảo an toàn cho hệ thống\n\nmáy tính;\n\n- National Information Infrastructure Protection Act of 1996: là bản sửa đổi của\n\nCFA Act, tăng khung hình phạt một số tội phạm máy tính đến 20 năm tù;\n\n---\n\n148\n\n- USA PATRIOT Act, 2001: cho phép các cơ quan nhà nước một số quyền theo dõi,\n\ngiám sát các hoạt động trên mạng nhằm phòng chống khủng bố hiệu quả hơn;\n\n- USA PATRIOT Improvement and Reauthorization Act: Mở rộng của USA\n\n## PATRIOT Act, 2001, cấp cho các cơ quan nhà nước nhiều quyền hạn hơn cho\n\nnhiệm vụ phòng chống khủng bố.\n\nCác luật về sự riêng tư nhằm bảo vệ quyền riêng tư của người dùng, bảo vệ các thông\n\ntin cá nhân của người dùng, gồm:\n\n- Federal Privacy Act, 1974:  luật Liên bang Mỹ bảo vệ quyền riêng tư của người\n\ndùng;\n\n- Electronic Communications Privacy Act , 1986: luật bảo vệ quyền riêng tư trong\n\ncác giao tiếp điện tử;\n\n- Health Insurance Portability and Accountability Act, 1996 (HIPAA): bảo vệ tính bí\n\nmật và an toàn của các dữ liệu y tế của người bệnh. Tổ chức, hoặc cá nhân vi phạm\n\ncó thể bị phạt đến 250.000 USD hoặc 10 năm tù;\n\n- Financial Services Modernization Act or Gramm-Leach-Bliley Act, 1999: điều\n\nchỉnh các hoạt động liên quan đến nhà nước của các ngân hàng, bảo hiểm và các\n\nhãng an ninh.\n\nLuật xuất khẩu và chống gián điệp hạn chế việc xuất khẩu các công nghệ và hệ thống\n\nxử lý thông tin và phòng chống gián điệp kinh tế, gồm:\n\n- Economic Espionage Act, 1996: phòng chống việc thực hiện giao dịch có liên quan\n\nđến bí mật kinh tế và công nghệ;\n\n- Security and Freedom through Encryption Act, 1999: quy định về các vấn đề có\n\nliên quan đến sử dụng mã hóa trong đảm bảo an toàn và tự do thông tin.\n\n## U.S. Copyright Law là Luật bản quyền của Mỹ, điều chỉnh các vấn đề có liên quan\n\nđến xuất bản, quyền tác giả của các tài liệu, phần mềm, bao gồm cả các tài liệu số.\n\nFreedom of Information Act, 1966 (FOIA) là Luật tự do thông tin nêu rõ các cá nhân\n\nđược truy cập các thông tin không gây tổn hại đến an ninh quốc gia.\n\n## Các tổ chức và luật quốc tế có liên quan đến an toàn thông tin, gồm:\n\n- Hội đồng Châu Âu về chống tội phạm mạng (Council of Europe Convention on\n\nCybercrime);\n\n- Hiệp ước về chống tội phạm mạng được Hội đồng châu Âu phê chuẩn vào năm\n\n2001;\n\n- Hiệp ước bảo vệ quyền sở hữu trí tuệ (Agreement on Trade-Related Aspects of\n\n## Intellectual Property Rights (TRIPS)): do Tổ chức Thương mại thế giới WTO chủ\n\ntrì đàm phán trong giai đoạn 1986–1994;\n\n- Digital Millennium Copyright Act (DMCA): Luật bản quyền số Thiên niên kỷ.\n\n5.3.3. Luật Việt Nam về an toàn thông tin\n\nLuật an toàn thông tin mạng là bộ luật đầu tiên về lĩnh vực an toàn thông được Quốc\n\nhội thông qua vào tháng 11 năm 2015 và chính thức có hiệu lực từ ngày 01/7/2016. Tiếp\n\n---\n\n149\n\ntheo Luật an toàn thông tin mạng, Luật an ninh mạng được Quốc hội thông qua vào ngày\n\n12/6/2018 và chính thức có hiệu lực từ ngày 01/01/2019. Đây là các cơ sở pháp lý rất\n\nquan trọng cho việc quản lý các hoạt động liên quan đến an toàn thông tin, an toàn không\n\ngian mạng ở Việt Nam. Ngoài hai bộ luật trên, đã có nhiều văn bản có liên quan đến công\n\nnghệ thông tin và an toàn thông tin được Quốc Hội, Chính Phủ và các cơ quan nhà nước\n\nban hành như:\n\n- Luật công nghệ thông tin số 67/2006/QH11 của Quốc hội, ngày 12/07/2006.\n\n- Nghị định số 90/2008/NÐ-CP của Chính Phủ \"Về chống thư rác\", ngày\n\n13/08/2008.\n\n- Quyết định số 59/2008/QÐ-BTTTT của Bộ Thông tin và Truyền thông \"Ban hành\n\n## Danh mục tiêu chuẩn bắt buộc áp dụng về chữ ký số và dịch vụ chứng thực chữ ký\n\nsố\", ngày 31/12/2008.\n\n- Quyết định 63/QÐ-TTg của Thủ tướng CP \"Phê duyệt Quy hoạch phát triển an\n\ntoàn thông tin số quốc gia đến năm 2020\", ngày 13/01/2010.\n\n- Chỉ thị số 897/CT-TTg của Thủ tướng CP \"V/v tăng cường triển khai các hoạt\n\nđộng đảm bảo an toàn thông tin số\", 10/06/2011.\n\n- Thông tư số 23/2011/TT-BTTTT của Bộ TT&TT \"Quy định về việc quản lý, vận\n\nhành, sử dụng và bảo đảm an toàn thông tin trên Mạng truyền số liệu chuyên dùng\n\ncủa các cơ quan Đảng, Nhà nước\", ngày 11/08/2011.\n\n- Nghị định số 77/2012/NĐ-CP của Chính Phủ \"Sửa đổi, bổ sung một số điều của\n\n## Nghị định số 90/2008/NĐ-CP ngày 13 tháng 8 năm 2008 của Chính phủ về chống\n\nthư rác\", ngày 05/10/2012.\n\n- Nghị định 72/2013/NĐ-CP của Chính Phủ về Quản lý, cung cấp, sử dụng dịch vụ\n\ninternet và thông tin trên mạng; quy định về việc chia sẻ thông tin trên các trang\n\nmạng xã hội.\n\n5.4. Vấn đề đạo đức an toàn thông tin\n\n5.4.1. Sự cần thiết của đạo đức an toàn thông tin\n\n## Vấn đề đạo đức nghề nghiệp (Professional ethic) hay quy tắc ứng xử (Code of\n\nconduct) được đề cập trong ngành công nghệ thông tin nói chung và an toàn thông tin nói\n\nriêng do các công việc liên quan đến an toàn thông tin có thể liên quan đến các thông tin\n\nnhạy cảm, như thông tin, hệ thống bí mật quốc gia, thông tin bí mật của các cơ quan, tổ\n\nchức, hoặc bí mật công nghệ, bí mật kinh doanh của các công ty. Nếu các thông tin nhạy\n\ncảm bị rò rỉ, hoặc bị đánh cắp và lạm dụng có thể ảnh hưởng nghiêm trọng đến an ninh\n\nquốc gia, hoặc ảnh hưởng xấu đến các cơ quan, tổ chức và người dùng. Do vậy, người\n\nlàm trong lĩnh vực an toàn thông tin cần có hiểu biết về chính sách, pháp luật và có thái\n\nđộ và hành động đúng đắn trong khi thực thi nhiệm vụ.\n\n5.4.2. Một số bộ quy tắc ứng xử trong CNTT và ATTT\n\nNhiều tổ chức xã hội nghề nghiệp đã ban hành các quy tắc ứng xử bắt buộc tại nơi\n\nlàm việc, như với luật sư, bác sỹ và các vận động viên thể thao. Nếu vi phạm nghiêm\n\n---\n\n150\n\ntrọng các quy tắc ứng xử tại nơi làm việc có thể bị cấm hành nghề có thời hạn, hoặc vĩnh\n\nviễn. Trong lĩnh vực công nghệ thông tin và an toàn thông tin, hiện không có bộ quy tắc\n\nứng xử bắt buộc. Một số tổ chức xã hội nghề nghiệp như ACM (Association for\n\nComputing Machinery) và ISSA (Information Systems Security Association) hợp tác để\n\nđề ra các quy tắc ứng xử trong an toàn thông tin. Tuy nhiên, các quy tắc ứng xử trong an\n\ntoàn thông tin chỉ có tính khuyến nghị do các tổ chức trên không có thẩm quyền buộc\n\nphải thực hiện.\n\nHiệp hội an toàn thông tin Việt Nam đã công bố Bộ Qui tắc ứng xử an toàn thông tin\n\nvào đầu năm 2015, đưa ra một số quy tắc và khuyến nghị về những việc không được làm\n\ncho các thành viên và các nhân viên của các tổ chức hoạt động trong lĩnh vực an toàn\n\nthông tin. Ở bình diện quốc tế, Viện đạo đức máy tính, Mỹ đưa ra Bộ Quy tắc ứng xử 10\n\nđiểm (Ten Commandments of Computer Ethics) như sau:\n\n1. Không được sử dụng máy tính để gây hại cho người khác;\n\n2. Không được can thiệp vào công việc của người khác trên máy tính;\n\n3. Không trộm cắp các file trên máy tính của người khác;\n\n4. Không được sử dụng máy tính để trộm cắp;\n\n5. Không được sử dụng máy tính để tạo bằng chứng giả;\n\n6. Không sao chép hoặc sử dụng phần mềm không có bản quyền;\n\n7. Không sử dụng các tài nguyên máy tính của người khác khi không được phép hoặc\n\nkhông có bồi thường thỏa đáng;\n\n8. Không chiếm đoạn tài sản trí tuệ của người khác;\n\n9. Nên suy nghĩ về các hậu quả xã hội của chương trình mình đang xây dựng hoặc hệ\n\nthống đang thiết kế;\n\n10. Nên sử dụng máy tính một cách có trách nhiệm, đảm bảo sự quan tâm và tôn trọng\n\nđến đồng bào của mình.\n\n5.4.3. Một số vấn đề khác\n\nLiên quan đến vấn đề đạo đức trong an toàn thông tin, có một số vấn đề khác cần lưu\n\ný là (1) sự khác biệt về vấn đề đạo đức giữa các nền văn hóa, (2) vấn đề vi phạm bản\n\nquyền phần mềm và (3) vấn đề lạm dụng các tài nguyên của cơ quan, tổ chức.\n\nTrên thực tế, có sự khác biệt khá lớn về vấn đề đạo đức giữa các nền văn hóa. Trong\n\nđó, nhận thức về vấn đề đạo đức trong sử dụng các tài nguyên của cơ quan, tổ chức là rất\n\nkhác biệt giữa các quốc gia có nền văn hóa khác nhau. Trong nhiều trong hợp, một hành\n\nvi được phép của một số cá nhân trong một quốc gia lại vi phạm quy tắc đạo đức của\n\nquốc gia khác. Chẳng hạn, hành vi tiết lộ thông tin cá nhân và đặc biệt là mức thu nhập\n\ncủa người khác được coi là bình thường ở Việt Nam, nhưng đây là hành vi vi phạm\n\nquyền riêng tư ở các nước phát triển như Mỹ và châu Âu.\n\nVấn đề vi phạm bản quyền phần mềm là rất nghiêm trọng, đặc biệt là ở các nước đang\n\nphát triển ở châu Á và châu Phi. Đa số người dùng có hiểu biết về vấn đề bản quyền phần\n\nmềm, nhưng coi việc sử dụng phần mềm bất hợp pháp là bình thường vì nhiều nước chưa\n\n---\n\n151\n\ncó quy định hoặc không xử lý nghiêm vi phạm. Tỷ lệ vi phạm bản quyền phần mềm ở\n\n## Việt Nam hiện rất cao, đến khoảng 90% do thiếu các chế tài xử lý vi phạm.\n\nVấn đề lạm dụng các tài nguyên của công ty, tổ chức xảy ra tương đối phổ biến và cần\n\ncó các quy định và chế tài để kiểm soát. Một số cơ quan, tổ chức chưa có các quy định\n\ncấm nhân viên sử dụng các tài nguyên của cơ quan, tổ chức vào việc riêng. Một số đơn vị\n\nkhác có quy định nhưng chưa được thực thi chặt chẽ và chưa có chế tài xử phạt nghiêm\n\nminh. Các hành vi lạm dụng thường gặp, gồm:\n\n- In ấn tài liệu riêng;\n\n- Sử dụng email cá nhân cho việc riêng;\n\n- Tải các tài liệu, file không được phép;\n\n- Cài đặt và chạy các chương trình, phần mềm không được phép;\n\n- Sử dụng máy tính công ty làm việc riêng;\n\n- Sử dụng các phương tiện làm việc khác như điện thoại công ty quá mức vào việc\n\nriêng.\n\n5.5. Câu hỏi ôn tập\n\n1) Nêu khái niệm tài sản an toàn thông tin, khái niệm quản lý an toàn thông tin. Nêu vai\n\ntrò và các khâu cần thực hiện của quản lý an toàn thông tin.\n\n2) Đánh giá rủi ro an toàn thông tin là gì? Mô tả vắn tắt các phương pháp tiếp cận đánh\n\ngiá rủi ro an toàn thông tin.\n\n3) Mô tả vắn tắt các bước của phân tích chi tiết rủi ro an toàn thông tin.\n\n4) Mô tả các loại kiểm soát trong thực thi quản lý an toàn thông tin.\n\n5) Mô tả nội dung thực thi quản lý an toàn thông tin.\n\n6) Mô tả vắn tắt các chuẩn ISO/IEC 27000, ISO/IEC 27001, ISO/IEC 27002 và ISO/IEC\n\n27005.\n\n7) Mô tả chu trình Plan-Do-Check-Act của chuẩn ISO/IEC 27001.\n\n8) Phân biệt pháp luật và chính sách. Nêu các yêu cầu của chính sách có thể được áp\n\ndụng hiệu quả.\n\n9) Mô tả vắn tắt các văn bản luật có liên quan đến an toàn thông tin của Việt Nam.\n\n10) Nêu sự cần thiết của vấn đề đạo đức an toàn thông tin. Nêu bộ qui tắc ứng xử của\n\n## Viện đạo đức máy tính (Mỹ).\n\n---\n\n152\n\n# TÀI LIỆU THAM KHẢO\n\n[1] Michael E. Whitman, Herbert J. Mattord, Principles of information security, 4th\n\nedition, Course Technology, Cengage Learning, 2012.\n\n[2] David Kim, Michael G. Solomon, Fundamentals of Information Systems Security,\n\n## Jones & Bartlettlearning, 2012.\n\n[3] Statista.com, Internet of Things (IoT) connected devices installed base worldwide\n\nfrom 2015 to 2025, https://www.statista.com/statistics/471264/iot-number-of-\n\nconnected-devices-worldwide/, truy cập tháng 11.2021.\n\n[4] Statista.com, Number of cyber security incident reports by federal agencies in the\n\n## United States from FY 2006 to 2018, https://www.statista.com/statistics/677015/\n\nnumber-cyber-incident-reported-usa-gov/, truy cập tháng 11.2021.\n\n[5] Tập đoàn Bkav, Tổng kết an ninh mạng 2019 và dự báo xu hướng 2020,\n\nhttps://m.bkav.com.vn/tin_tuc_noi_bat/-/chi_tiet/669034/tong-ket-an-ninh-mang-\n\nnam-2019-va-du-bao-2020, truy cập tháng 11.2021.\n\n[6] US National Vulnerability Database, https://nvd.nist.gov, truy cập tháng 11.2021.\n\n[7] Alfred J. Menezes, Paul C. van Oorschot and Scott A. Vanstone, Handbook of\n\n## Applied Cryptography, CRC Press, Fifth Printing, August 2001.\n\n[8] Bruce Schneier, Applied Cryptography, 2nd edition, John Wiley & Sons, 1996.\n\n[9] Schneier, B. (2000). Secrets and lies: digital security in a networked world. New\n\n## York: John Wiley and Sons.\n\n[10] Webster's Online Dictionary, http://www.websters-online-dictionary.org, truy cập\n\ntháng 11.2021.\n\n[11] The Free Online Dictionary of Computing, http://foldoc.org, truy cập tháng 11.2021.\n\n[12] Eric Code, Advanced Persistent Threat: Understanding the Danger and How to\n\n## Protect Your Organization, Elsevier, USA, 2013.",
    "content_summary": "# BỘ THÔNG TIN VÀ TRUYỀN THÔNG\n\n# HỌC VIỆN CÔNG NGHỆ BƯU CHÍNH VIỄN THÔNG\n\n------------------oOo-----------------\n\n# HOÀNG XUÂN DẬU\n\n# BÀI GIẢNG\n\n# AN TOÀN VÀ BẢO MẬT\n\n# HỆ THỐNG THÔNG TIN\n\n# HÀ NỘI 2021\n\n---\n\n1\n\n# MỤC LỤC\n\nDANH MỤC CÁC HÌNH ...........",
    "content_length": 307910,
    "created_at": "2025-05-18T10:48:14.237743+00:00",
    "updated_at": "2025-05-18T10:59:00.778266+00:00",
    "file_path": "unknown_source"
  }
}